import{E as Fr}from"./_polyfill-node.events-e14e465e.js";import{g as In,c as Gi,a as kv}from"./bundle-4b8b85d3.js";import{s as Xf,f as Zf,a as Qf,d as ed,b as fu,g as Gv,c as td,e as Wv,h as Yv,i as Jv,j as Nl,k as Xv,l as Zv,m as rd,n as du,p as Qv,J as xi,o as pu,q as gu,r as _u,t as Di,u as li,v as yu,w as id,H as Ji}from"./http-54d98f74.js";import{r as eb}from"./__polyfill-node.events-7c4b24c3.js";var vu={},Ra={},Fe={},nd={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});function t(f,_){var g=f>>>16&65535,D=f&65535,N=_>>>16&65535,P=_&65535;return D*P+(g*P+D*N<<16>>>0)|0}i.mul=Math.imul||t;function e(f,_){return f+_|0}i.add=e;function s(f,_){return f-_|0}i.sub=s;function a(f,_){return f<<_|f>>>32-_}i.rotl=a;function c(f,_){return f<<32-_|f>>>_}i.rotr=c;function d(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}i.isInteger=Number.isInteger||d,i.MAX_SAFE_INTEGER=9007199254740991,i.isSafeInteger=function(f){return i.isInteger(f)&&f>=-i.MAX_SAFE_INTEGER&&f<=i.MAX_SAFE_INTEGER}})(nd);Object.defineProperty(Fe,"__esModule",{value:!0});var sd=nd;function tb(i,t){return t===void 0&&(t=0),(i[t+0]<<8|i[t+1])<<16>>16}Fe.readInt16BE=tb;function rb(i,t){return t===void 0&&(t=0),(i[t+0]<<8|i[t+1])>>>0}Fe.readUint16BE=rb;function ib(i,t){return t===void 0&&(t=0),(i[t+1]<<8|i[t])<<16>>16}Fe.readInt16LE=ib;function nb(i,t){return t===void 0&&(t=0),(i[t+1]<<8|i[t])>>>0}Fe.readUint16LE=nb;function ad(i,t,e){return t===void 0&&(t=new Uint8Array(2)),e===void 0&&(e=0),t[e+0]=i>>>8,t[e+1]=i>>>0,t}Fe.writeUint16BE=ad;Fe.writeInt16BE=ad;function od(i,t,e){return t===void 0&&(t=new Uint8Array(2)),e===void 0&&(e=0),t[e+0]=i>>>0,t[e+1]=i>>>8,t}Fe.writeUint16LE=od;Fe.writeInt16LE=od;function Fc(i,t){return t===void 0&&(t=0),i[t]<<24|i[t+1]<<16|i[t+2]<<8|i[t+3]}Fe.readInt32BE=Fc;function jc(i,t){return t===void 0&&(t=0),(i[t]<<24|i[t+1]<<16|i[t+2]<<8|i[t+3])>>>0}Fe.readUint32BE=jc;function Lc(i,t){return t===void 0&&(t=0),i[t+3]<<24|i[t+2]<<16|i[t+1]<<8|i[t]}Fe.readInt32LE=Lc;function Mc(i,t){return t===void 0&&(t=0),(i[t+3]<<24|i[t+2]<<16|i[t+1]<<8|i[t])>>>0}Fe.readUint32LE=Mc;function Oa(i,t,e){return t===void 0&&(t=new Uint8Array(4)),e===void 0&&(e=0),t[e+0]=i>>>24,t[e+1]=i>>>16,t[e+2]=i>>>8,t[e+3]=i>>>0,t}Fe.writeUint32BE=Oa;Fe.writeInt32BE=Oa;function Pa(i,t,e){return t===void 0&&(t=new Uint8Array(4)),e===void 0&&(e=0),t[e+0]=i>>>0,t[e+1]=i>>>8,t[e+2]=i>>>16,t[e+3]=i>>>24,t}Fe.writeUint32LE=Pa;Fe.writeInt32LE=Pa;function sb(i,t){t===void 0&&(t=0);var e=Fc(i,t),s=Fc(i,t+4);return e*4294967296+s-(s>>31)*4294967296}Fe.readInt64BE=sb;function ab(i,t){t===void 0&&(t=0);var e=jc(i,t),s=jc(i,t+4);return e*4294967296+s}Fe.readUint64BE=ab;function ob(i,t){t===void 0&&(t=0);var e=Lc(i,t),s=Lc(i,t+4);return s*4294967296+e-(e>>31)*4294967296}Fe.readInt64LE=ob;function cb(i,t){t===void 0&&(t=0);var e=Mc(i,t),s=Mc(i,t+4);return s*4294967296+e}Fe.readUint64LE=cb;function cd(i,t,e){return t===void 0&&(t=new Uint8Array(8)),e===void 0&&(e=0),Oa(i/4294967296>>>0,t,e),Oa(i>>>0,t,e+4),t}Fe.writeUint64BE=cd;Fe.writeInt64BE=cd;function ud(i,t,e){return t===void 0&&(t=new Uint8Array(8)),e===void 0&&(e=0),Pa(i>>>0,t,e),Pa(i/4294967296>>>0,t,e+4),t}Fe.writeUint64LE=ud;Fe.writeInt64LE=ud;function ub(i,t,e){if(e===void 0&&(e=0),i%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(i/8>t.length-e)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,a=1,c=i/8+e-1;c>=e;c--)s+=t[c]*a,a*=256;return s}Fe.readUintBE=ub;function hb(i,t,e){if(e===void 0&&(e=0),i%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(i/8>t.length-e)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,a=1,c=e;c<e+i/8;c++)s+=t[c]*a,a*=256;return s}Fe.readUintLE=hb;function lb(i,t,e,s){if(e===void 0&&(e=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!sd.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var a=1,c=i/8+s-1;c>=s;c--)e[c]=t/a&255,a*=256;return e}Fe.writeUintBE=lb;function fb(i,t,e,s){if(e===void 0&&(e=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!sd.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var a=1,c=s;c<s+i/8;c++)e[c]=t/a&255,a*=256;return e}Fe.writeUintLE=fb;function db(i,t){t===void 0&&(t=0);var e=new DataView(i.buffer,i.byteOffset,i.byteLength);return e.getFloat32(t)}Fe.readFloat32BE=db;function pb(i,t){t===void 0&&(t=0);var e=new DataView(i.buffer,i.byteOffset,i.byteLength);return e.getFloat32(t,!0)}Fe.readFloat32LE=pb;function gb(i,t){t===void 0&&(t=0);var e=new DataView(i.buffer,i.byteOffset,i.byteLength);return e.getFloat64(t)}Fe.readFloat64BE=gb;function _b(i,t){t===void 0&&(t=0);var e=new DataView(i.buffer,i.byteOffset,i.byteLength);return e.getFloat64(t,!0)}Fe.readFloat64LE=_b;function yb(i,t,e){t===void 0&&(t=new Uint8Array(4)),e===void 0&&(e=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(e,i),t}Fe.writeFloat32BE=yb;function vb(i,t,e){t===void 0&&(t=new Uint8Array(4)),e===void 0&&(e=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(e,i,!0),t}Fe.writeFloat32LE=vb;function bb(i,t,e){t===void 0&&(t=new Uint8Array(8)),e===void 0&&(e=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(e,i),t}Fe.writeFloat64BE=bb;function mb(i,t,e){t===void 0&&(t=new Uint8Array(8)),e===void 0&&(e=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(e,i,!0),t}Fe.writeFloat64LE=mb;var Dr={};Object.defineProperty(Dr,"__esModule",{value:!0});function wb(i){for(var t=0;t<i.length;t++)i[t]=0;return i}Dr.wipe=wb;Object.defineProperty(Ra,"__esModule",{value:!0});var Zt=Fe,qc=Dr,Eb=20;function Db(i,t,e){for(var s=1634760805,a=857760878,c=2036477234,d=1797285236,f=e[3]<<24|e[2]<<16|e[1]<<8|e[0],_=e[7]<<24|e[6]<<16|e[5]<<8|e[4],g=e[11]<<24|e[10]<<16|e[9]<<8|e[8],D=e[15]<<24|e[14]<<16|e[13]<<8|e[12],N=e[19]<<24|e[18]<<16|e[17]<<8|e[16],P=e[23]<<24|e[22]<<16|e[21]<<8|e[20],T=e[27]<<24|e[26]<<16|e[25]<<8|e[24],R=e[31]<<24|e[30]<<16|e[29]<<8|e[28],H=t[3]<<24|t[2]<<16|t[1]<<8|t[0],G=t[7]<<24|t[6]<<16|t[5]<<8|t[4],ie=t[11]<<24|t[10]<<16|t[9]<<8|t[8],E=t[15]<<24|t[14]<<16|t[13]<<8|t[12],x=s,m=a,S=c,y=d,u=f,v=_,K=g,V=D,ae=N,ce=P,ge=T,U=R,z=H,le=G,te=ie,W=E,ee=0;ee<Eb;ee+=2)x=x+u|0,z^=x,z=z>>>32-16|z<<16,ae=ae+z|0,u^=ae,u=u>>>32-12|u<<12,m=m+v|0,le^=m,le=le>>>32-16|le<<16,ce=ce+le|0,v^=ce,v=v>>>32-12|v<<12,S=S+K|0,te^=S,te=te>>>32-16|te<<16,ge=ge+te|0,K^=ge,K=K>>>32-12|K<<12,y=y+V|0,W^=y,W=W>>>32-16|W<<16,U=U+W|0,V^=U,V=V>>>32-12|V<<12,S=S+K|0,te^=S,te=te>>>32-8|te<<8,ge=ge+te|0,K^=ge,K=K>>>32-7|K<<7,y=y+V|0,W^=y,W=W>>>32-8|W<<8,U=U+W|0,V^=U,V=V>>>32-7|V<<7,m=m+v|0,le^=m,le=le>>>32-8|le<<8,ce=ce+le|0,v^=ce,v=v>>>32-7|v<<7,x=x+u|0,z^=x,z=z>>>32-8|z<<8,ae=ae+z|0,u^=ae,u=u>>>32-7|u<<7,x=x+v|0,W^=x,W=W>>>32-16|W<<16,ge=ge+W|0,v^=ge,v=v>>>32-12|v<<12,m=m+K|0,z^=m,z=z>>>32-16|z<<16,U=U+z|0,K^=U,K=K>>>32-12|K<<12,S=S+V|0,le^=S,le=le>>>32-16|le<<16,ae=ae+le|0,V^=ae,V=V>>>32-12|V<<12,y=y+u|0,te^=y,te=te>>>32-16|te<<16,ce=ce+te|0,u^=ce,u=u>>>32-12|u<<12,S=S+V|0,le^=S,le=le>>>32-8|le<<8,ae=ae+le|0,V^=ae,V=V>>>32-7|V<<7,y=y+u|0,te^=y,te=te>>>32-8|te<<8,ce=ce+te|0,u^=ce,u=u>>>32-7|u<<7,m=m+K|0,z^=m,z=z>>>32-8|z<<8,U=U+z|0,K^=U,K=K>>>32-7|K<<7,x=x+v|0,W^=x,W=W>>>32-8|W<<8,ge=ge+W|0,v^=ge,v=v>>>32-7|v<<7;Zt.writeUint32LE(x+s|0,i,0),Zt.writeUint32LE(m+a|0,i,4),Zt.writeUint32LE(S+c|0,i,8),Zt.writeUint32LE(y+d|0,i,12),Zt.writeUint32LE(u+f|0,i,16),Zt.writeUint32LE(v+_|0,i,20),Zt.writeUint32LE(K+g|0,i,24),Zt.writeUint32LE(V+D|0,i,28),Zt.writeUint32LE(ae+N|0,i,32),Zt.writeUint32LE(ce+P|0,i,36),Zt.writeUint32LE(ge+T|0,i,40),Zt.writeUint32LE(U+R|0,i,44),Zt.writeUint32LE(z+H|0,i,48),Zt.writeUint32LE(le+G|0,i,52),Zt.writeUint32LE(te+ie|0,i,56),Zt.writeUint32LE(W+E|0,i,60)}function hd(i,t,e,s,a){if(a===void 0&&(a=0),i.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<e.length)throw new Error("ChaCha: destination is shorter than source");var c,d;if(a===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),d=c.length-t.length,c.set(t,d)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=t,d=a}for(var f=new Uint8Array(64),_=0;_<e.length;_+=64){Db(f,c,i);for(var g=_;g<_+64&&g<e.length;g++)s[g]=e[g]^f[g-_];Ib(c,0,d)}return qc.wipe(f),a===0&&qc.wipe(c),s}Ra.streamXOR=hd;function Sb(i,t,e,s){return s===void 0&&(s=0),qc.wipe(e),hd(i,t,e,e,s)}Ra.stream=Sb;function Ib(i,t,e){for(var s=1;e--;)s=s+(i[t]&255)|0,i[t]=s&255,s>>>=8,t++;if(s>0)throw new Error("ChaCha: counter overflow")}var ld={},Oi={};Object.defineProperty(Oi,"__esModule",{value:!0});function xb(i,t,e){return~(i-1)&t|i-1&e}Oi.select=xb;function Ob(i,t){return(i|0)-(t|0)-1>>>31&1}Oi.lessOrEqual=Ob;function fd(i,t){if(i.length!==t.length)return 0;for(var e=0,s=0;s<i.length;s++)e|=i[s]^t[s];return 1&e-1>>>8}Oi.compare=fd;function Pb(i,t){return i.length===0||t.length===0?!1:fd(i,t)!==0}Oi.equal=Pb;(function(i){Object.defineProperty(i,"__esModule",{value:!0});var t=Oi,e=Dr;i.DIGEST_LENGTH=16;var s=function(){function d(f){this.digestLength=i.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var _=f[0]|f[1]<<8;this._r[0]=_&8191;var g=f[2]|f[3]<<8;this._r[1]=(_>>>13|g<<3)&8191;var D=f[4]|f[5]<<8;this._r[2]=(g>>>10|D<<6)&7939;var N=f[6]|f[7]<<8;this._r[3]=(D>>>7|N<<9)&8191;var P=f[8]|f[9]<<8;this._r[4]=(N>>>4|P<<12)&255,this._r[5]=P>>>1&8190;var T=f[10]|f[11]<<8;this._r[6]=(P>>>14|T<<2)&8191;var R=f[12]|f[13]<<8;this._r[7]=(T>>>11|R<<5)&8065;var H=f[14]|f[15]<<8;this._r[8]=(R>>>8|H<<8)&8191,this._r[9]=H>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return d.prototype._blocks=function(f,_,g){for(var D=this._fin?0:2048,N=this._h[0],P=this._h[1],T=this._h[2],R=this._h[3],H=this._h[4],G=this._h[5],ie=this._h[6],E=this._h[7],x=this._h[8],m=this._h[9],S=this._r[0],y=this._r[1],u=this._r[2],v=this._r[3],K=this._r[4],V=this._r[5],ae=this._r[6],ce=this._r[7],ge=this._r[8],U=this._r[9];g>=16;){var z=f[_+0]|f[_+1]<<8;N+=z&8191;var le=f[_+2]|f[_+3]<<8;P+=(z>>>13|le<<3)&8191;var te=f[_+4]|f[_+5]<<8;T+=(le>>>10|te<<6)&8191;var W=f[_+6]|f[_+7]<<8;R+=(te>>>7|W<<9)&8191;var ee=f[_+8]|f[_+9]<<8;H+=(W>>>4|ee<<12)&8191,G+=ee>>>1&8191;var Y=f[_+10]|f[_+11]<<8;ie+=(ee>>>14|Y<<2)&8191;var re=f[_+12]|f[_+13]<<8;E+=(Y>>>11|re<<5)&8191;var xe=f[_+14]|f[_+15]<<8;x+=(re>>>8|xe<<8)&8191,m+=xe>>>5|D;var ne=0,me=ne;me+=N*S,me+=P*(5*U),me+=T*(5*ge),me+=R*(5*ce),me+=H*(5*ae),ne=me>>>13,me&=8191,me+=G*(5*V),me+=ie*(5*K),me+=E*(5*v),me+=x*(5*u),me+=m*(5*y),ne+=me>>>13,me&=8191;var he=ne;he+=N*y,he+=P*S,he+=T*(5*U),he+=R*(5*ge),he+=H*(5*ce),ne=he>>>13,he&=8191,he+=G*(5*ae),he+=ie*(5*V),he+=E*(5*K),he+=x*(5*v),he+=m*(5*u),ne+=he>>>13,he&=8191;var ye=ne;ye+=N*u,ye+=P*y,ye+=T*S,ye+=R*(5*U),ye+=H*(5*ge),ne=ye>>>13,ye&=8191,ye+=G*(5*ce),ye+=ie*(5*ae),ye+=E*(5*V),ye+=x*(5*K),ye+=m*(5*v),ne+=ye>>>13,ye&=8191;var q=ne;q+=N*v,q+=P*u,q+=T*y,q+=R*S,q+=H*(5*U),ne=q>>>13,q&=8191,q+=G*(5*ge),q+=ie*(5*ce),q+=E*(5*ae),q+=x*(5*V),q+=m*(5*K),ne+=q>>>13,q&=8191;var M=ne;M+=N*K,M+=P*v,M+=T*u,M+=R*y,M+=H*S,ne=M>>>13,M&=8191,M+=G*(5*U),M+=ie*(5*ge),M+=E*(5*ce),M+=x*(5*ae),M+=m*(5*V),ne+=M>>>13,M&=8191;var $=ne;$+=N*V,$+=P*K,$+=T*v,$+=R*u,$+=H*y,ne=$>>>13,$&=8191,$+=G*S,$+=ie*(5*U),$+=E*(5*ge),$+=x*(5*ce),$+=m*(5*ae),ne+=$>>>13,$&=8191;var l=ne;l+=N*ae,l+=P*V,l+=T*K,l+=R*v,l+=H*u,ne=l>>>13,l&=8191,l+=G*y,l+=ie*S,l+=E*(5*U),l+=x*(5*ge),l+=m*(5*ce),ne+=l>>>13,l&=8191;var C=ne;C+=N*ce,C+=P*ae,C+=T*V,C+=R*K,C+=H*v,ne=C>>>13,C&=8191,C+=G*u,C+=ie*y,C+=E*S,C+=x*(5*U),C+=m*(5*ge),ne+=C>>>13,C&=8191;var se=ne;se+=N*ge,se+=P*ce,se+=T*ae,se+=R*V,se+=H*K,ne=se>>>13,se&=8191,se+=G*v,se+=ie*u,se+=E*y,se+=x*S,se+=m*(5*U),ne+=se>>>13,se&=8191;var fe=ne;fe+=N*U,fe+=P*ge,fe+=T*ce,fe+=R*ae,fe+=H*V,ne=fe>>>13,fe&=8191,fe+=G*K,fe+=ie*v,fe+=E*u,fe+=x*y,fe+=m*S,ne+=fe>>>13,fe&=8191,ne=(ne<<2)+ne|0,ne=ne+me|0,me=ne&8191,ne=ne>>>13,he+=ne,N=me,P=he,T=ye,R=q,H=M,G=$,ie=l,E=C,x=se,m=fe,_+=16,g-=16}this._h[0]=N,this._h[1]=P,this._h[2]=T,this._h[3]=R,this._h[4]=H,this._h[5]=G,this._h[6]=ie,this._h[7]=E,this._h[8]=x,this._h[9]=m},d.prototype.finish=function(f,_){_===void 0&&(_=0);var g=new Uint16Array(10),D,N,P,T;if(this._leftover){for(T=this._leftover,this._buffer[T++]=1;T<16;T++)this._buffer[T]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(D=this._h[1]>>>13,this._h[1]&=8191,T=2;T<10;T++)this._h[T]+=D,D=this._h[T]>>>13,this._h[T]&=8191;for(this._h[0]+=D*5,D=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=D,D=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=D,g[0]=this._h[0]+5,D=g[0]>>>13,g[0]&=8191,T=1;T<10;T++)g[T]=this._h[T]+D,D=g[T]>>>13,g[T]&=8191;for(g[9]-=1<<13,N=(D^1)-1,T=0;T<10;T++)g[T]&=N;for(N=~N,T=0;T<10;T++)this._h[T]=this._h[T]&N|g[T];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,P=this._h[0]+this._pad[0],this._h[0]=P&65535,T=1;T<8;T++)P=(this._h[T]+this._pad[T]|0)+(P>>>16)|0,this._h[T]=P&65535;return f[_+0]=this._h[0]>>>0,f[_+1]=this._h[0]>>>8,f[_+2]=this._h[1]>>>0,f[_+3]=this._h[1]>>>8,f[_+4]=this._h[2]>>>0,f[_+5]=this._h[2]>>>8,f[_+6]=this._h[3]>>>0,f[_+7]=this._h[3]>>>8,f[_+8]=this._h[4]>>>0,f[_+9]=this._h[4]>>>8,f[_+10]=this._h[5]>>>0,f[_+11]=this._h[5]>>>8,f[_+12]=this._h[6]>>>0,f[_+13]=this._h[6]>>>8,f[_+14]=this._h[7]>>>0,f[_+15]=this._h[7]>>>8,this._finished=!0,this},d.prototype.update=function(f){var _=0,g=f.length,D;if(this._leftover){D=16-this._leftover,D>g&&(D=g);for(var N=0;N<D;N++)this._buffer[this._leftover+N]=f[_+N];if(g-=D,_+=D,this._leftover+=D,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(g>=16&&(D=g-g%16,this._blocks(f,_,D),_+=D,g-=D),g){for(var N=0;N<g;N++)this._buffer[this._leftover+N]=f[_+N];this._leftover+=g}return this},d.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},d.prototype.clean=function(){return e.wipe(this._buffer),e.wipe(this._r),e.wipe(this._h),e.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},d}();i.Poly1305=s;function a(d,f){var _=new s(d);_.update(f);var g=_.digest();return _.clean(),g}i.oneTimeAuth=a;function c(d,f){return d.length!==i.DIGEST_LENGTH||f.length!==i.DIGEST_LENGTH?!1:t.equal(d,f)}i.equal=c})(ld);(function(i){Object.defineProperty(i,"__esModule",{value:!0});var t=Ra,e=ld,s=Dr,a=Fe,c=Oi;i.KEY_LENGTH=32,i.NONCE_LENGTH=12,i.TAG_LENGTH=16;var d=new Uint8Array(16),f=function(){function _(g){if(this.nonceLength=i.NONCE_LENGTH,this.tagLength=i.TAG_LENGTH,g.length!==i.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(g)}return _.prototype.seal=function(g,D,N,P){if(g.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var T=new Uint8Array(16);T.set(g,T.length-g.length);var R=new Uint8Array(32);t.stream(this._key,T,R,4);var H=D.length+this.tagLength,G;if(P){if(P.length!==H)throw new Error("ChaCha20Poly1305: incorrect destination length");G=P}else G=new Uint8Array(H);return t.streamXOR(this._key,T,D,G,4),this._authenticate(G.subarray(G.length-this.tagLength,G.length),R,G.subarray(0,G.length-this.tagLength),N),s.wipe(T),G},_.prototype.open=function(g,D,N,P){if(g.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(D.length<this.tagLength)return null;var T=new Uint8Array(16);T.set(g,T.length-g.length);var R=new Uint8Array(32);t.stream(this._key,T,R,4);var H=new Uint8Array(this.tagLength);if(this._authenticate(H,R,D.subarray(0,D.length-this.tagLength),N),!c.equal(H,D.subarray(D.length-this.tagLength,D.length)))return null;var G=D.length-this.tagLength,ie;if(P){if(P.length!==G)throw new Error("ChaCha20Poly1305: incorrect destination length");ie=P}else ie=new Uint8Array(G);return t.streamXOR(this._key,T,D.subarray(0,D.length-this.tagLength),ie,4),s.wipe(T),ie},_.prototype.clean=function(){return s.wipe(this._key),this},_.prototype._authenticate=function(g,D,N,P){var T=new e.Poly1305(D);P&&(T.update(P),P.length%16>0&&T.update(d.subarray(P.length%16))),T.update(N),N.length%16>0&&T.update(d.subarray(N.length%16));var R=new Uint8Array(8);P&&a.writeUint64LE(P.length,R),T.update(R),a.writeUint64LE(N.length,R),T.update(R);for(var H=T.digest(),G=0;G<H.length;G++)g[G]=H[G];T.clean(),s.wipe(H),s.wipe(R)},_}();i.ChaCha20Poly1305=f})(vu);var dd={},ls={},bu={};Object.defineProperty(bu,"__esModule",{value:!0});function Cb(i){return typeof i.saveState<"u"&&typeof i.restoreState<"u"&&typeof i.cleanSavedState<"u"}bu.isSerializableHash=Cb;Object.defineProperty(ls,"__esModule",{value:!0});var Yr=bu,Ab=Oi,Nb=Dr,pd=function(){function i(t,e){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);e.length>this.blockSize?this._inner.update(e).finish(s).clean():s.set(e);for(var a=0;a<s.length;a++)s[a]^=54;this._inner.update(s);for(var a=0;a<s.length;a++)s[a]^=106;this._outer.update(s),Yr.isSerializableHash(this._inner)&&Yr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Nb.wipe(s)}return i.prototype.reset=function(){if(!Yr.isSerializableHash(this._inner)||!Yr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.clean=function(){Yr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Yr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},i.prototype.update=function(t){return this._inner.update(t),this},i.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},i.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},i.prototype.saveState=function(){if(!Yr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},i.prototype.restoreState=function(t){if(!Yr.isSerializableHash(this._inner)||!Yr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.cleanSavedState=function(t){if(!Yr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},i}();ls.HMAC=pd;function Tb(i,t,e){var s=new pd(i,t);s.update(e);var a=s.digest();return s.clean(),a}ls.hmac=Tb;ls.equal=Ab.equal;Object.defineProperty(dd,"__esModule",{value:!0});var Tl=ls,Rl=Dr,Rb=function(){function i(t,e,s,a){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=a;var c=Tl.hmac(this._hash,s,e);this._hmac=new Tl.HMAC(t,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return i.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},i.prototype.expand=function(t){for(var e=new Uint8Array(t),s=0;s<e.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),e[s]=this._buffer[this._bufpos++];return e},i.prototype.clean=function(){this._hmac.clean(),Rl.wipe(this._buffer),Rl.wipe(this._counter),this._bufpos=0},i}(),$b=dd.HKDF=Rb,xn={},$a={},Ua={};Object.defineProperty(Ua,"__esModule",{value:!0});Ua.BrowserRandomSource=void 0;const $l=65536;class Ub{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const e=new Uint8Array(t);for(let s=0;s<e.length;s+=$l)this._crypto.getRandomValues(e.subarray(s,s+Math.min(e.length-s,$l)));return e}}Ua.BrowserRandomSource=Ub;function Fb(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Fa={},jb={},Lb=Object.freeze({__proto__:null,default:jb}),Mb=In(Lb);Object.defineProperty(Fa,"__esModule",{value:!0});Fa.NodeRandomSource=void 0;const qb=Dr;class zb{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Fb<"u"){const t=Mb;t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let e=this._crypto.randomBytes(t);if(e.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(t);for(let a=0;a<s.length;a++)s[a]=e[a];return(0,qb.wipe)(e),s}}Fa.NodeRandomSource=zb;Object.defineProperty($a,"__esModule",{value:!0});$a.SystemRandomSource=void 0;const Hb=Ua,Bb=Fa;class Kb{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Hb.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Bb.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}$a.SystemRandomSource=Kb;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.randomStringForEntropy=i.randomString=i.randomUint32=i.randomBytes=i.defaultRandomSource=void 0;const t=$a,e=Fe,s=Dr;i.defaultRandomSource=new t.SystemRandomSource;function a(g,D=i.defaultRandomSource){return D.randomBytes(g)}i.randomBytes=a;function c(g=i.defaultRandomSource){const D=a(4,g),N=(0,e.readUint32LE)(D);return(0,s.wipe)(D),N}i.randomUint32=c;const d="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(g,D=d,N=i.defaultRandomSource){if(D.length<2)throw new Error("randomString charset is too short");if(D.length>256)throw new Error("randomString charset is too long");let P="";const T=D.length,R=256-256%T;for(;g>0;){const H=a(Math.ceil(g*256/R),N);for(let G=0;G<H.length&&g>0;G++){const ie=H[G];ie<R&&(P+=D.charAt(ie%T),g--)}(0,s.wipe)(H)}return P}i.randomString=f;function _(g,D=d,N=i.defaultRandomSource){const P=Math.ceil(g/(Math.log(D.length)/Math.LN2));return f(P,D,N)}i.randomStringForEntropy=_})(xn);var ja={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var t=Fe,e=Dr;i.DIGEST_LENGTH=32,i.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){e.wipe(this._buffer),e.wipe(this._temp),this.reset()},f.prototype.update=function(_,g){if(g===void 0&&(g=_.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var D=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&g>0;)this._buffer[this._bufferLength++]=_[D++],g--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(D=c(this._temp,this._state,_,D,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=_[D++],g--;return this},f.prototype.finish=function(_){if(!this._finished){var g=this._bytesHashed,D=this._bufferLength,N=g/536870912|0,P=g<<3,T=g%64<56?64:128;this._buffer[D]=128;for(var R=D+1;R<T-8;R++)this._buffer[R]=0;t.writeUint32BE(N,this._buffer,T-8),t.writeUint32BE(P,this._buffer,T-4),c(this._temp,this._state,this._buffer,0,T),this._finished=!0}for(var R=0;R<this.digestLength/4;R++)t.writeUint32BE(this._state[R],_,R*4);return this},f.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(_){return this._state.set(_.state),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(_){e.wipe(_.state),_.buffer&&e.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},f}();i.SHA256=s;var a=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(f,_,g,D,N){for(;N>=64;){for(var P=_[0],T=_[1],R=_[2],H=_[3],G=_[4],ie=_[5],E=_[6],x=_[7],m=0;m<16;m++){var S=D+m*4;f[m]=t.readUint32BE(g,S)}for(var m=16;m<64;m++){var y=f[m-2],u=(y>>>17|y<<32-17)^(y>>>19|y<<32-19)^y>>>10;y=f[m-15];var v=(y>>>7|y<<32-7)^(y>>>18|y<<32-18)^y>>>3;f[m]=(u+f[m-7]|0)+(v+f[m-16]|0)}for(var m=0;m<64;m++){var u=(((G>>>6|G<<26)^(G>>>11|G<<21)^(G>>>25|G<<7))+(G&ie^~G&E)|0)+(x+(a[m]+f[m]|0)|0)|0,v=((P>>>2|P<<32-2)^(P>>>13|P<<32-13)^(P>>>22|P<<32-22))+(P&T^P&R^T&R)|0;x=E,E=ie,ie=G,G=H+u|0,H=R,R=T,T=P,P=u+v|0}_[0]+=P,_[1]+=T,_[2]+=R,_[3]+=H,_[4]+=G,_[5]+=ie,_[6]+=E,_[7]+=x,D+=64,N-=64}return D}function d(f){var _=new s;_.update(f);var g=_.digest();return _.clean(),g}i.hash=d})(ja);var mu={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.sharedKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.scalarMultBase=i.scalarMult=i.SHARED_KEY_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=void 0;const t=xn,e=Dr;i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=32,i.SHARED_KEY_LENGTH=32;function s(m){const S=new Float64Array(16);if(m)for(let y=0;y<m.length;y++)S[y]=m[y];return S}const a=new Uint8Array(32);a[0]=9;const c=s([56129,1]);function d(m){let S=1;for(let y=0;y<16;y++){let u=m[y]+S+65535;S=Math.floor(u/65536),m[y]=u-S*65536}m[0]+=S-1+37*(S-1)}function f(m,S,y){const u=~(y-1);for(let v=0;v<16;v++){const K=u&(m[v]^S[v]);m[v]^=K,S[v]^=K}}function _(m,S){const y=s(),u=s();for(let v=0;v<16;v++)u[v]=S[v];d(u),d(u),d(u);for(let v=0;v<2;v++){y[0]=u[0]-65517;for(let V=1;V<15;V++)y[V]=u[V]-65535-(y[V-1]>>16&1),y[V-1]&=65535;y[15]=u[15]-32767-(y[14]>>16&1);const K=y[15]>>16&1;y[14]&=65535,f(u,y,1-K)}for(let v=0;v<16;v++)m[2*v]=u[v]&255,m[2*v+1]=u[v]>>8}function g(m,S){for(let y=0;y<16;y++)m[y]=S[2*y]+(S[2*y+1]<<8);m[15]&=32767}function D(m,S,y){for(let u=0;u<16;u++)m[u]=S[u]+y[u]}function N(m,S,y){for(let u=0;u<16;u++)m[u]=S[u]-y[u]}function P(m,S,y){let u,v,K=0,V=0,ae=0,ce=0,ge=0,U=0,z=0,le=0,te=0,W=0,ee=0,Y=0,re=0,xe=0,ne=0,me=0,he=0,ye=0,q=0,M=0,$=0,l=0,C=0,se=0,fe=0,Se=0,He=0,Ve=0,je=0,dt=0,pt=0,Me=y[0],Ie=y[1],Re=y[2],$e=y[3],qe=y[4],Pe=y[5],Ue=y[6],De=y[7],Ce=y[8],Be=y[9],Oe=y[10],ke=y[11],We=y[12],et=y[13],tt=y[14],Je=y[15];u=S[0],K+=u*Me,V+=u*Ie,ae+=u*Re,ce+=u*$e,ge+=u*qe,U+=u*Pe,z+=u*Ue,le+=u*De,te+=u*Ce,W+=u*Be,ee+=u*Oe,Y+=u*ke,re+=u*We,xe+=u*et,ne+=u*tt,me+=u*Je,u=S[1],V+=u*Me,ae+=u*Ie,ce+=u*Re,ge+=u*$e,U+=u*qe,z+=u*Pe,le+=u*Ue,te+=u*De,W+=u*Ce,ee+=u*Be,Y+=u*Oe,re+=u*ke,xe+=u*We,ne+=u*et,me+=u*tt,he+=u*Je,u=S[2],ae+=u*Me,ce+=u*Ie,ge+=u*Re,U+=u*$e,z+=u*qe,le+=u*Pe,te+=u*Ue,W+=u*De,ee+=u*Ce,Y+=u*Be,re+=u*Oe,xe+=u*ke,ne+=u*We,me+=u*et,he+=u*tt,ye+=u*Je,u=S[3],ce+=u*Me,ge+=u*Ie,U+=u*Re,z+=u*$e,le+=u*qe,te+=u*Pe,W+=u*Ue,ee+=u*De,Y+=u*Ce,re+=u*Be,xe+=u*Oe,ne+=u*ke,me+=u*We,he+=u*et,ye+=u*tt,q+=u*Je,u=S[4],ge+=u*Me,U+=u*Ie,z+=u*Re,le+=u*$e,te+=u*qe,W+=u*Pe,ee+=u*Ue,Y+=u*De,re+=u*Ce,xe+=u*Be,ne+=u*Oe,me+=u*ke,he+=u*We,ye+=u*et,q+=u*tt,M+=u*Je,u=S[5],U+=u*Me,z+=u*Ie,le+=u*Re,te+=u*$e,W+=u*qe,ee+=u*Pe,Y+=u*Ue,re+=u*De,xe+=u*Ce,ne+=u*Be,me+=u*Oe,he+=u*ke,ye+=u*We,q+=u*et,M+=u*tt,$+=u*Je,u=S[6],z+=u*Me,le+=u*Ie,te+=u*Re,W+=u*$e,ee+=u*qe,Y+=u*Pe,re+=u*Ue,xe+=u*De,ne+=u*Ce,me+=u*Be,he+=u*Oe,ye+=u*ke,q+=u*We,M+=u*et,$+=u*tt,l+=u*Je,u=S[7],le+=u*Me,te+=u*Ie,W+=u*Re,ee+=u*$e,Y+=u*qe,re+=u*Pe,xe+=u*Ue,ne+=u*De,me+=u*Ce,he+=u*Be,ye+=u*Oe,q+=u*ke,M+=u*We,$+=u*et,l+=u*tt,C+=u*Je,u=S[8],te+=u*Me,W+=u*Ie,ee+=u*Re,Y+=u*$e,re+=u*qe,xe+=u*Pe,ne+=u*Ue,me+=u*De,he+=u*Ce,ye+=u*Be,q+=u*Oe,M+=u*ke,$+=u*We,l+=u*et,C+=u*tt,se+=u*Je,u=S[9],W+=u*Me,ee+=u*Ie,Y+=u*Re,re+=u*$e,xe+=u*qe,ne+=u*Pe,me+=u*Ue,he+=u*De,ye+=u*Ce,q+=u*Be,M+=u*Oe,$+=u*ke,l+=u*We,C+=u*et,se+=u*tt,fe+=u*Je,u=S[10],ee+=u*Me,Y+=u*Ie,re+=u*Re,xe+=u*$e,ne+=u*qe,me+=u*Pe,he+=u*Ue,ye+=u*De,q+=u*Ce,M+=u*Be,$+=u*Oe,l+=u*ke,C+=u*We,se+=u*et,fe+=u*tt,Se+=u*Je,u=S[11],Y+=u*Me,re+=u*Ie,xe+=u*Re,ne+=u*$e,me+=u*qe,he+=u*Pe,ye+=u*Ue,q+=u*De,M+=u*Ce,$+=u*Be,l+=u*Oe,C+=u*ke,se+=u*We,fe+=u*et,Se+=u*tt,He+=u*Je,u=S[12],re+=u*Me,xe+=u*Ie,ne+=u*Re,me+=u*$e,he+=u*qe,ye+=u*Pe,q+=u*Ue,M+=u*De,$+=u*Ce,l+=u*Be,C+=u*Oe,se+=u*ke,fe+=u*We,Se+=u*et,He+=u*tt,Ve+=u*Je,u=S[13],xe+=u*Me,ne+=u*Ie,me+=u*Re,he+=u*$e,ye+=u*qe,q+=u*Pe,M+=u*Ue,$+=u*De,l+=u*Ce,C+=u*Be,se+=u*Oe,fe+=u*ke,Se+=u*We,He+=u*et,Ve+=u*tt,je+=u*Je,u=S[14],ne+=u*Me,me+=u*Ie,he+=u*Re,ye+=u*$e,q+=u*qe,M+=u*Pe,$+=u*Ue,l+=u*De,C+=u*Ce,se+=u*Be,fe+=u*Oe,Se+=u*ke,He+=u*We,Ve+=u*et,je+=u*tt,dt+=u*Je,u=S[15],me+=u*Me,he+=u*Ie,ye+=u*Re,q+=u*$e,M+=u*qe,$+=u*Pe,l+=u*Ue,C+=u*De,se+=u*Ce,fe+=u*Be,Se+=u*Oe,He+=u*ke,Ve+=u*We,je+=u*et,dt+=u*tt,pt+=u*Je,K+=38*he,V+=38*ye,ae+=38*q,ce+=38*M,ge+=38*$,U+=38*l,z+=38*C,le+=38*se,te+=38*fe,W+=38*Se,ee+=38*He,Y+=38*Ve,re+=38*je,xe+=38*dt,ne+=38*pt,v=1,u=K+v+65535,v=Math.floor(u/65536),K=u-v*65536,u=V+v+65535,v=Math.floor(u/65536),V=u-v*65536,u=ae+v+65535,v=Math.floor(u/65536),ae=u-v*65536,u=ce+v+65535,v=Math.floor(u/65536),ce=u-v*65536,u=ge+v+65535,v=Math.floor(u/65536),ge=u-v*65536,u=U+v+65535,v=Math.floor(u/65536),U=u-v*65536,u=z+v+65535,v=Math.floor(u/65536),z=u-v*65536,u=le+v+65535,v=Math.floor(u/65536),le=u-v*65536,u=te+v+65535,v=Math.floor(u/65536),te=u-v*65536,u=W+v+65535,v=Math.floor(u/65536),W=u-v*65536,u=ee+v+65535,v=Math.floor(u/65536),ee=u-v*65536,u=Y+v+65535,v=Math.floor(u/65536),Y=u-v*65536,u=re+v+65535,v=Math.floor(u/65536),re=u-v*65536,u=xe+v+65535,v=Math.floor(u/65536),xe=u-v*65536,u=ne+v+65535,v=Math.floor(u/65536),ne=u-v*65536,u=me+v+65535,v=Math.floor(u/65536),me=u-v*65536,K+=v-1+37*(v-1),v=1,u=K+v+65535,v=Math.floor(u/65536),K=u-v*65536,u=V+v+65535,v=Math.floor(u/65536),V=u-v*65536,u=ae+v+65535,v=Math.floor(u/65536),ae=u-v*65536,u=ce+v+65535,v=Math.floor(u/65536),ce=u-v*65536,u=ge+v+65535,v=Math.floor(u/65536),ge=u-v*65536,u=U+v+65535,v=Math.floor(u/65536),U=u-v*65536,u=z+v+65535,v=Math.floor(u/65536),z=u-v*65536,u=le+v+65535,v=Math.floor(u/65536),le=u-v*65536,u=te+v+65535,v=Math.floor(u/65536),te=u-v*65536,u=W+v+65535,v=Math.floor(u/65536),W=u-v*65536,u=ee+v+65535,v=Math.floor(u/65536),ee=u-v*65536,u=Y+v+65535,v=Math.floor(u/65536),Y=u-v*65536,u=re+v+65535,v=Math.floor(u/65536),re=u-v*65536,u=xe+v+65535,v=Math.floor(u/65536),xe=u-v*65536,u=ne+v+65535,v=Math.floor(u/65536),ne=u-v*65536,u=me+v+65535,v=Math.floor(u/65536),me=u-v*65536,K+=v-1+37*(v-1),m[0]=K,m[1]=V,m[2]=ae,m[3]=ce,m[4]=ge,m[5]=U,m[6]=z,m[7]=le,m[8]=te,m[9]=W,m[10]=ee,m[11]=Y,m[12]=re,m[13]=xe,m[14]=ne,m[15]=me}function T(m,S){P(m,S,S)}function R(m,S){const y=s();for(let u=0;u<16;u++)y[u]=S[u];for(let u=253;u>=0;u--)T(y,y),u!==2&&u!==4&&P(y,y,S);for(let u=0;u<16;u++)m[u]=y[u]}function H(m,S){const y=new Uint8Array(32),u=new Float64Array(80),v=s(),K=s(),V=s(),ae=s(),ce=s(),ge=s();for(let te=0;te<31;te++)y[te]=m[te];y[31]=m[31]&127|64,y[0]&=248,g(u,S);for(let te=0;te<16;te++)K[te]=u[te];v[0]=ae[0]=1;for(let te=254;te>=0;--te){const W=y[te>>>3]>>>(te&7)&1;f(v,K,W),f(V,ae,W),D(ce,v,V),N(v,v,V),D(V,K,ae),N(K,K,ae),T(ae,ce),T(ge,v),P(v,V,v),P(V,K,ce),D(ce,v,V),N(v,v,V),T(K,v),N(V,ae,ge),P(v,V,c),D(v,v,ae),P(V,V,v),P(v,ae,ge),P(ae,K,u),T(K,ce),f(v,K,W),f(V,ae,W)}for(let te=0;te<16;te++)u[te+16]=v[te],u[te+32]=V[te],u[te+48]=K[te],u[te+64]=ae[te];const U=u.subarray(32),z=u.subarray(16);R(U,U),P(z,z,U);const le=new Uint8Array(32);return _(le,z),le}i.scalarMult=H;function G(m){return H(m,a)}i.scalarMultBase=G;function ie(m){if(m.length!==i.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${i.SECRET_KEY_LENGTH} bytes`);const S=new Uint8Array(m);return{publicKey:G(S),secretKey:S}}i.generateKeyPairFromSeed=ie;function E(m){const S=(0,t.randomBytes)(32,m),y=ie(S);return(0,e.wipe)(S),y}i.generateKeyPair=E;function x(m,S,y=!1){if(m.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(S.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const u=H(m,S);if(y){let v=0;for(let K=0;K<u.length;K++)v|=u[K];if(v===0)throw new Error("X25519: invalid shared key")}return u}i.sharedKey=x})(mu);function wu(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function gd(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?wu(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function zc(i,t){t||(t=i.reduce((a,c)=>a+c.length,0));const e=gd(t);let s=0;for(const a of i)e.set(a,s),s+=a.length;return wu(e)}function Vb(i,t){if(i.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),s=0;s<e.length;s++)e[s]=255;for(var a=0;a<i.length;a++){var c=i.charAt(a),d=c.charCodeAt(0);if(e[d]!==255)throw new TypeError(c+" is ambiguous");e[d]=a}var f=i.length,_=i.charAt(0),g=Math.log(f)/Math.log(256),D=Math.log(256)/Math.log(f);function N(R){if(R instanceof Uint8Array||(ArrayBuffer.isView(R)?R=new Uint8Array(R.buffer,R.byteOffset,R.byteLength):Array.isArray(R)&&(R=Uint8Array.from(R))),!(R instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(R.length===0)return"";for(var H=0,G=0,ie=0,E=R.length;ie!==E&&R[ie]===0;)ie++,H++;for(var x=(E-ie)*D+1>>>0,m=new Uint8Array(x);ie!==E;){for(var S=R[ie],y=0,u=x-1;(S!==0||y<G)&&u!==-1;u--,y++)S+=256*m[u]>>>0,m[u]=S%f>>>0,S=S/f>>>0;if(S!==0)throw new Error("Non-zero carry");G=y,ie++}for(var v=x-G;v!==x&&m[v]===0;)v++;for(var K=_.repeat(H);v<x;++v)K+=i.charAt(m[v]);return K}function P(R){if(typeof R!="string")throw new TypeError("Expected String");if(R.length===0)return new Uint8Array;var H=0;if(R[H]!==" "){for(var G=0,ie=0;R[H]===_;)G++,H++;for(var E=(R.length-H)*g+1>>>0,x=new Uint8Array(E);R[H];){var m=e[R.charCodeAt(H)];if(m===255)return;for(var S=0,y=E-1;(m!==0||S<ie)&&y!==-1;y--,S++)m+=f*x[y]>>>0,x[y]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");ie=S,H++}if(R[H]!==" "){for(var u=E-ie;u!==E&&x[u]===0;)u++;for(var v=new Uint8Array(G+(E-u)),K=G;u!==E;)v[K++]=x[u++];return v}}}function T(R){var H=P(R);if(H)return H;throw new Error(`Non-${t} character`)}return{encode:N,decodeUnsafe:P,decode:T}}var kb=Vb,Gb=kb;const Wb=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},Yb=i=>new TextEncoder().encode(i),Jb=i=>new TextDecoder().decode(i);class Xb{constructor(t,e,s){this.name=t,this.prefix=e,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Zb{constructor(t,e,s){if(this.name=t,this.prefix=e,e.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return _d(this,t)}}class Qb{constructor(t){this.decoders=t}or(t){return _d(this,t)}decode(t){const e=t[0],s=this.decoders[e];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const _d=(i,t)=>new Qb({...i.decoders||{[i.prefix]:i},...t.decoders||{[t.prefix]:t}});class em{constructor(t,e,s,a){this.name=t,this.prefix=e,this.baseEncode=s,this.baseDecode=a,this.encoder=new Xb(t,e,s),this.decoder=new Zb(t,e,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const La=({name:i,prefix:t,encode:e,decode:s})=>new em(i,t,e,s),fs=({prefix:i,name:t,alphabet:e})=>{const{encode:s,decode:a}=Gb(e,t);return La({prefix:i,name:t,encode:s,decode:c=>Wb(a(c))})},tm=(i,t,e,s)=>{const a={};for(let D=0;D<t.length;++D)a[t[D]]=D;let c=i.length;for(;i[c-1]==="=";)--c;const d=new Uint8Array(c*e/8|0);let f=0,_=0,g=0;for(let D=0;D<c;++D){const N=a[i[D]];if(N===void 0)throw new SyntaxError(`Non-${s} character`);_=_<<e|N,f+=e,f>=8&&(f-=8,d[g++]=255&_>>f)}if(f>=e||255&_<<8-f)throw new SyntaxError("Unexpected end of data");return d},rm=(i,t,e)=>{const s=t[t.length-1]==="=",a=(1<<e)-1;let c="",d=0,f=0;for(let _=0;_<i.length;++_)for(f=f<<8|i[_],d+=8;d>e;)d-=e,c+=t[a&f>>d];if(d&&(c+=t[a&f<<e-d]),s)for(;c.length*e&7;)c+="=";return c},Wt=({name:i,prefix:t,bitsPerChar:e,alphabet:s})=>La({prefix:t,name:i,encode(a){return rm(a,s,e)},decode(a){return tm(a,s,e,i)}}),im=La({prefix:"\0",name:"identity",encode:i=>Jb(i),decode:i=>Yb(i)});var nm=Object.freeze({__proto__:null,identity:im});const sm=Wt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var am=Object.freeze({__proto__:null,base2:sm});const om=Wt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var cm=Object.freeze({__proto__:null,base8:om});const um=fs({prefix:"9",name:"base10",alphabet:"0123456789"});var hm=Object.freeze({__proto__:null,base10:um});const lm=Wt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),fm=Wt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var dm=Object.freeze({__proto__:null,base16:lm,base16upper:fm});const pm=Wt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),gm=Wt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_m=Wt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ym=Wt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),vm=Wt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),bm=Wt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),mm=Wt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),wm=Wt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Em=Wt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Dm=Object.freeze({__proto__:null,base32:pm,base32hex:vm,base32hexpad:mm,base32hexpadupper:wm,base32hexupper:bm,base32pad:_m,base32padupper:ym,base32upper:gm,base32z:Em});const Sm=fs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Im=fs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var xm=Object.freeze({__proto__:null,base36:Sm,base36upper:Im});const Om=fs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Pm=fs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Cm=Object.freeze({__proto__:null,base58btc:Om,base58flickr:Pm});const Am=Wt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Nm=Wt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Tm=Wt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Rm=Wt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var $m=Object.freeze({__proto__:null,base64:Am,base64pad:Nm,base64url:Tm,base64urlpad:Rm});const yd=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Um=yd.reduce((i,t,e)=>(i[e]=t,i),[]),Fm=yd.reduce((i,t,e)=>(i[t.codePointAt(0)]=e,i),[]);function jm(i){return i.reduce((t,e)=>(t+=Um[e],t),"")}function Lm(i){const t=[];for(const e of i){const s=Fm[e.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${e}`);t.push(s)}return new Uint8Array(t)}const Mm=La({prefix:"\u{1F680}",name:"base256emoji",encode:jm,decode:Lm});var qm=Object.freeze({__proto__:null,base256emoji:Mm});new TextEncoder;new TextDecoder;const Ul={...nm,...am,...cm,...hm,...dm,...Dm,...xm,...Cm,...$m,...qm};function vd(i,t,e,s){return{name:i,prefix:t,encoder:{name:i,prefix:t,encode:e},decoder:{decode:s}}}const Fl=vd("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),gc=vd("ascii","a",i=>{let t="a";for(let e=0;e<i.length;e++)t+=String.fromCharCode(i[e]);return t},i=>{i=i.substring(1);const t=gd(i.length);for(let e=0;e<i.length;e++)t[e]=i.charCodeAt(e);return t}),bd={utf8:Fl,"utf-8":Fl,hex:Ul.base16,latin1:gc,ascii:gc,binary:gc,...Ul};function _r(i,t="utf8"){const e=bd[t];if(!e)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?wu(globalThis.Buffer.from(i,"utf-8")):e.decoder.decode(`${e.prefix}${i}`)}function cr(i,t="utf8"){const e=bd[t];if(!e)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):e.encoder.encode(i).substring(1)}var ve={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Hc=function(i,t){return Hc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var a in s)s.hasOwnProperty(a)&&(e[a]=s[a])},Hc(i,t)};function zm(i,t){Hc(i,t);function e(){this.constructor=i}i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Bc=function(){return Bc=Object.assign||function(t){for(var e,s=1,a=arguments.length;s<a;s++){e=arguments[s];for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&(t[c]=e[c])}return t},Bc.apply(this,arguments)};function Hm(i,t){var e={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&t.indexOf(s)<0&&(e[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(i);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(i,s[a])&&(e[s[a]]=i[s[a]]);return e}function Bm(i,t,e,s){var a=arguments.length,c=a<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,e):s,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,t,e,s);else for(var f=i.length-1;f>=0;f--)(d=i[f])&&(c=(a<3?d(c):a>3?d(t,e,c):d(t,e))||c);return a>3&&c&&Object.defineProperty(t,e,c),c}function Km(i,t){return function(e,s){t(e,s,i)}}function Vm(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)}function km(i,t,e,s){function a(c){return c instanceof e?c:new e(function(d){d(c)})}return new(e||(e=Promise))(function(c,d){function f(D){try{g(s.next(D))}catch(N){d(N)}}function _(D){try{g(s.throw(D))}catch(N){d(N)}}function g(D){D.done?c(D.value):a(D.value).then(f,_)}g((s=s.apply(i,t||[])).next())})}function Gm(i,t){var e={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,a,c,d;return d={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function f(g){return function(D){return _([g,D])}}function _(g){if(s)throw new TypeError("Generator is already executing.");for(;e;)try{if(s=1,a&&(c=g[0]&2?a.return:g[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,g[1])).done)return c;switch(a=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return e.label++,{value:g[1],done:!1};case 5:e.label++,a=g[1],g=[0];continue;case 7:g=e.ops.pop(),e.trys.pop();continue;default:if(c=e.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){e=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){e.label=g[1];break}if(g[0]===6&&e.label<c[1]){e.label=c[1],c=g;break}if(c&&e.label<c[2]){e.label=c[2],e.ops.push(g);break}c[2]&&e.ops.pop(),e.trys.pop();continue}g=t.call(i,e)}catch(D){g=[6,D],a=0}finally{s=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function Wm(i,t,e,s){s===void 0&&(s=e),i[s]=t[e]}function Ym(i,t){for(var e in i)e!=="default"&&!t.hasOwnProperty(e)&&(t[e]=i[e])}function Kc(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],s=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function md(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var s=e.call(i),a,c=[],d;try{for(;(t===void 0||t-- >0)&&!(a=s.next()).done;)c.push(a.value)}catch(f){d={error:f}}finally{try{a&&!a.done&&(e=s.return)&&e.call(s)}finally{if(d)throw d.error}}return c}function Jm(){for(var i=[],t=0;t<arguments.length;t++)i=i.concat(md(arguments[t]));return i}function Xm(){for(var i=0,t=0,e=arguments.length;t<e;t++)i+=arguments[t].length;for(var s=Array(i),a=0,t=0;t<e;t++)for(var c=arguments[t],d=0,f=c.length;d<f;d++,a++)s[a]=c[d];return s}function as(i){return this instanceof as?(this.v=i,this):new as(i)}function Zm(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=e.apply(i,t||[]),a,c=[];return a={},d("next"),d("throw"),d("return"),a[Symbol.asyncIterator]=function(){return this},a;function d(P){s[P]&&(a[P]=function(T){return new Promise(function(R,H){c.push([P,T,R,H])>1||f(P,T)})})}function f(P,T){try{_(s[P](T))}catch(R){N(c[0][3],R)}}function _(P){P.value instanceof as?Promise.resolve(P.value.v).then(g,D):N(c[0][2],P)}function g(P){f("next",P)}function D(P){f("throw",P)}function N(P,T){P(T),c.shift(),c.length&&f(c[0][0],c[0][1])}}function Qm(i){var t,e;return t={},s("next"),s("throw",function(a){throw a}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(a,c){t[a]=i[a]?function(d){return(e=!e)?{value:as(i[a](d)),done:a==="return"}:c?c(d):d}:c}}function ew(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],e;return t?t.call(i):(i=typeof Kc=="function"?Kc(i):i[Symbol.iterator](),e={},s("next"),s("throw"),s("return"),e[Symbol.asyncIterator]=function(){return this},e);function s(c){e[c]=i[c]&&function(d){return new Promise(function(f,_){d=i[c](d),a(f,_,d.done,d.value)})}}function a(c,d,f,_){Promise.resolve(_).then(function(g){c({value:g,done:f})},d)}}function tw(i,t){return Object.defineProperty?Object.defineProperty(i,"raw",{value:t}):i.raw=t,i}function rw(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var e in i)Object.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t.default=i,t}function iw(i){return i&&i.__esModule?i:{default:i}}function nw(i,t){if(!t.has(i))throw new TypeError("attempted to get private field on non-instance");return t.get(i)}function sw(i,t,e){if(!t.has(i))throw new TypeError("attempted to set private field on non-instance");return t.set(i,e),e}var aw=Object.freeze({__proto__:null,get __assign(){return Bc},__asyncDelegator:Qm,__asyncGenerator:Zm,__asyncValues:ew,__await:as,__awaiter:km,__classPrivateFieldGet:nw,__classPrivateFieldSet:sw,__createBinding:Wm,__decorate:Bm,__exportStar:Ym,__extends:zm,__generator:Gm,__importDefault:iw,__importStar:rw,__makeTemplateObject:tw,__metadata:Vm,__param:Km,__read:md,__rest:Hm,__spread:Jm,__spreadArrays:Xm,__values:Kc}),Ma=In(aw),_c={},Wn={},jl;function ow(){if(jl)return Wn;jl=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.delay=void 0;function i(t){return new Promise(e=>{setTimeout(()=>{e(!0)},t)})}return Wn.delay=i,Wn}var Bi={},yc={},Ki={},Ll;function cw(){return Ll||(Ll=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.ONE_THOUSAND=Ki.ONE_HUNDRED=void 0,Ki.ONE_HUNDRED=100,Ki.ONE_THOUSAND=1e3),Ki}var vc={},Ml;function uw(){return Ml||(Ml=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ONE_YEAR=i.FOUR_WEEKS=i.THREE_WEEKS=i.TWO_WEEKS=i.ONE_WEEK=i.THIRTY_DAYS=i.SEVEN_DAYS=i.FIVE_DAYS=i.THREE_DAYS=i.ONE_DAY=i.TWENTY_FOUR_HOURS=i.TWELVE_HOURS=i.SIX_HOURS=i.THREE_HOURS=i.ONE_HOUR=i.SIXTY_MINUTES=i.THIRTY_MINUTES=i.TEN_MINUTES=i.FIVE_MINUTES=i.ONE_MINUTE=i.SIXTY_SECONDS=i.THIRTY_SECONDS=i.TEN_SECONDS=i.FIVE_SECONDS=i.ONE_SECOND=void 0,i.ONE_SECOND=1,i.FIVE_SECONDS=5,i.TEN_SECONDS=10,i.THIRTY_SECONDS=30,i.SIXTY_SECONDS=60,i.ONE_MINUTE=i.SIXTY_SECONDS,i.FIVE_MINUTES=i.ONE_MINUTE*5,i.TEN_MINUTES=i.ONE_MINUTE*10,i.THIRTY_MINUTES=i.ONE_MINUTE*30,i.SIXTY_MINUTES=i.ONE_MINUTE*60,i.ONE_HOUR=i.SIXTY_MINUTES,i.THREE_HOURS=i.ONE_HOUR*3,i.SIX_HOURS=i.ONE_HOUR*6,i.TWELVE_HOURS=i.ONE_HOUR*12,i.TWENTY_FOUR_HOURS=i.ONE_HOUR*24,i.ONE_DAY=i.TWENTY_FOUR_HOURS,i.THREE_DAYS=i.ONE_DAY*3,i.FIVE_DAYS=i.ONE_DAY*5,i.SEVEN_DAYS=i.ONE_DAY*7,i.THIRTY_DAYS=i.ONE_DAY*30,i.ONE_WEEK=i.SEVEN_DAYS,i.TWO_WEEKS=i.ONE_WEEK*2,i.THREE_WEEKS=i.ONE_WEEK*3,i.FOUR_WEEKS=i.ONE_WEEK*4,i.ONE_YEAR=i.ONE_DAY*365}(vc)),vc}var ql;function wd(){return ql||(ql=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const t=Ma;t.__exportStar(cw(),i),t.__exportStar(uw(),i)}(yc)),yc}var zl;function hw(){if(zl)return Bi;zl=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.fromMiliseconds=Bi.toMiliseconds=void 0;const i=wd();function t(s){return s*i.ONE_THOUSAND}Bi.toMiliseconds=t;function e(s){return Math.floor(s/i.ONE_THOUSAND)}return Bi.fromMiliseconds=e,Bi}var Hl;function lw(){return Hl||(Hl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const t=Ma;t.__exportStar(ow(),i),t.__exportStar(hw(),i)}(_c)),_c}var mn={},Bl;function fw(){if(Bl)return mn;Bl=1,Object.defineProperty(mn,"__esModule",{value:!0}),mn.Watch=void 0;class i{constructor(){this.timestamps=new Map}start(e){if(this.timestamps.has(e))throw new Error(`Watch already started for label: ${e}`);this.timestamps.set(e,{started:Date.now()})}stop(e){const s=this.get(e);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${e}`);const a=Date.now()-s.started;this.timestamps.set(e,{started:s.started,elapsed:a})}get(e){const s=this.timestamps.get(e);if(typeof s>"u")throw new Error(`No timestamp found for label: ${e}`);return s}elapsed(e){const s=this.get(e);return s.elapsed||Date.now()-s.started}}return mn.Watch=i,mn.default=i,mn}var bc={},Yn={},Kl;function dw(){if(Kl)return Yn;Kl=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.IWatch=void 0;class i{}return Yn.IWatch=i,Yn}var Vl;function pw(){return Vl||(Vl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Ma.__exportStar(dw(),i)}(bc)),bc}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const t=Ma;t.__exportStar(lw(),i),t.__exportStar(fw(),i),t.__exportStar(pw(),i),t.__exportStar(wd(),i)})(ve);var gw={};(function(i){const t=Qf,e=ed,s=Xf,a=Zf,c=E=>E==null,d=Symbol("encodeFragmentIdentifier");function f(E){switch(E.arrayFormat){case"index":return x=>(m,S)=>{const y=m.length;return S===void 0||E.skipNull&&S===null||E.skipEmptyString&&S===""?m:S===null?[...m,[D(x,E),"[",y,"]"].join("")]:[...m,[D(x,E),"[",D(y,E),"]=",D(S,E)].join("")]};case"bracket":return x=>(m,S)=>S===void 0||E.skipNull&&S===null||E.skipEmptyString&&S===""?m:S===null?[...m,[D(x,E),"[]"].join("")]:[...m,[D(x,E),"[]=",D(S,E)].join("")];case"colon-list-separator":return x=>(m,S)=>S===void 0||E.skipNull&&S===null||E.skipEmptyString&&S===""?m:S===null?[...m,[D(x,E),":list="].join("")]:[...m,[D(x,E),":list=",D(S,E)].join("")];case"comma":case"separator":case"bracket-separator":{const x=E.arrayFormat==="bracket-separator"?"[]=":"=";return m=>(S,y)=>y===void 0||E.skipNull&&y===null||E.skipEmptyString&&y===""?S:(y=y===null?"":y,S.length===0?[[D(m,E),x,D(y,E)].join("")]:[[S,D(y,E)].join(E.arrayFormatSeparator)])}default:return x=>(m,S)=>S===void 0||E.skipNull&&S===null||E.skipEmptyString&&S===""?m:S===null?[...m,D(x,E)]:[...m,[D(x,E),"=",D(S,E)].join("")]}}function _(E){let x;switch(E.arrayFormat){case"index":return(m,S,y)=>{if(x=/\[(\d*)\]$/.exec(m),m=m.replace(/\[\d*\]$/,""),!x){y[m]=S;return}y[m]===void 0&&(y[m]={}),y[m][x[1]]=S};case"bracket":return(m,S,y)=>{if(x=/(\[\])$/.exec(m),m=m.replace(/\[\]$/,""),!x){y[m]=S;return}if(y[m]===void 0){y[m]=[S];return}y[m]=[].concat(y[m],S)};case"colon-list-separator":return(m,S,y)=>{if(x=/(:list)$/.exec(m),m=m.replace(/:list$/,""),!x){y[m]=S;return}if(y[m]===void 0){y[m]=[S];return}y[m]=[].concat(y[m],S)};case"comma":case"separator":return(m,S,y)=>{const u=typeof S=="string"&&S.includes(E.arrayFormatSeparator),v=typeof S=="string"&&!u&&N(S,E).includes(E.arrayFormatSeparator);S=v?N(S,E):S;const K=u||v?S.split(E.arrayFormatSeparator).map(V=>N(V,E)):S===null?S:N(S,E);y[m]=K};case"bracket-separator":return(m,S,y)=>{const u=/(\[\])$/.test(m);if(m=m.replace(/\[\]$/,""),!u){y[m]=S&&N(S,E);return}const v=S===null?[]:S.split(E.arrayFormatSeparator).map(K=>N(K,E));if(y[m]===void 0){y[m]=v;return}y[m]=[].concat(y[m],v)};default:return(m,S,y)=>{if(y[m]===void 0){y[m]=S;return}y[m]=[].concat(y[m],S)}}}function g(E){if(typeof E!="string"||E.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function D(E,x){return x.encode?x.strict?t(E):encodeURIComponent(E):E}function N(E,x){return x.decode?e(E):E}function P(E){return Array.isArray(E)?E.sort():typeof E=="object"?P(Object.keys(E)).sort((x,m)=>Number(x)-Number(m)).map(x=>E[x]):E}function T(E){const x=E.indexOf("#");return x!==-1&&(E=E.slice(0,x)),E}function R(E){let x="";const m=E.indexOf("#");return m!==-1&&(x=E.slice(m)),x}function H(E){E=T(E);const x=E.indexOf("?");return x===-1?"":E.slice(x+1)}function G(E,x){return x.parseNumbers&&!Number.isNaN(Number(E))&&typeof E=="string"&&E.trim()!==""?E=Number(E):x.parseBooleans&&E!==null&&(E.toLowerCase()==="true"||E.toLowerCase()==="false")&&(E=E.toLowerCase()==="true"),E}function ie(E,x){x=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},x),g(x.arrayFormatSeparator);const m=_(x),S=Object.create(null);if(typeof E!="string"||(E=E.trim().replace(/^[?#&]/,""),!E))return S;for(const y of E.split("&")){if(y==="")continue;let[u,v]=s(x.decode?y.replace(/\+/g," "):y,"=");v=v===void 0?null:["comma","separator","bracket-separator"].includes(x.arrayFormat)?v:N(v,x),m(N(u,x),v,S)}for(const y of Object.keys(S)){const u=S[y];if(typeof u=="object"&&u!==null)for(const v of Object.keys(u))u[v]=G(u[v],x);else S[y]=G(u,x)}return x.sort===!1?S:(x.sort===!0?Object.keys(S).sort():Object.keys(S).sort(x.sort)).reduce((y,u)=>{const v=S[u];return Boolean(v)&&typeof v=="object"&&!Array.isArray(v)?y[u]=P(v):y[u]=v,y},Object.create(null))}i.extract=H,i.parse=ie,i.stringify=(E,x)=>{if(!E)return"";x=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},x),g(x.arrayFormatSeparator);const m=v=>x.skipNull&&c(E[v])||x.skipEmptyString&&E[v]==="",S=f(x),y={};for(const v of Object.keys(E))m(v)||(y[v]=E[v]);const u=Object.keys(y);return x.sort!==!1&&u.sort(x.sort),u.map(v=>{const K=E[v];return K===void 0?"":K===null?D(v,x):Array.isArray(K)?K.length===0&&x.arrayFormat==="bracket-separator"?D(v,x)+"[]":K.reduce(S(v),[]).join("&"):D(v,x)+"="+D(K,x)}).filter(v=>v.length>0).join("&")},i.parseUrl=(E,x)=>{x=Object.assign({decode:!0},x);const[m,S]=s(E,"#");return Object.assign({url:m.split("?")[0]||"",query:ie(H(E),x)},x&&x.parseFragmentIdentifier&&S?{fragmentIdentifier:N(S,x)}:{})},i.stringifyUrl=(E,x)=>{x=Object.assign({encode:!0,strict:!0,[d]:!0},x);const m=T(E.url).split("?")[0]||"",S=i.extract(E.url),y=i.parse(S,{sort:!1}),u=Object.assign(y,E.query);let v=i.stringify(u,x);v&&(v=`?${v}`);let K=R(E.url);return E.fragmentIdentifier&&(K=`#${x[d]?D(E.fragmentIdentifier,x):E.fragmentIdentifier}`),`${m}${v}${K}`},i.pick=(E,x,m)=>{m=Object.assign({parseFragmentIdentifier:!0,[d]:!1},m);const{url:S,query:y,fragmentIdentifier:u}=i.parseUrl(E,m);return i.stringifyUrl({url:S,query:a(y,x),fragmentIdentifier:u},m)},i.exclude=(E,x,m)=>{const S=Array.isArray(x)?y=>!x.includes(y):(y,u)=>!x(y,u);return i.pick(E,S,m)}})(gw);const _w={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function yw(i,t=[]){const e=[];return Object.keys(i).forEach(s=>{if(t.length&&!t.includes(s))return;const a=i[s];e.push(...a.accounts)}),e}const vw={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function bw(i,t){const{message:e,code:s}=vw[i];return{message:t?`${e} ${t}`:e,code:s}}function Vc(i,t){return Array.isArray(i)?typeof t<"u"&&i.length?i.every(t):!0:!1}var qa={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var kc=function(i,t){return kc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var a in s)s.hasOwnProperty(a)&&(e[a]=s[a])},kc(i,t)};function mw(i,t){kc(i,t);function e(){this.constructor=i}i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Gc=function(){return Gc=Object.assign||function(t){for(var e,s=1,a=arguments.length;s<a;s++){e=arguments[s];for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&(t[c]=e[c])}return t},Gc.apply(this,arguments)};function ww(i,t){var e={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&t.indexOf(s)<0&&(e[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(i);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(i,s[a])&&(e[s[a]]=i[s[a]]);return e}function Ew(i,t,e,s){var a=arguments.length,c=a<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,e):s,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,t,e,s);else for(var f=i.length-1;f>=0;f--)(d=i[f])&&(c=(a<3?d(c):a>3?d(t,e,c):d(t,e))||c);return a>3&&c&&Object.defineProperty(t,e,c),c}function Dw(i,t){return function(e,s){t(e,s,i)}}function Sw(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)}function Iw(i,t,e,s){function a(c){return c instanceof e?c:new e(function(d){d(c)})}return new(e||(e=Promise))(function(c,d){function f(D){try{g(s.next(D))}catch(N){d(N)}}function _(D){try{g(s.throw(D))}catch(N){d(N)}}function g(D){D.done?c(D.value):a(D.value).then(f,_)}g((s=s.apply(i,t||[])).next())})}function xw(i,t){var e={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,a,c,d;return d={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function f(g){return function(D){return _([g,D])}}function _(g){if(s)throw new TypeError("Generator is already executing.");for(;e;)try{if(s=1,a&&(c=g[0]&2?a.return:g[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,g[1])).done)return c;switch(a=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return e.label++,{value:g[1],done:!1};case 5:e.label++,a=g[1],g=[0];continue;case 7:g=e.ops.pop(),e.trys.pop();continue;default:if(c=e.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){e=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){e.label=g[1];break}if(g[0]===6&&e.label<c[1]){e.label=c[1],c=g;break}if(c&&e.label<c[2]){e.label=c[2],e.ops.push(g);break}c[2]&&e.ops.pop(),e.trys.pop();continue}g=t.call(i,e)}catch(D){g=[6,D],a=0}finally{s=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function Ow(i,t,e,s){s===void 0&&(s=e),i[s]=t[e]}function Pw(i,t){for(var e in i)e!=="default"&&!t.hasOwnProperty(e)&&(t[e]=i[e])}function Wc(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],s=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ed(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var s=e.call(i),a,c=[],d;try{for(;(t===void 0||t-- >0)&&!(a=s.next()).done;)c.push(a.value)}catch(f){d={error:f}}finally{try{a&&!a.done&&(e=s.return)&&e.call(s)}finally{if(d)throw d.error}}return c}function Cw(){for(var i=[],t=0;t<arguments.length;t++)i=i.concat(Ed(arguments[t]));return i}function Aw(){for(var i=0,t=0,e=arguments.length;t<e;t++)i+=arguments[t].length;for(var s=Array(i),a=0,t=0;t<e;t++)for(var c=arguments[t],d=0,f=c.length;d<f;d++,a++)s[a]=c[d];return s}function os(i){return this instanceof os?(this.v=i,this):new os(i)}function Nw(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=e.apply(i,t||[]),a,c=[];return a={},d("next"),d("throw"),d("return"),a[Symbol.asyncIterator]=function(){return this},a;function d(P){s[P]&&(a[P]=function(T){return new Promise(function(R,H){c.push([P,T,R,H])>1||f(P,T)})})}function f(P,T){try{_(s[P](T))}catch(R){N(c[0][3],R)}}function _(P){P.value instanceof os?Promise.resolve(P.value.v).then(g,D):N(c[0][2],P)}function g(P){f("next",P)}function D(P){f("throw",P)}function N(P,T){P(T),c.shift(),c.length&&f(c[0][0],c[0][1])}}function Tw(i){var t,e;return t={},s("next"),s("throw",function(a){throw a}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(a,c){t[a]=i[a]?function(d){return(e=!e)?{value:os(i[a](d)),done:a==="return"}:c?c(d):d}:c}}function Rw(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],e;return t?t.call(i):(i=typeof Wc=="function"?Wc(i):i[Symbol.iterator](),e={},s("next"),s("throw"),s("return"),e[Symbol.asyncIterator]=function(){return this},e);function s(c){e[c]=i[c]&&function(d){return new Promise(function(f,_){d=i[c](d),a(f,_,d.done,d.value)})}}function a(c,d,f,_){Promise.resolve(_).then(function(g){c({value:g,done:f})},d)}}function $w(i,t){return Object.defineProperty?Object.defineProperty(i,"raw",{value:t}):i.raw=t,i}function Uw(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var e in i)Object.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t.default=i,t}function Fw(i){return i&&i.__esModule?i:{default:i}}function jw(i,t){if(!t.has(i))throw new TypeError("attempted to get private field on non-instance");return t.get(i)}function Lw(i,t,e){if(!t.has(i))throw new TypeError("attempted to set private field on non-instance");return t.set(i,e),e}var Mw=Object.freeze({__proto__:null,get __assign(){return Gc},__asyncDelegator:Tw,__asyncGenerator:Nw,__asyncValues:Rw,__await:os,__awaiter:Iw,__classPrivateFieldGet:jw,__classPrivateFieldSet:Lw,__createBinding:Ow,__decorate:Ew,__exportStar:Pw,__extends:mw,__generator:xw,__importDefault:Fw,__importStar:Uw,__makeTemplateObject:$w,__metadata:Sw,__param:Dw,__read:Ed,__rest:ww,__spread:Cw,__spreadArrays:Aw,__values:Wc}),Dd=In(Mw),ds={};Object.defineProperty(ds,"__esModule",{value:!0});function qw(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return JSON.parse(i)}catch{return i}}ds.safeJsonParse=qw;function zw(i){return typeof i=="string"?i:JSON.stringify(i,(t,e)=>typeof e>"u"?null:e)}ds.safeJsonStringify=zw;var Jn={exports:{}},kl;function Hw(){return kl||(kl=1,function(){let i;function t(){}i=t,i.prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},i.prototype.setItem=function(e,s){this[e]=String(s)},i.prototype.removeItem=function(e){delete this[e]},i.prototype.clear=function(){const e=this;Object.keys(e).forEach(function(s){e[s]=void 0,delete e[s]})},i.prototype.key=function(e){return e=e||0,Object.keys(this)[e]},i.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Gi<"u"&&Gi.localStorage?Jn.exports=Gi.localStorage:typeof window<"u"&&window.localStorage?Jn.exports=window.localStorage:Jn.exports=new t}()),Jn.exports}var mc={},Xn={},Gl;function Bw(){if(Gl)return Xn;Gl=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.IKeyValueStorage=void 0;class i{}return Xn.IKeyValueStorage=i,Xn}var Zn={},Wl;function Kw(){if(Wl)return Zn;Wl=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.parseEntry=void 0;const i=ds;function t(e){var s;return[e[0],i.safeJsonParse((s=e[1])!==null&&s!==void 0?s:"")]}return Zn.parseEntry=t,Zn}var Yl;function Vw(){return Yl||(Yl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const t=Dd;t.__exportStar(Bw(),i),t.__exportStar(Kw(),i)}(mc)),mc}Object.defineProperty(qa,"__esModule",{value:!0});qa.KeyValueStorage=void 0;const wn=Dd,Jl=ds,kw=wn.__importDefault(Hw()),Gw=Vw();class Sd{constructor(){this.localStorage=kw.default}getKeys(){return wn.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return wn.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Gw.parseEntry)})}getItem(t){return wn.__awaiter(this,void 0,void 0,function*(){const e=this.localStorage.getItem(t);if(e!==null)return Jl.safeJsonParse(e)})}setItem(t,e){return wn.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,Jl.safeJsonStringify(e))})}removeItem(t){return wn.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}qa.KeyValueStorage=Sd;var Ww=qa.default=Sd,ps={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Yc=function(i,t){return Yc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var a in s)s.hasOwnProperty(a)&&(e[a]=s[a])},Yc(i,t)};function Yw(i,t){Yc(i,t);function e(){this.constructor=i}i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Jc=function(){return Jc=Object.assign||function(t){for(var e,s=1,a=arguments.length;s<a;s++){e=arguments[s];for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&(t[c]=e[c])}return t},Jc.apply(this,arguments)};function Jw(i,t){var e={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&t.indexOf(s)<0&&(e[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(i);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(i,s[a])&&(e[s[a]]=i[s[a]]);return e}function Xw(i,t,e,s){var a=arguments.length,c=a<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,e):s,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,t,e,s);else for(var f=i.length-1;f>=0;f--)(d=i[f])&&(c=(a<3?d(c):a>3?d(t,e,c):d(t,e))||c);return a>3&&c&&Object.defineProperty(t,e,c),c}function Zw(i,t){return function(e,s){t(e,s,i)}}function Qw(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)}function eE(i,t,e,s){function a(c){return c instanceof e?c:new e(function(d){d(c)})}return new(e||(e=Promise))(function(c,d){function f(D){try{g(s.next(D))}catch(N){d(N)}}function _(D){try{g(s.throw(D))}catch(N){d(N)}}function g(D){D.done?c(D.value):a(D.value).then(f,_)}g((s=s.apply(i,t||[])).next())})}function tE(i,t){var e={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,a,c,d;return d={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function f(g){return function(D){return _([g,D])}}function _(g){if(s)throw new TypeError("Generator is already executing.");for(;e;)try{if(s=1,a&&(c=g[0]&2?a.return:g[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,g[1])).done)return c;switch(a=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return e.label++,{value:g[1],done:!1};case 5:e.label++,a=g[1],g=[0];continue;case 7:g=e.ops.pop(),e.trys.pop();continue;default:if(c=e.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){e=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){e.label=g[1];break}if(g[0]===6&&e.label<c[1]){e.label=c[1],c=g;break}if(c&&e.label<c[2]){e.label=c[2],e.ops.push(g);break}c[2]&&e.ops.pop(),e.trys.pop();continue}g=t.call(i,e)}catch(D){g=[6,D],a=0}finally{s=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function rE(i,t,e,s){s===void 0&&(s=e),i[s]=t[e]}function iE(i,t){for(var e in i)e!=="default"&&!t.hasOwnProperty(e)&&(t[e]=i[e])}function Xc(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],s=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Id(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var s=e.call(i),a,c=[],d;try{for(;(t===void 0||t-- >0)&&!(a=s.next()).done;)c.push(a.value)}catch(f){d={error:f}}finally{try{a&&!a.done&&(e=s.return)&&e.call(s)}finally{if(d)throw d.error}}return c}function nE(){for(var i=[],t=0;t<arguments.length;t++)i=i.concat(Id(arguments[t]));return i}function sE(){for(var i=0,t=0,e=arguments.length;t<e;t++)i+=arguments[t].length;for(var s=Array(i),a=0,t=0;t<e;t++)for(var c=arguments[t],d=0,f=c.length;d<f;d++,a++)s[a]=c[d];return s}function cs(i){return this instanceof cs?(this.v=i,this):new cs(i)}function aE(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=e.apply(i,t||[]),a,c=[];return a={},d("next"),d("throw"),d("return"),a[Symbol.asyncIterator]=function(){return this},a;function d(P){s[P]&&(a[P]=function(T){return new Promise(function(R,H){c.push([P,T,R,H])>1||f(P,T)})})}function f(P,T){try{_(s[P](T))}catch(R){N(c[0][3],R)}}function _(P){P.value instanceof cs?Promise.resolve(P.value.v).then(g,D):N(c[0][2],P)}function g(P){f("next",P)}function D(P){f("throw",P)}function N(P,T){P(T),c.shift(),c.length&&f(c[0][0],c[0][1])}}function oE(i){var t,e;return t={},s("next"),s("throw",function(a){throw a}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(a,c){t[a]=i[a]?function(d){return(e=!e)?{value:cs(i[a](d)),done:a==="return"}:c?c(d):d}:c}}function cE(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],e;return t?t.call(i):(i=typeof Xc=="function"?Xc(i):i[Symbol.iterator](),e={},s("next"),s("throw"),s("return"),e[Symbol.asyncIterator]=function(){return this},e);function s(c){e[c]=i[c]&&function(d){return new Promise(function(f,_){d=i[c](d),a(f,_,d.done,d.value)})}}function a(c,d,f,_){Promise.resolve(_).then(function(g){c({value:g,done:f})},d)}}function uE(i,t){return Object.defineProperty?Object.defineProperty(i,"raw",{value:t}):i.raw=t,i}function hE(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var e in i)Object.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t.default=i,t}function lE(i){return i&&i.__esModule?i:{default:i}}function fE(i,t){if(!t.has(i))throw new TypeError("attempted to get private field on non-instance");return t.get(i)}function dE(i,t,e){if(!t.has(i))throw new TypeError("attempted to set private field on non-instance");return t.set(i,e),e}var pE=Object.freeze({__proto__:null,get __assign(){return Jc},__asyncDelegator:oE,__asyncGenerator:aE,__asyncValues:cE,__await:cs,__awaiter:eE,__classPrivateFieldGet:fE,__classPrivateFieldSet:dE,__createBinding:rE,__decorate:Xw,__exportStar:iE,__extends:Yw,__generator:tE,__importDefault:lE,__importStar:hE,__makeTemplateObject:uE,__metadata:Qw,__param:Zw,__read:Id,__rest:Jw,__spread:nE,__spreadArrays:sE,__values:Xc}),za=In(pE),Qn={},wc={},es={};class Xi{}var gE=Object.freeze({__proto__:null,IEvents:Xi}),_E=In(gE),Xl;function yE(){if(Xl)return es;Xl=1,Object.defineProperty(es,"__esModule",{value:!0}),es.IHeartBeat=void 0;const i=_E;class t extends i.IEvents{constructor(s){super()}}return es.IHeartBeat=t,es}var Zl;function xd(){return Zl||(Zl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),za.__exportStar(yE(),i)}(wc)),wc}var Ec={},Vi={},Ql;function vE(){if(Ql)return Vi;Ql=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.HEARTBEAT_EVENTS=Vi.HEARTBEAT_INTERVAL=void 0;const i=ve;return Vi.HEARTBEAT_INTERVAL=i.FIVE_SECONDS,Vi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Vi}var ef;function Od(){return ef||(ef=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),za.__exportStar(vE(),i)}(Ec)),Ec}var tf;function bE(){if(tf)return Qn;tf=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.HeartBeat=void 0;const i=za,t=eb,e=ve,s=xd(),a=Od();class c extends s.IHeartBeat{constructor(f){super(f),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=f?.interval||a.HEARTBEAT_INTERVAL}static init(f){return i.__awaiter(this,void 0,void 0,function*(){const _=new c(f);return yield _.init(),_})}init(){return i.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,_){this.events.on(f,_)}once(f,_){this.events.once(f,_)}off(f,_){this.events.off(f,_)}removeListener(f,_){this.events.removeListener(f,_)}initialize(){return i.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),e.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return Qn.HeartBeat=c,Qn}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const t=za;t.__exportStar(bE(),i),t.__exportStar(xd(),i),t.__exportStar(Od(),i)})(ps);var Qe={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Zc=function(i,t){return Zc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var a in s)s.hasOwnProperty(a)&&(e[a]=s[a])},Zc(i,t)};function mE(i,t){Zc(i,t);function e(){this.constructor=i}i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Qc=function(){return Qc=Object.assign||function(t){for(var e,s=1,a=arguments.length;s<a;s++){e=arguments[s];for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&(t[c]=e[c])}return t},Qc.apply(this,arguments)};function wE(i,t){var e={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&t.indexOf(s)<0&&(e[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(i);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(i,s[a])&&(e[s[a]]=i[s[a]]);return e}function EE(i,t,e,s){var a=arguments.length,c=a<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,e):s,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,t,e,s);else for(var f=i.length-1;f>=0;f--)(d=i[f])&&(c=(a<3?d(c):a>3?d(t,e,c):d(t,e))||c);return a>3&&c&&Object.defineProperty(t,e,c),c}function DE(i,t){return function(e,s){t(e,s,i)}}function SE(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)}function IE(i,t,e,s){function a(c){return c instanceof e?c:new e(function(d){d(c)})}return new(e||(e=Promise))(function(c,d){function f(D){try{g(s.next(D))}catch(N){d(N)}}function _(D){try{g(s.throw(D))}catch(N){d(N)}}function g(D){D.done?c(D.value):a(D.value).then(f,_)}g((s=s.apply(i,t||[])).next())})}function xE(i,t){var e={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,a,c,d;return d={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function f(g){return function(D){return _([g,D])}}function _(g){if(s)throw new TypeError("Generator is already executing.");for(;e;)try{if(s=1,a&&(c=g[0]&2?a.return:g[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,g[1])).done)return c;switch(a=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return e.label++,{value:g[1],done:!1};case 5:e.label++,a=g[1],g=[0];continue;case 7:g=e.ops.pop(),e.trys.pop();continue;default:if(c=e.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){e=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){e.label=g[1];break}if(g[0]===6&&e.label<c[1]){e.label=c[1],c=g;break}if(c&&e.label<c[2]){e.label=c[2],e.ops.push(g);break}c[2]&&e.ops.pop(),e.trys.pop();continue}g=t.call(i,e)}catch(D){g=[6,D],a=0}finally{s=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function OE(i,t,e,s){s===void 0&&(s=e),i[s]=t[e]}function PE(i,t){for(var e in i)e!=="default"&&!t.hasOwnProperty(e)&&(t[e]=i[e])}function eu(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],s=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pd(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var s=e.call(i),a,c=[],d;try{for(;(t===void 0||t-- >0)&&!(a=s.next()).done;)c.push(a.value)}catch(f){d={error:f}}finally{try{a&&!a.done&&(e=s.return)&&e.call(s)}finally{if(d)throw d.error}}return c}function CE(){for(var i=[],t=0;t<arguments.length;t++)i=i.concat(Pd(arguments[t]));return i}function AE(){for(var i=0,t=0,e=arguments.length;t<e;t++)i+=arguments[t].length;for(var s=Array(i),a=0,t=0;t<e;t++)for(var c=arguments[t],d=0,f=c.length;d<f;d++,a++)s[a]=c[d];return s}function us(i){return this instanceof us?(this.v=i,this):new us(i)}function NE(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=e.apply(i,t||[]),a,c=[];return a={},d("next"),d("throw"),d("return"),a[Symbol.asyncIterator]=function(){return this},a;function d(P){s[P]&&(a[P]=function(T){return new Promise(function(R,H){c.push([P,T,R,H])>1||f(P,T)})})}function f(P,T){try{_(s[P](T))}catch(R){N(c[0][3],R)}}function _(P){P.value instanceof us?Promise.resolve(P.value.v).then(g,D):N(c[0][2],P)}function g(P){f("next",P)}function D(P){f("throw",P)}function N(P,T){P(T),c.shift(),c.length&&f(c[0][0],c[0][1])}}function TE(i){var t,e;return t={},s("next"),s("throw",function(a){throw a}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(a,c){t[a]=i[a]?function(d){return(e=!e)?{value:us(i[a](d)),done:a==="return"}:c?c(d):d}:c}}function RE(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],e;return t?t.call(i):(i=typeof eu=="function"?eu(i):i[Symbol.iterator](),e={},s("next"),s("throw"),s("return"),e[Symbol.asyncIterator]=function(){return this},e);function s(c){e[c]=i[c]&&function(d){return new Promise(function(f,_){d=i[c](d),a(f,_,d.done,d.value)})}}function a(c,d,f,_){Promise.resolve(_).then(function(g){c({value:g,done:f})},d)}}function $E(i,t){return Object.defineProperty?Object.defineProperty(i,"raw",{value:t}):i.raw=t,i}function UE(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var e in i)Object.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t.default=i,t}function FE(i){return i&&i.__esModule?i:{default:i}}function jE(i,t){if(!t.has(i))throw new TypeError("attempted to get private field on non-instance");return t.get(i)}function LE(i,t,e){if(!t.has(i))throw new TypeError("attempted to set private field on non-instance");return t.set(i,e),e}var ME=Object.freeze({__proto__:null,get __assign(){return Qc},__asyncDelegator:TE,__asyncGenerator:NE,__asyncValues:RE,__await:us,__awaiter:IE,__classPrivateFieldGet:jE,__classPrivateFieldSet:LE,__createBinding:OE,__decorate:EE,__exportStar:PE,__extends:mE,__generator:xE,__importDefault:FE,__importStar:UE,__makeTemplateObject:$E,__metadata:SE,__param:DE,__read:Pd,__rest:wE,__spread:CE,__spreadArrays:AE,__values:eu}),qE=In(ME),Dc,rf;function zE(){if(rf)return Dc;rf=1;function i(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}Dc=t;function t(e,s,a){var c=a&&a.stringify||i,d=1;if(typeof e=="object"&&e!==null){var f=s.length+d;if(f===1)return e;var _=new Array(f);_[0]=c(e);for(var g=1;g<f;g++)_[g]=c(s[g]);return _.join(" ")}if(typeof e!="string")return e;var D=s.length;if(D===0)return e;for(var N="",P=1-d,T=-1,R=e&&e.length||0,H=0;H<R;){if(e.charCodeAt(H)===37&&H+1<R){switch(T=T>-1?T:0,e.charCodeAt(H+1)){case 100:case 102:if(P>=D||s[P]==null)break;T<H&&(N+=e.slice(T,H)),N+=Number(s[P]),T=H+2,H++;break;case 105:if(P>=D||s[P]==null)break;T<H&&(N+=e.slice(T,H)),N+=Math.floor(Number(s[P])),T=H+2,H++;break;case 79:case 111:case 106:if(P>=D||s[P]===void 0)break;T<H&&(N+=e.slice(T,H));var G=typeof s[P];if(G==="string"){N+="'"+s[P]+"'",T=H+2,H++;break}if(G==="function"){N+=s[P].name||"<anonymous>",T=H+2,H++;break}N+=c(s[P]),T=H+2,H++;break;case 115:if(P>=D)break;T<H&&(N+=e.slice(T,H)),N+=String(s[P]),T=H+2,H++;break;case 37:T<H&&(N+=e.slice(T,H)),N+="%",T=H+2,H++,P--;break}++P}++H}return T===-1?e:(T<R&&(N+=e.slice(T)),N)}return Dc}var Sc,nf;function HE(){if(nf)return Sc;nf=1;const i=zE();Sc=a;const t=S().console||{},e={mapHttpRequest:R,mapHttpResponse:R,wrapRequestSerializer:H,wrapResponseSerializer:H,wrapErrorSerializer:H,req:R,res:R,err:P};function s(y,u){return Array.isArray(y)?y.filter(function(K){return K!=="!stdSerializers.err"}):y===!0?Object.keys(u):!1}function a(y){y=y||{},y.browser=y.browser||{};const u=y.browser.transmit;if(u&&typeof u.send!="function")throw Error("pino: transmit option must have a send function");const v=y.browser.write||t;y.browser.write&&(y.browser.asObject=!0);const K=y.serializers||{},V=s(y.browser.serialize,K);let ae=y.browser.serialize;Array.isArray(y.browser.serialize)&&y.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ae=!1);const ce=["error","fatal","warn","info","debug","trace"];typeof v=="function"&&(v.error=v.fatal=v.warn=v.info=v.debug=v.trace=v),y.enabled===!1&&(y.level="silent");const ge=y.level||"info",U=Object.create(v);U.log||(U.log=G),Object.defineProperty(U,"levelVal",{get:le}),Object.defineProperty(U,"level",{get:te,set:W});const z={transmit:u,serialize:V,asObject:y.browser.asObject,levels:ce,timestamp:T(y)};U.levels=a.levels,U.level=ge,U.setMaxListeners=U.getMaxListeners=U.emit=U.addListener=U.on=U.prependListener=U.once=U.prependOnceListener=U.removeListener=U.removeAllListeners=U.listeners=U.listenerCount=U.eventNames=U.write=U.flush=G,U.serializers=K,U._serialize=V,U._stdErrSerialize=ae,U.child=ee,u&&(U._logEvent=N());function le(){return this.level==="silent"?1/0:this.levels.values[this.level]}function te(){return this._level}function W(Y){if(Y!=="silent"&&!this.levels.values[Y])throw Error("unknown level "+Y);this._level=Y,c(z,U,"error","log"),c(z,U,"fatal","error"),c(z,U,"warn","error"),c(z,U,"info","log"),c(z,U,"debug","log"),c(z,U,"trace","log")}function ee(Y,re){if(!Y)throw new Error("missing bindings for child Pino");re=re||{},V&&Y.serializers&&(re.serializers=Y.serializers);const xe=re.serializers;if(V&&xe){var ne=Object.assign({},K,xe),me=y.browser.serialize===!0?Object.keys(ne):V;delete Y.serializers,_([Y],me,ne,this._stdErrSerialize)}function he(ye){this._childLevel=(ye._childLevel|0)+1,this.error=g(ye,Y,"error"),this.fatal=g(ye,Y,"fatal"),this.warn=g(ye,Y,"warn"),this.info=g(ye,Y,"info"),this.debug=g(ye,Y,"debug"),this.trace=g(ye,Y,"trace"),ne&&(this.serializers=ne,this._serialize=me),u&&(this._logEvent=N([].concat(ye._logEvent.bindings,Y)))}return he.prototype=this,new he(this)}return U}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=e,a.stdTimeFunctions=Object.assign({},{nullTime:ie,epochTime:E,unixTime:x,isoTime:m});function c(y,u,v,K){const V=Object.getPrototypeOf(u);u[v]=u.levelVal>u.levels.values[v]?G:V[v]?V[v]:t[v]||t[K]||G,d(y,u,v)}function d(y,u,v){!y.transmit&&u[v]===G||(u[v]=function(K){return function(){const ae=y.timestamp(),ce=new Array(arguments.length),ge=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var U=0;U<ce.length;U++)ce[U]=arguments[U];if(y.serialize&&!y.asObject&&_(ce,this._serialize,this.serializers,this._stdErrSerialize),y.asObject?K.call(ge,f(this,v,ce,ae)):K.apply(ge,ce),y.transmit){const z=y.transmit.level||u.level,le=a.levels.values[z],te=a.levels.values[v];if(te<le)return;D(this,{ts:ae,methodLevel:v,methodValue:te,transmitLevel:z,transmitValue:a.levels.values[y.transmit.level||u.level],send:y.transmit.send,val:u.levelVal},ce)}}}(u[v]))}function f(y,u,v,K){y._serialize&&_(v,y._serialize,y.serializers,y._stdErrSerialize);const V=v.slice();let ae=V[0];const ce={};K&&(ce.time=K),ce.level=a.levels.values[u];let ge=(y._childLevel|0)+1;if(ge<1&&(ge=1),ae!==null&&typeof ae=="object"){for(;ge--&&typeof V[0]=="object";)Object.assign(ce,V.shift());ae=V.length?i(V.shift(),V):void 0}else typeof ae=="string"&&(ae=i(V.shift(),V));return ae!==void 0&&(ce.msg=ae),ce}function _(y,u,v,K){for(const V in y)if(K&&y[V]instanceof Error)y[V]=a.stdSerializers.err(y[V]);else if(typeof y[V]=="object"&&!Array.isArray(y[V]))for(const ae in y[V])u&&u.indexOf(ae)>-1&&ae in v&&(y[V][ae]=v[ae](y[V][ae]))}function g(y,u,v){return function(){const K=new Array(1+arguments.length);K[0]=u;for(var V=1;V<K.length;V++)K[V]=arguments[V-1];return y[v].apply(this,K)}}function D(y,u,v){const K=u.send,V=u.ts,ae=u.methodLevel,ce=u.methodValue,ge=u.val,U=y._logEvent.bindings;_(v,y._serialize||Object.keys(y.serializers),y.serializers,y._stdErrSerialize===void 0?!0:y._stdErrSerialize),y._logEvent.ts=V,y._logEvent.messages=v.filter(function(z){return U.indexOf(z)===-1}),y._logEvent.level.label=ae,y._logEvent.level.value=ce,K(ae,y._logEvent,ge),y._logEvent=N(U)}function N(y){return{ts:0,messages:[],bindings:y||[],level:{label:"",value:0}}}function P(y){const u={type:y.constructor.name,msg:y.message,stack:y.stack};for(const v in y)u[v]===void 0&&(u[v]=y[v]);return u}function T(y){return typeof y.timestamp=="function"?y.timestamp:y.timestamp===!1?ie:E}function R(){return{}}function H(y){return y}function G(){}function ie(){return!1}function E(){return Date.now()}function x(){return Math.round(Date.now()/1e3)}function m(){return new Date(Date.now()).toISOString()}function S(){function y(u){return typeof u<"u"&&u}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return y(self)||y(window)||y(this)||{}}}return Sc}var ki={},sf;function Cd(){return sf||(sf=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.PINO_CUSTOM_CONTEXT_KEY=ki.PINO_LOGGER_DEFAULTS=void 0,ki.PINO_LOGGER_DEFAULTS={level:"info"},ki.PINO_CUSTOM_CONTEXT_KEY="custom_context"),ki}var sr={},af;function BE(){if(af)return sr;af=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.generateChildLogger=sr.formatChildLoggerContext=sr.getLoggerContext=sr.setBrowserLoggerContext=sr.getBrowserLoggerContext=sr.getDefaultLoggerOptions=void 0;const i=Cd();function t(f){return Object.assign(Object.assign({},f),{level:f?.level||i.PINO_LOGGER_DEFAULTS.level})}sr.getDefaultLoggerOptions=t;function e(f,_=i.PINO_CUSTOM_CONTEXT_KEY){return f[_]||""}sr.getBrowserLoggerContext=e;function s(f,_,g=i.PINO_CUSTOM_CONTEXT_KEY){return f[g]=_,f}sr.setBrowserLoggerContext=s;function a(f,_=i.PINO_CUSTOM_CONTEXT_KEY){let g="";return typeof f.bindings>"u"?g=e(f,_):g=f.bindings().context||"",g}sr.getLoggerContext=a;function c(f,_,g=i.PINO_CUSTOM_CONTEXT_KEY){const D=a(f,g);return D.trim()?`${D}/${_}`:_}sr.formatChildLoggerContext=c;function d(f,_,g=i.PINO_CUSTOM_CONTEXT_KEY){const D=c(f,_,g),N=f.child({context:D});return s(N,D,g)}return sr.generateChildLogger=d,sr}(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.pino=void 0;const t=qE,e=t.__importDefault(HE());Object.defineProperty(i,"pino",{enumerable:!0,get:function(){return e.default}}),t.__exportStar(Cd(),i),t.__exportStar(BE(),i)})(Qe);class KE extends Xi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class VE extends Xi{constructor(t,e){super(),this.core=t,this.logger=e,this.records=new Map}}class kE{constructor(t,e){this.logger=t,this.core=e}}let GE=class extends Xi{constructor(t,e){super(),this.relayer=t,this.logger=e}},WE=class extends Xi{constructor(t){super()}},YE=class{constructor(t,e,s,a){this.core=t,this.logger=e,this.name=s}};class JE extends Xi{constructor(t,e){super(),this.relayer=t,this.logger=e}}class XE extends Xi{constructor(t,e){super(),this.core=t,this.logger=e}}let ZE=class{constructor(t,e){this.projectId=t,this.logger=e}},QE=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},e3=class{constructor(t){this.client=t}};var Eu={},Ad={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var t=Fe,e=Dr;i.DIGEST_LENGTH=64,i.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){e.wipe(this._buffer),e.wipe(this._tempHi),e.wipe(this._tempLo),this.reset()},f.prototype.update=function(_,g){if(g===void 0&&(g=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var D=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<i.BLOCK_SIZE&&g>0;)this._buffer[this._bufferLength++]=_[D++],g--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(D=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,D,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=_[D++],g--;return this},f.prototype.finish=function(_){if(!this._finished){var g=this._bytesHashed,D=this._bufferLength,N=g/536870912|0,P=g<<3,T=g%128<112?128:256;this._buffer[D]=128;for(var R=D+1;R<T-8;R++)this._buffer[R]=0;t.writeUint32BE(N,this._buffer,T-8),t.writeUint32BE(P,this._buffer,T-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,T),this._finished=!0}for(var R=0;R<this.digestLength/8;R++)t.writeUint32BE(this._stateHi[R],_,R*8),t.writeUint32BE(this._stateLo[R],_,R*8+4);return this},f.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(_){e.wipe(_.stateHi),e.wipe(_.stateLo),_.buffer&&e.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},f}();i.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(f,_,g,D,N,P,T){for(var R=g[0],H=g[1],G=g[2],ie=g[3],E=g[4],x=g[5],m=g[6],S=g[7],y=D[0],u=D[1],v=D[2],K=D[3],V=D[4],ae=D[5],ce=D[6],ge=D[7],U,z,le,te,W,ee,Y,re;T>=128;){for(var xe=0;xe<16;xe++){var ne=8*xe+P;f[xe]=t.readUint32BE(N,ne),_[xe]=t.readUint32BE(N,ne+4)}for(var xe=0;xe<80;xe++){var me=R,he=H,ye=G,q=ie,M=E,$=x,l=m,C=S,se=y,fe=u,Se=v,He=K,Ve=V,je=ae,dt=ce,pt=ge;if(U=S,z=ge,W=z&65535,ee=z>>>16,Y=U&65535,re=U>>>16,U=(E>>>14|V<<32-14)^(E>>>18|V<<32-18)^(V>>>41-32|E<<32-(41-32)),z=(V>>>14|E<<32-14)^(V>>>18|E<<32-18)^(E>>>41-32|V<<32-(41-32)),W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,U=E&x^~E&m,z=V&ae^~V&ce,W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,U=a[xe*2],z=a[xe*2+1],W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,U=f[xe%16],z=_[xe%16],W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,le=Y&65535|re<<16,te=W&65535|ee<<16,U=le,z=te,W=z&65535,ee=z>>>16,Y=U&65535,re=U>>>16,U=(R>>>28|y<<32-28)^(y>>>34-32|R<<32-(34-32))^(y>>>39-32|R<<32-(39-32)),z=(y>>>28|R<<32-28)^(R>>>34-32|y<<32-(34-32))^(R>>>39-32|y<<32-(39-32)),W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,U=R&H^R&G^H&G,z=y&u^y&v^u&v,W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,C=Y&65535|re<<16,pt=W&65535|ee<<16,U=q,z=He,W=z&65535,ee=z>>>16,Y=U&65535,re=U>>>16,U=le,z=te,W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,q=Y&65535|re<<16,He=W&65535|ee<<16,H=me,G=he,ie=ye,E=q,x=M,m=$,S=l,R=C,u=se,v=fe,K=Se,V=He,ae=Ve,ce=je,ge=dt,y=pt,xe%16===15)for(var ne=0;ne<16;ne++)U=f[ne],z=_[ne],W=z&65535,ee=z>>>16,Y=U&65535,re=U>>>16,U=f[(ne+9)%16],z=_[(ne+9)%16],W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,le=f[(ne+1)%16],te=_[(ne+1)%16],U=(le>>>1|te<<32-1)^(le>>>8|te<<32-8)^le>>>7,z=(te>>>1|le<<32-1)^(te>>>8|le<<32-8)^(te>>>7|le<<32-7),W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,le=f[(ne+14)%16],te=_[(ne+14)%16],U=(le>>>19|te<<32-19)^(te>>>61-32|le<<32-(61-32))^le>>>6,z=(te>>>19|le<<32-19)^(le>>>61-32|te<<32-(61-32))^(te>>>6|le<<32-6),W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,f[ne]=Y&65535|re<<16,_[ne]=W&65535|ee<<16}U=R,z=y,W=z&65535,ee=z>>>16,Y=U&65535,re=U>>>16,U=g[0],z=D[0],W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,g[0]=R=Y&65535|re<<16,D[0]=y=W&65535|ee<<16,U=H,z=u,W=z&65535,ee=z>>>16,Y=U&65535,re=U>>>16,U=g[1],z=D[1],W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,g[1]=H=Y&65535|re<<16,D[1]=u=W&65535|ee<<16,U=G,z=v,W=z&65535,ee=z>>>16,Y=U&65535,re=U>>>16,U=g[2],z=D[2],W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,g[2]=G=Y&65535|re<<16,D[2]=v=W&65535|ee<<16,U=ie,z=K,W=z&65535,ee=z>>>16,Y=U&65535,re=U>>>16,U=g[3],z=D[3],W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,g[3]=ie=Y&65535|re<<16,D[3]=K=W&65535|ee<<16,U=E,z=V,W=z&65535,ee=z>>>16,Y=U&65535,re=U>>>16,U=g[4],z=D[4],W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,g[4]=E=Y&65535|re<<16,D[4]=V=W&65535|ee<<16,U=x,z=ae,W=z&65535,ee=z>>>16,Y=U&65535,re=U>>>16,U=g[5],z=D[5],W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,g[5]=x=Y&65535|re<<16,D[5]=ae=W&65535|ee<<16,U=m,z=ce,W=z&65535,ee=z>>>16,Y=U&65535,re=U>>>16,U=g[6],z=D[6],W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,g[6]=m=Y&65535|re<<16,D[6]=ce=W&65535|ee<<16,U=S,z=ge,W=z&65535,ee=z>>>16,Y=U&65535,re=U>>>16,U=g[7],z=D[7],W+=z&65535,ee+=z>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,g[7]=S=Y&65535|re<<16,D[7]=ge=W&65535|ee<<16,P+=128,T-=128}return P}function d(f){var _=new s;_.update(f);var g=_.digest();return _.clean(),g}i.hash=d})(Ad);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.convertSecretKeyToX25519=i.convertPublicKeyToX25519=i.verify=i.sign=i.extractPublicKeyFromSecretKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.SEED_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=i.SIGNATURE_LENGTH=void 0;const t=xn,e=Ad,s=Dr;i.SIGNATURE_LENGTH=64,i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=64,i.SEED_LENGTH=32;function a(q){const M=new Float64Array(16);if(q)for(let $=0;$<q.length;$++)M[$]=q[$];return M}const c=new Uint8Array(32);c[0]=9;const d=a(),f=a([1]),_=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),g=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),D=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),N=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),P=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function T(q,M){for(let $=0;$<16;$++)q[$]=M[$]|0}function R(q){let M=1;for(let $=0;$<16;$++){let l=q[$]+M+65535;M=Math.floor(l/65536),q[$]=l-M*65536}q[0]+=M-1+37*(M-1)}function H(q,M,$){const l=~($-1);for(let C=0;C<16;C++){const se=l&(q[C]^M[C]);q[C]^=se,M[C]^=se}}function G(q,M){const $=a(),l=a();for(let C=0;C<16;C++)l[C]=M[C];R(l),R(l),R(l);for(let C=0;C<2;C++){$[0]=l[0]-65517;for(let fe=1;fe<15;fe++)$[fe]=l[fe]-65535-($[fe-1]>>16&1),$[fe-1]&=65535;$[15]=l[15]-32767-($[14]>>16&1);const se=$[15]>>16&1;$[14]&=65535,H(l,$,1-se)}for(let C=0;C<16;C++)q[2*C]=l[C]&255,q[2*C+1]=l[C]>>8}function ie(q,M){let $=0;for(let l=0;l<32;l++)$|=q[l]^M[l];return(1&$-1>>>8)-1}function E(q,M){const $=new Uint8Array(32),l=new Uint8Array(32);return G($,q),G(l,M),ie($,l)}function x(q){const M=new Uint8Array(32);return G(M,q),M[0]&1}function m(q,M){for(let $=0;$<16;$++)q[$]=M[2*$]+(M[2*$+1]<<8);q[15]&=32767}function S(q,M,$){for(let l=0;l<16;l++)q[l]=M[l]+$[l]}function y(q,M,$){for(let l=0;l<16;l++)q[l]=M[l]-$[l]}function u(q,M,$){let l,C,se=0,fe=0,Se=0,He=0,Ve=0,je=0,dt=0,pt=0,Me=0,Ie=0,Re=0,$e=0,qe=0,Pe=0,Ue=0,De=0,Ce=0,Be=0,Oe=0,ke=0,We=0,et=0,tt=0,Je=0,Qt=0,ur=0,Br=0,er=0,Qr=0,fi=0,Ci=0,mt=$[0],gt=$[1],wt=$[2],Et=$[3],vt=$[4],_t=$[5],Rt=$[6],$t=$[7],Dt=$[8],Ut=$[9],St=$[10],Pt=$[11],It=$[12],ht=$[13],Ft=$[14],jt=$[15];l=M[0],se+=l*mt,fe+=l*gt,Se+=l*wt,He+=l*Et,Ve+=l*vt,je+=l*_t,dt+=l*Rt,pt+=l*$t,Me+=l*Dt,Ie+=l*Ut,Re+=l*St,$e+=l*Pt,qe+=l*It,Pe+=l*ht,Ue+=l*Ft,De+=l*jt,l=M[1],fe+=l*mt,Se+=l*gt,He+=l*wt,Ve+=l*Et,je+=l*vt,dt+=l*_t,pt+=l*Rt,Me+=l*$t,Ie+=l*Dt,Re+=l*Ut,$e+=l*St,qe+=l*Pt,Pe+=l*It,Ue+=l*ht,De+=l*Ft,Ce+=l*jt,l=M[2],Se+=l*mt,He+=l*gt,Ve+=l*wt,je+=l*Et,dt+=l*vt,pt+=l*_t,Me+=l*Rt,Ie+=l*$t,Re+=l*Dt,$e+=l*Ut,qe+=l*St,Pe+=l*Pt,Ue+=l*It,De+=l*ht,Ce+=l*Ft,Be+=l*jt,l=M[3],He+=l*mt,Ve+=l*gt,je+=l*wt,dt+=l*Et,pt+=l*vt,Me+=l*_t,Ie+=l*Rt,Re+=l*$t,$e+=l*Dt,qe+=l*Ut,Pe+=l*St,Ue+=l*Pt,De+=l*It,Ce+=l*ht,Be+=l*Ft,Oe+=l*jt,l=M[4],Ve+=l*mt,je+=l*gt,dt+=l*wt,pt+=l*Et,Me+=l*vt,Ie+=l*_t,Re+=l*Rt,$e+=l*$t,qe+=l*Dt,Pe+=l*Ut,Ue+=l*St,De+=l*Pt,Ce+=l*It,Be+=l*ht,Oe+=l*Ft,ke+=l*jt,l=M[5],je+=l*mt,dt+=l*gt,pt+=l*wt,Me+=l*Et,Ie+=l*vt,Re+=l*_t,$e+=l*Rt,qe+=l*$t,Pe+=l*Dt,Ue+=l*Ut,De+=l*St,Ce+=l*Pt,Be+=l*It,Oe+=l*ht,ke+=l*Ft,We+=l*jt,l=M[6],dt+=l*mt,pt+=l*gt,Me+=l*wt,Ie+=l*Et,Re+=l*vt,$e+=l*_t,qe+=l*Rt,Pe+=l*$t,Ue+=l*Dt,De+=l*Ut,Ce+=l*St,Be+=l*Pt,Oe+=l*It,ke+=l*ht,We+=l*Ft,et+=l*jt,l=M[7],pt+=l*mt,Me+=l*gt,Ie+=l*wt,Re+=l*Et,$e+=l*vt,qe+=l*_t,Pe+=l*Rt,Ue+=l*$t,De+=l*Dt,Ce+=l*Ut,Be+=l*St,Oe+=l*Pt,ke+=l*It,We+=l*ht,et+=l*Ft,tt+=l*jt,l=M[8],Me+=l*mt,Ie+=l*gt,Re+=l*wt,$e+=l*Et,qe+=l*vt,Pe+=l*_t,Ue+=l*Rt,De+=l*$t,Ce+=l*Dt,Be+=l*Ut,Oe+=l*St,ke+=l*Pt,We+=l*It,et+=l*ht,tt+=l*Ft,Je+=l*jt,l=M[9],Ie+=l*mt,Re+=l*gt,$e+=l*wt,qe+=l*Et,Pe+=l*vt,Ue+=l*_t,De+=l*Rt,Ce+=l*$t,Be+=l*Dt,Oe+=l*Ut,ke+=l*St,We+=l*Pt,et+=l*It,tt+=l*ht,Je+=l*Ft,Qt+=l*jt,l=M[10],Re+=l*mt,$e+=l*gt,qe+=l*wt,Pe+=l*Et,Ue+=l*vt,De+=l*_t,Ce+=l*Rt,Be+=l*$t,Oe+=l*Dt,ke+=l*Ut,We+=l*St,et+=l*Pt,tt+=l*It,Je+=l*ht,Qt+=l*Ft,ur+=l*jt,l=M[11],$e+=l*mt,qe+=l*gt,Pe+=l*wt,Ue+=l*Et,De+=l*vt,Ce+=l*_t,Be+=l*Rt,Oe+=l*$t,ke+=l*Dt,We+=l*Ut,et+=l*St,tt+=l*Pt,Je+=l*It,Qt+=l*ht,ur+=l*Ft,Br+=l*jt,l=M[12],qe+=l*mt,Pe+=l*gt,Ue+=l*wt,De+=l*Et,Ce+=l*vt,Be+=l*_t,Oe+=l*Rt,ke+=l*$t,We+=l*Dt,et+=l*Ut,tt+=l*St,Je+=l*Pt,Qt+=l*It,ur+=l*ht,Br+=l*Ft,er+=l*jt,l=M[13],Pe+=l*mt,Ue+=l*gt,De+=l*wt,Ce+=l*Et,Be+=l*vt,Oe+=l*_t,ke+=l*Rt,We+=l*$t,et+=l*Dt,tt+=l*Ut,Je+=l*St,Qt+=l*Pt,ur+=l*It,Br+=l*ht,er+=l*Ft,Qr+=l*jt,l=M[14],Ue+=l*mt,De+=l*gt,Ce+=l*wt,Be+=l*Et,Oe+=l*vt,ke+=l*_t,We+=l*Rt,et+=l*$t,tt+=l*Dt,Je+=l*Ut,Qt+=l*St,ur+=l*Pt,Br+=l*It,er+=l*ht,Qr+=l*Ft,fi+=l*jt,l=M[15],De+=l*mt,Ce+=l*gt,Be+=l*wt,Oe+=l*Et,ke+=l*vt,We+=l*_t,et+=l*Rt,tt+=l*$t,Je+=l*Dt,Qt+=l*Ut,ur+=l*St,Br+=l*Pt,er+=l*It,Qr+=l*ht,fi+=l*Ft,Ci+=l*jt,se+=38*Ce,fe+=38*Be,Se+=38*Oe,He+=38*ke,Ve+=38*We,je+=38*et,dt+=38*tt,pt+=38*Je,Me+=38*Qt,Ie+=38*ur,Re+=38*Br,$e+=38*er,qe+=38*Qr,Pe+=38*fi,Ue+=38*Ci,C=1,l=se+C+65535,C=Math.floor(l/65536),se=l-C*65536,l=fe+C+65535,C=Math.floor(l/65536),fe=l-C*65536,l=Se+C+65535,C=Math.floor(l/65536),Se=l-C*65536,l=He+C+65535,C=Math.floor(l/65536),He=l-C*65536,l=Ve+C+65535,C=Math.floor(l/65536),Ve=l-C*65536,l=je+C+65535,C=Math.floor(l/65536),je=l-C*65536,l=dt+C+65535,C=Math.floor(l/65536),dt=l-C*65536,l=pt+C+65535,C=Math.floor(l/65536),pt=l-C*65536,l=Me+C+65535,C=Math.floor(l/65536),Me=l-C*65536,l=Ie+C+65535,C=Math.floor(l/65536),Ie=l-C*65536,l=Re+C+65535,C=Math.floor(l/65536),Re=l-C*65536,l=$e+C+65535,C=Math.floor(l/65536),$e=l-C*65536,l=qe+C+65535,C=Math.floor(l/65536),qe=l-C*65536,l=Pe+C+65535,C=Math.floor(l/65536),Pe=l-C*65536,l=Ue+C+65535,C=Math.floor(l/65536),Ue=l-C*65536,l=De+C+65535,C=Math.floor(l/65536),De=l-C*65536,se+=C-1+37*(C-1),C=1,l=se+C+65535,C=Math.floor(l/65536),se=l-C*65536,l=fe+C+65535,C=Math.floor(l/65536),fe=l-C*65536,l=Se+C+65535,C=Math.floor(l/65536),Se=l-C*65536,l=He+C+65535,C=Math.floor(l/65536),He=l-C*65536,l=Ve+C+65535,C=Math.floor(l/65536),Ve=l-C*65536,l=je+C+65535,C=Math.floor(l/65536),je=l-C*65536,l=dt+C+65535,C=Math.floor(l/65536),dt=l-C*65536,l=pt+C+65535,C=Math.floor(l/65536),pt=l-C*65536,l=Me+C+65535,C=Math.floor(l/65536),Me=l-C*65536,l=Ie+C+65535,C=Math.floor(l/65536),Ie=l-C*65536,l=Re+C+65535,C=Math.floor(l/65536),Re=l-C*65536,l=$e+C+65535,C=Math.floor(l/65536),$e=l-C*65536,l=qe+C+65535,C=Math.floor(l/65536),qe=l-C*65536,l=Pe+C+65535,C=Math.floor(l/65536),Pe=l-C*65536,l=Ue+C+65535,C=Math.floor(l/65536),Ue=l-C*65536,l=De+C+65535,C=Math.floor(l/65536),De=l-C*65536,se+=C-1+37*(C-1),q[0]=se,q[1]=fe,q[2]=Se,q[3]=He,q[4]=Ve,q[5]=je,q[6]=dt,q[7]=pt,q[8]=Me,q[9]=Ie,q[10]=Re,q[11]=$e,q[12]=qe,q[13]=Pe,q[14]=Ue,q[15]=De}function v(q,M){u(q,M,M)}function K(q,M){const $=a();let l;for(l=0;l<16;l++)$[l]=M[l];for(l=253;l>=0;l--)v($,$),l!==2&&l!==4&&u($,$,M);for(l=0;l<16;l++)q[l]=$[l]}function V(q,M){const $=a();let l;for(l=0;l<16;l++)$[l]=M[l];for(l=250;l>=0;l--)v($,$),l!==1&&u($,$,M);for(l=0;l<16;l++)q[l]=$[l]}function ae(q,M){const $=a(),l=a(),C=a(),se=a(),fe=a(),Se=a(),He=a(),Ve=a(),je=a();y($,q[1],q[0]),y(je,M[1],M[0]),u($,$,je),S(l,q[0],q[1]),S(je,M[0],M[1]),u(l,l,je),u(C,q[3],M[3]),u(C,C,g),u(se,q[2],M[2]),S(se,se,se),y(fe,l,$),y(Se,se,C),S(He,se,C),S(Ve,l,$),u(q[0],fe,Se),u(q[1],Ve,He),u(q[2],He,Se),u(q[3],fe,Ve)}function ce(q,M,$){for(let l=0;l<4;l++)H(q[l],M[l],$)}function ge(q,M){const $=a(),l=a(),C=a();K(C,M[2]),u($,M[0],C),u(l,M[1],C),G(q,l),q[31]^=x($)<<7}function U(q,M,$){T(q[0],d),T(q[1],f),T(q[2],f),T(q[3],d);for(let l=255;l>=0;--l){const C=$[l/8|0]>>(l&7)&1;ce(q,M,C),ae(M,q),ae(q,q),ce(q,M,C)}}function z(q,M){const $=[a(),a(),a(),a()];T($[0],D),T($[1],N),T($[2],f),u($[3],D,N),U(q,$,M)}function le(q){if(q.length!==i.SEED_LENGTH)throw new Error(`ed25519: seed must be ${i.SEED_LENGTH} bytes`);const M=(0,e.hash)(q);M[0]&=248,M[31]&=127,M[31]|=64;const $=new Uint8Array(32),l=[a(),a(),a(),a()];z(l,M),ge($,l);const C=new Uint8Array(64);return C.set(q),C.set($,32),{publicKey:$,secretKey:C}}i.generateKeyPairFromSeed=le;function te(q){const M=(0,t.randomBytes)(32,q),$=le(M);return(0,s.wipe)(M),$}i.generateKeyPair=te;function W(q){if(q.length!==i.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${i.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(q.subarray(32))}i.extractPublicKeyFromSecretKey=W;const ee=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Y(q,M){let $,l,C,se;for(l=63;l>=32;--l){for($=0,C=l-32,se=l-12;C<se;++C)M[C]+=$-16*M[l]*ee[C-(l-32)],$=Math.floor((M[C]+128)/256),M[C]-=$*256;M[C]+=$,M[l]=0}for($=0,C=0;C<32;C++)M[C]+=$-(M[31]>>4)*ee[C],$=M[C]>>8,M[C]&=255;for(C=0;C<32;C++)M[C]-=$*ee[C];for(l=0;l<32;l++)M[l+1]+=M[l]>>8,q[l]=M[l]&255}function re(q){const M=new Float64Array(64);for(let $=0;$<64;$++)M[$]=q[$];for(let $=0;$<64;$++)q[$]=0;Y(q,M)}function xe(q,M){const $=new Float64Array(64),l=[a(),a(),a(),a()],C=(0,e.hash)(q.subarray(0,32));C[0]&=248,C[31]&=127,C[31]|=64;const se=new Uint8Array(64);se.set(C.subarray(32),32);const fe=new e.SHA512;fe.update(se.subarray(32)),fe.update(M);const Se=fe.digest();fe.clean(),re(Se),z(l,Se),ge(se,l),fe.reset(),fe.update(se.subarray(0,32)),fe.update(q.subarray(32)),fe.update(M);const He=fe.digest();re(He);for(let Ve=0;Ve<32;Ve++)$[Ve]=Se[Ve];for(let Ve=0;Ve<32;Ve++)for(let je=0;je<32;je++)$[Ve+je]+=He[Ve]*C[je];return Y(se.subarray(32),$),se}i.sign=xe;function ne(q,M){const $=a(),l=a(),C=a(),se=a(),fe=a(),Se=a(),He=a();return T(q[2],f),m(q[1],M),v(C,q[1]),u(se,C,_),y(C,C,q[2]),S(se,q[2],se),v(fe,se),v(Se,fe),u(He,Se,fe),u($,He,C),u($,$,se),V($,$),u($,$,C),u($,$,se),u($,$,se),u(q[0],$,se),v(l,q[0]),u(l,l,se),E(l,C)&&u(q[0],q[0],P),v(l,q[0]),u(l,l,se),E(l,C)?-1:(x(q[0])===M[31]>>7&&y(q[0],d,q[0]),u(q[3],q[0],q[1]),0)}function me(q,M,$){const l=new Uint8Array(32),C=[a(),a(),a(),a()],se=[a(),a(),a(),a()];if($.length!==i.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${i.SIGNATURE_LENGTH} bytes`);if(ne(se,q))return!1;const fe=new e.SHA512;fe.update($.subarray(0,32)),fe.update(q),fe.update(M);const Se=fe.digest();return re(Se),U(C,se,Se),z(se,$.subarray(32)),ae(C,se),ge(l,C),!ie($,l)}i.verify=me;function he(q){let M=[a(),a(),a(),a()];if(ne(M,q))throw new Error("Ed25519: invalid public key");let $=a(),l=a(),C=M[1];S($,f,C),y(l,f,C),K(l,l),u($,$,l);let se=new Uint8Array(32);return G(se,$),se}i.convertPublicKeyToX25519=he;function ye(q){const M=(0,e.hash)(q.subarray(0,32));M[0]&=248,M[31]&=127,M[31]|=64;const $=new Uint8Array(M.subarray(0,32));return(0,s.wipe)(M),$}i.convertSecretKeyToX25519=ye})(Eu);const t3="EdDSA",r3="JWT",Nd=".",Td="base64url",i3="utf8",n3="utf8",s3=":",a3="did",o3="key",of="base58btc",c3="z",u3="K36",h3=32;function Ca(i){return cr(_r(fu(i),i3),Td)}function Rd(i){const t=_r(u3,of),e=c3+cr(zc([t,i]),of);return[a3,o3,e].join(s3)}function l3(i){return cr(i,Td)}function f3(i){return _r([Ca(i.header),Ca(i.payload)].join(Nd),n3)}function d3(i){return[Ca(i.header),Ca(i.payload),l3(i.signature)].join(Nd)}function cf(i=xn.randomBytes(h3)){return Eu.generateKeyPairFromSeed(i)}async function p3(i,t,e,s,a=ve.fromMiliseconds(Date.now())){const c={alg:t3,typ:r3},d=Rd(s.publicKey),f=a+e,_={iss:d,sub:i,aud:t,iat:a,exp:f},g=f3({header:c,payload:_}),D=Eu.sign(s.secretKey,g);return d3({header:c,payload:_,signature:D})}var hs={};(function(i){const t=Qf,e=ed,s=Xf,a=Zf,c=E=>E==null,d=Symbol("encodeFragmentIdentifier");function f(E){switch(E.arrayFormat){case"index":return x=>(m,S)=>{const y=m.length;return S===void 0||E.skipNull&&S===null||E.skipEmptyString&&S===""?m:S===null?[...m,[D(x,E),"[",y,"]"].join("")]:[...m,[D(x,E),"[",D(y,E),"]=",D(S,E)].join("")]};case"bracket":return x=>(m,S)=>S===void 0||E.skipNull&&S===null||E.skipEmptyString&&S===""?m:S===null?[...m,[D(x,E),"[]"].join("")]:[...m,[D(x,E),"[]=",D(S,E)].join("")];case"colon-list-separator":return x=>(m,S)=>S===void 0||E.skipNull&&S===null||E.skipEmptyString&&S===""?m:S===null?[...m,[D(x,E),":list="].join("")]:[...m,[D(x,E),":list=",D(S,E)].join("")];case"comma":case"separator":case"bracket-separator":{const x=E.arrayFormat==="bracket-separator"?"[]=":"=";return m=>(S,y)=>y===void 0||E.skipNull&&y===null||E.skipEmptyString&&y===""?S:(y=y===null?"":y,S.length===0?[[D(m,E),x,D(y,E)].join("")]:[[S,D(y,E)].join(E.arrayFormatSeparator)])}default:return x=>(m,S)=>S===void 0||E.skipNull&&S===null||E.skipEmptyString&&S===""?m:S===null?[...m,D(x,E)]:[...m,[D(x,E),"=",D(S,E)].join("")]}}function _(E){let x;switch(E.arrayFormat){case"index":return(m,S,y)=>{if(x=/\[(\d*)\]$/.exec(m),m=m.replace(/\[\d*\]$/,""),!x){y[m]=S;return}y[m]===void 0&&(y[m]={}),y[m][x[1]]=S};case"bracket":return(m,S,y)=>{if(x=/(\[\])$/.exec(m),m=m.replace(/\[\]$/,""),!x){y[m]=S;return}if(y[m]===void 0){y[m]=[S];return}y[m]=[].concat(y[m],S)};case"colon-list-separator":return(m,S,y)=>{if(x=/(:list)$/.exec(m),m=m.replace(/:list$/,""),!x){y[m]=S;return}if(y[m]===void 0){y[m]=[S];return}y[m]=[].concat(y[m],S)};case"comma":case"separator":return(m,S,y)=>{const u=typeof S=="string"&&S.includes(E.arrayFormatSeparator),v=typeof S=="string"&&!u&&N(S,E).includes(E.arrayFormatSeparator);S=v?N(S,E):S;const K=u||v?S.split(E.arrayFormatSeparator).map(V=>N(V,E)):S===null?S:N(S,E);y[m]=K};case"bracket-separator":return(m,S,y)=>{const u=/(\[\])$/.test(m);if(m=m.replace(/\[\]$/,""),!u){y[m]=S&&N(S,E);return}const v=S===null?[]:S.split(E.arrayFormatSeparator).map(K=>N(K,E));if(y[m]===void 0){y[m]=v;return}y[m]=[].concat(y[m],v)};default:return(m,S,y)=>{if(y[m]===void 0){y[m]=S;return}y[m]=[].concat(y[m],S)}}}function g(E){if(typeof E!="string"||E.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function D(E,x){return x.encode?x.strict?t(E):encodeURIComponent(E):E}function N(E,x){return x.decode?e(E):E}function P(E){return Array.isArray(E)?E.sort():typeof E=="object"?P(Object.keys(E)).sort((x,m)=>Number(x)-Number(m)).map(x=>E[x]):E}function T(E){const x=E.indexOf("#");return x!==-1&&(E=E.slice(0,x)),E}function R(E){let x="";const m=E.indexOf("#");return m!==-1&&(x=E.slice(m)),x}function H(E){E=T(E);const x=E.indexOf("?");return x===-1?"":E.slice(x+1)}function G(E,x){return x.parseNumbers&&!Number.isNaN(Number(E))&&typeof E=="string"&&E.trim()!==""?E=Number(E):x.parseBooleans&&E!==null&&(E.toLowerCase()==="true"||E.toLowerCase()==="false")&&(E=E.toLowerCase()==="true"),E}function ie(E,x){x=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},x),g(x.arrayFormatSeparator);const m=_(x),S=Object.create(null);if(typeof E!="string"||(E=E.trim().replace(/^[?#&]/,""),!E))return S;for(const y of E.split("&")){if(y==="")continue;let[u,v]=s(x.decode?y.replace(/\+/g," "):y,"=");v=v===void 0?null:["comma","separator","bracket-separator"].includes(x.arrayFormat)?v:N(v,x),m(N(u,x),v,S)}for(const y of Object.keys(S)){const u=S[y];if(typeof u=="object"&&u!==null)for(const v of Object.keys(u))u[v]=G(u[v],x);else S[y]=G(u,x)}return x.sort===!1?S:(x.sort===!0?Object.keys(S).sort():Object.keys(S).sort(x.sort)).reduce((y,u)=>{const v=S[u];return Boolean(v)&&typeof v=="object"&&!Array.isArray(v)?y[u]=P(v):y[u]=v,y},Object.create(null))}i.extract=H,i.parse=ie,i.stringify=(E,x)=>{if(!E)return"";x=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},x),g(x.arrayFormatSeparator);const m=v=>x.skipNull&&c(E[v])||x.skipEmptyString&&E[v]==="",S=f(x),y={};for(const v of Object.keys(E))m(v)||(y[v]=E[v]);const u=Object.keys(y);return x.sort!==!1&&u.sort(x.sort),u.map(v=>{const K=E[v];return K===void 0?"":K===null?D(v,x):Array.isArray(K)?K.length===0&&x.arrayFormat==="bracket-separator"?D(v,x)+"[]":K.reduce(S(v),[]).join("&"):D(v,x)+"="+D(K,x)}).filter(v=>v.length>0).join("&")},i.parseUrl=(E,x)=>{x=Object.assign({decode:!0},x);const[m,S]=s(E,"#");return Object.assign({url:m.split("?")[0]||"",query:ie(H(E),x)},x&&x.parseFragmentIdentifier&&S?{fragmentIdentifier:N(S,x)}:{})},i.stringifyUrl=(E,x)=>{x=Object.assign({encode:!0,strict:!0,[d]:!0},x);const m=T(E.url).split("?")[0]||"",S=i.extract(E.url),y=i.parse(S,{sort:!1}),u=Object.assign(y,E.query);let v=i.stringify(u,x);v&&(v=`?${v}`);let K=R(E.url);return E.fragmentIdentifier&&(K=`#${x[d]?D(E.fragmentIdentifier,x):E.fragmentIdentifier}`),`${m}${v}${K}`},i.pick=(E,x,m)=>{m=Object.assign({parseFragmentIdentifier:!0,[d]:!1},m);const{url:S,query:y,fragmentIdentifier:u}=i.parseUrl(E,m);return i.stringifyUrl({url:S,query:a(y,x),fragmentIdentifier:u},m)},i.exclude=(E,x,m)=>{const S=Array.isArray(x)?y=>!x.includes(y):(y,u)=>!x(y,u);return i.pick(E,S,m)}})(hs);function $d(i,t){return i.includes(":")?[i]:t.chains||[]}const Ud="base10",or="base16",tu="base64pad",Du="utf8",Fd=0,Zi=1,g3=0,uf=1,ru=12,Su=32;function _3(){const i=mu.generateKeyPair();return{privateKey:cr(i.secretKey,or),publicKey:cr(i.publicKey,or)}}function iu(){const i=xn.randomBytes(Su);return cr(i,or)}function y3(i,t){const e=mu.sharedKey(_r(i,or),_r(t,or)),s=new $b(ja.SHA256,e).expand(Su);return cr(s,or)}function v3(i){const t=ja.hash(_r(i,or));return cr(t,or)}function Dn(i){const t=ja.hash(_r(i,Du));return cr(t,or)}function b3(i){return _r(`${i}`,Ud)}function gs(i){return Number(cr(i,Ud))}function m3(i){const t=b3(typeof i.type<"u"?i.type:Fd);if(gs(t)===Zi&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const e=typeof i.senderPublicKey<"u"?_r(i.senderPublicKey,or):void 0,s=typeof i.iv<"u"?_r(i.iv,or):xn.randomBytes(ru),a=new vu.ChaCha20Poly1305(_r(i.symKey,or)).seal(s,_r(i.message,Du));return E3({type:t,sealed:a,iv:s,senderPublicKey:e})}function w3(i){const t=new vu.ChaCha20Poly1305(_r(i.symKey,or)),{sealed:e,iv:s}=Aa(i.encoded),a=t.open(s,e);if(a===null)throw new Error("Failed to decrypt");return cr(a,Du)}function E3(i){if(gs(i.type)===Zi){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return cr(zc([i.type,i.senderPublicKey,i.iv,i.sealed]),tu)}return cr(zc([i.type,i.iv,i.sealed]),tu)}function Aa(i){const t=_r(i,tu),e=t.slice(g3,uf),s=uf;if(gs(e)===Zi){const f=s+Su,_=f+ru,g=t.slice(s,f),D=t.slice(f,_),N=t.slice(_);return{type:e,sealed:N,iv:D,senderPublicKey:g}}const a=s+ru,c=t.slice(s,a),d=t.slice(a);return{type:e,sealed:d,iv:c}}function D3(i,t){const e=Aa(i);return jd({type:gs(e.type),senderPublicKey:typeof e.senderPublicKey<"u"?cr(e.senderPublicKey,or):void 0,receiverPublicKey:t?.receiverPublicKey})}function jd(i){const t=i?.type||Fd;if(t===Zi){if(typeof i?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof i?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:i?.senderPublicKey,receiverPublicKey:i?.receiverPublicKey}}function hf(i){return i.type===Zi&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}var S3=Object.defineProperty,lf=Object.getOwnPropertySymbols,I3=Object.prototype.hasOwnProperty,x3=Object.prototype.propertyIsEnumerable,ff=(i,t,e)=>t in i?S3(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,df=(i,t)=>{for(var e in t||(t={}))I3.call(t,e)&&ff(i,e,t[e]);if(lf)for(var e of lf(t))x3.call(t,e)&&ff(i,e,t[e]);return i};const O3="ReactNative",Wi={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},P3="js";function Iu(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Ld(){return!Wv()&&!!td()&&navigator.product===O3}function xu(){return!Iu()&&!!td()}function Md(){return Ld()?Wi.reactNative:Iu()?Wi.node:xu()?Wi.browser:Wi.unknown}function C3(i,t){let e=hs.parse(i);return e=df(df({},e),t),i=hs.stringify(e),i}function A3(){return Gv()||{name:"",description:"",url:"",icons:[""]}}function N3(){const i=Yv();if(i===null)return"unknown";const t=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[t,i.name,i.version].join("-"):[t,i.version].join("-")}function T3(){var i;const t=Md();return t===Wi.browser?[t,((i=Jv())==null?void 0:i.host)||"unknown"].join(":"):t}function R3(i,t,e){const s=N3(),a=T3();return[[i,t].join("-"),[P3,e].join("-"),s,a].join("/")}function $3({protocol:i,version:t,relayUrl:e,sdkVersion:s,auth:a,projectId:c,useOnCloseEvent:d}){const f=e.split("?"),_=R3(i,t,s),g={auth:a,ua:_,projectId:c,useOnCloseEvent:d||void 0},D=C3(f[1]||"",g);return f[0]+"?"+D}function Yi(i,t){return i.filter(e=>t.includes(e)).length===i.length}function qd(i){return Object.fromEntries(i.entries())}function zd(i){return new Map(Object.entries(i))}function En(i=ve.FIVE_MINUTES,t){const e=ve.toMiliseconds(i||ve.FIVE_MINUTES);let s,a,c;return{resolve:d=>{c&&s&&(clearTimeout(c),s(d))},reject:d=>{c&&a&&(clearTimeout(c),a(d))},done:()=>new Promise((d,f)=>{c=setTimeout(()=>{f(new Error(t))},e),s=d,a=f})}}function Na(i,t,e){return new Promise(async(s,a)=>{const c=setTimeout(()=>a(new Error(e)),t);try{const d=await i;s(d)}catch(d){a(d)}clearTimeout(c)})}function Hd(i,t){if(typeof t=="string"&&t.startsWith(`${i}:`))return t;if(i.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(i.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${i}`)}function U3(i){return Hd("topic",i)}function F3(i){return Hd("id",i)}function Bd(i){const[t,e]=i.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof e=="string")s.topic=e;else if(t==="id"&&Number.isInteger(Number(e)))s.id=Number(e);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${e}`);return s}function Zr(i,t){return ve.fromMiliseconds((t||Date.now())+ve.toMiliseconds(i))}function Si(i){return Date.now()>=ve.toMiliseconds(i)}function qt(i,t){return`${i}${t?`:${t}`:""}`}function Ic(i=[],t=[]){return[...new Set([...i,...t])]}async function j3({id:i,topic:t,wcDeepLink:e}){try{if(!e)return;let a=(typeof e=="string"?JSON.parse(e):e)?.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const c=`${a}/wc?requestId=${i}&sessionTopic=${t}`,d=Md();d===Wi.browser?window.open(c,"_self","noreferrer noopener"):d===Wi.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(c)}catch(s){console.error(s)}}const L3="irn";function nu(i){return i?.relay||{protocol:L3}}function Sa(i){const t=_w[i];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${i}`);return t}var M3=Object.defineProperty,pf=Object.getOwnPropertySymbols,q3=Object.prototype.hasOwnProperty,z3=Object.prototype.propertyIsEnumerable,gf=(i,t,e)=>t in i?M3(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,H3=(i,t)=>{for(var e in t||(t={}))q3.call(t,e)&&gf(i,e,t[e]);if(pf)for(var e of pf(t))z3.call(t,e)&&gf(i,e,t[e]);return i};function B3(i,t="-"){const e={},s="relay"+t;return Object.keys(i).forEach(a=>{if(a.startsWith(s)){const c=a.replace(s,""),d=i[a];e[c]=d}}),e}function K3(i){const t=i.indexOf(":"),e=i.indexOf("?")!==-1?i.indexOf("?"):void 0,s=i.substring(0,t),a=i.substring(t+1,e).split("@"),c=typeof e<"u"?i.substring(e):"",d=hs.parse(c);return{protocol:s,topic:V3(a[0]),version:parseInt(a[1],10),symKey:d.symKey,relay:B3(d)}}function V3(i){return i.startsWith("//")?i.substring(2):i}function k3(i,t="-"){const e="relay",s={};return Object.keys(i).forEach(a=>{const c=e+t+a;i[a]&&(s[c]=i[a])}),s}function G3(i){return`${i.protocol}:${i.topic}@${i.version}?`+hs.stringify(H3({symKey:i.symKey},k3(i.relay)))}function On(i){const t=[];return i.forEach(e=>{const[s,a]=e.split(":");t.push(`${s}:${a}`)}),t}function W3(i){const t=[];return Object.values(i).forEach(e=>{t.push(...On(e.accounts))}),t}function Y3(i,t){const e=[];return Object.values(i).forEach(s=>{On(s.accounts).includes(t)&&e.push(...s.methods)}),e}function J3(i,t){const e=[];return Object.values(i).forEach(s=>{On(s.accounts).includes(t)&&e.push(...s.events)}),e}function X3(i,t){const e=xa(i,t);if(e)throw new Error(e.message);const s={};for(const[a,c]of Object.entries(i))s[a]={methods:c.methods,events:c.events,chains:c.accounts.map(d=>`${d.split(":")[0]}:${d.split(":")[1]}`)};return s}function Kd(i){return i.includes(":")}function Ia(i){return Kd(i)?i.split(":")[0]:i}const Z3={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Q3={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ue(i,t){const{message:e,code:s}=Q3[i];return{message:t?`${e} ${t}`:e,code:s}}function zt(i,t){const{message:e,code:s}=Z3[i];return{message:t?`${e} ${t}`:e,code:s}}function Pn(i,t){return Array.isArray(i)?typeof t<"u"&&i.length?i.every(t):!0:!1}function Sn(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function ar(i){return typeof i>"u"}function kt(i,t){return t&&ar(i)?!0:typeof i=="string"&&!!i.trim().length}function Ou(i,t){return t&&ar(i)?!0:typeof i=="number"&&!isNaN(i)}function e6(i,t){const{requiredNamespaces:e}=t,s=Object.keys(i.namespaces),a=Object.keys(e);let c=!0;return Yi(a,s)?(s.forEach(d=>{const{accounts:f,methods:_,events:g}=i.namespaces[d],D=On(f),N=e[d];(!Yi($d(d,N),D)||!Yi(N.methods,_)||!Yi(N.events,g))&&(c=!1)}),c):!1}function Pu(i){return kt(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function t6(i){if(kt(i,!1)&&i.includes(":")){const t=i.split(":");if(t.length===3){const e=t[0]+":"+t[1];return!!t[2]&&Pu(e)}}return!1}function r6(i){if(kt(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function i6(i){var t;return(t=i?.proposer)==null?void 0:t.publicKey}function n6(i){return i?.topic}function s6(i,t){let e=null;return kt(i?.publicKey,!1)||(e=ue("MISSING_OR_INVALID",`${t} controller public key should be a string`)),e}function _f(i){let t=!0;return Pn(i)?i.length&&(t=i.every(e=>kt(e,!1))):t=!1,t}function a6(i,t,e){let s=null;return Pn(t)?t.forEach(a=>{s||(!Pu(a)||!a.includes(i))&&(s=zt("UNSUPPORTED_CHAINS",`${e}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):s=zt("UNSUPPORTED_CHAINS",`${e}, chains ${t} should be an array of strings conforming to "namespace:chainId" format`),s}function o6(i,t){let e=null;return Object.entries(i).forEach(([s,a])=>{if(e)return;const c=a6(s,$d(s,a),`${t} requiredNamespace`);c&&(e=c)}),e}function c6(i,t){let e=null;return Pn(i)?i.forEach(s=>{e||t6(s)||(e=zt("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):e=zt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),e}function u6(i,t){let e=null;return Object.values(i).forEach(s=>{if(e)return;const a=c6(s?.accounts,`${t} namespace`);a&&(e=a)}),e}function h6(i,t){let e=null;return _f(i?.methods)?_f(i?.events)||(e=zt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):e=zt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),e}function Vd(i,t){let e=null;return Object.values(i).forEach(s=>{if(e)return;const a=h6(s,`${t}, namespace`);a&&(e=a)}),e}function l6(i,t,e){let s=null;if(i&&Sn(i)){const a=Vd(i,t);a&&(s=a);const c=o6(i,t);c&&(s=c)}else s=ue("MISSING_OR_INVALID",`${t}, ${e} should be an object with data`);return s}function xa(i,t){let e=null;if(i&&Sn(i)){const s=Vd(i,t);s&&(e=s);const a=u6(i,t);a&&(e=a)}else e=ue("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return e}function kd(i){return kt(i.protocol,!0)}function f6(i,t){let e=!1;return t&&!i?e=!0:i&&Pn(i)&&i.length&&i.forEach(s=>{e=kd(s)}),e}function d6(i){return typeof i=="number"}function gr(i){return typeof i<"u"&&typeof i!==null}function p6(i){return!(!i||typeof i!="object"||!i.code||!Ou(i.code,!1)||!i.message||!kt(i.message,!1))}function g6(i){return!(ar(i)||!kt(i.method,!1))}function _6(i){return!(ar(i)||ar(i.result)&&ar(i.error)||!Ou(i.id,!1)||!kt(i.jsonrpc,!1))}function y6(i){return!(ar(i)||!kt(i.name,!1))}function yf(i,t){return!(!Pu(t)||!W3(i).includes(t))}function v6(i,t,e){return kt(e,!1)?Y3(i,t).includes(e):!1}function b6(i,t,e){return kt(e,!1)?J3(i,t).includes(e):!1}function vf(i,t,e){let s=null;const a=m6(i),c=w6(t),d=Object.keys(a),f=Object.keys(c),_=bf(Object.keys(i)),g=bf(Object.keys(t)),D=_.filter(N=>!g.includes(N));return D.length&&(s=ue("NON_CONFORMING_NAMESPACES",`${e} namespaces keys don't satisfy requiredNamespaces.
      Required: ${D.toString()}
      Received: ${Object.keys(t).toString()}`)),Yi(d,f)||(s=ue("NON_CONFORMING_NAMESPACES",`${e} namespaces chains don't satisfy required namespaces.
      Required: ${d.toString()}
      Approved: ${f.toString()}`)),Object.keys(t).forEach(N=>{if(!N.includes(":")||s)return;const P=On(t[N].accounts);P.includes(N)||(s=ue("NON_CONFORMING_NAMESPACES",`${e} namespaces accounts don't satisfy namespace accounts for ${N}
        Required: ${N}
        Approved: ${P.toString()}`))}),d.forEach(N=>{s||(Yi(a[N].methods,c[N].methods)?Yi(a[N].events,c[N].events)||(s=ue("NON_CONFORMING_NAMESPACES",`${e} namespaces events don't satisfy namespace events for ${N}`)):s=ue("NON_CONFORMING_NAMESPACES",`${e} namespaces methods don't satisfy namespace methods for ${N}`))}),s}function m6(i){const t={};return Object.keys(i).forEach(e=>{var s;e.includes(":")?t[e]=i[e]:(s=i[e].chains)==null||s.forEach(a=>{t[a]={methods:i[e].methods,events:i[e].events}})}),t}function bf(i){return[...new Set(i.map(t=>t.includes(":")?t.split(":")[0]:t))]}function w6(i){const t={};return Object.keys(i).forEach(e=>{e.includes(":")?t[e]=i[e]:On(i[e].accounts)?.forEach(a=>{t[a]={accounts:i[e].accounts.filter(c=>c.includes(`${a}:`)),methods:i[e].methods,events:i[e].events}})}),t}function E6(i,t){return Ou(i,!1)&&i<=t.max&&i>=t.min}const mf=10,D6=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),S6=()=>typeof window<"u",I6=D6();class x6{constructor(t){if(this.url=t,this.events=new Fr,this.registering=!1,!Nl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,e)=>{if(typeof this.socket>"u"){e(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t,e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(fu(t))}catch(s){this.onError(t.id,s)}}register(t=this.url){if(!Nl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((s,a)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),a(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((e,s)=>{const a=Xv.isReactNative()?void 0:{rejectUnauthorized:!Zv(t)},c=new I6(t,[],a);S6()?c.onerror=d=>{const f=d;s(this.emitError(f.error))}:c.on("error",d=>{s(this.emitError(d))}),c.onopen=()=>{this.onOpen(c),e(c)}})}onOpen(t){t.onmessage=e=>this.onPayload(e),t.onclose=e=>this.onClose(e),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const e=typeof t.data=="string"?rd(t.data):t.data;this.events.emit("payload",e)}onError(t,e){const s=this.parseError(e),a=s.message||s.toString(),c=du(t,a);this.events.emit("payload",c)}parseError(t,e=this.url){return Qv(t,e,"WS")}resetMaxListeners(){this.events.getMaxListeners()>mf&&this.events.setMaxListeners(mf)}emitError(t){const e=this.parseError(new Error(t?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",e),e}}var Ta={exports:{}};Ta.exports;(function(i,t){var e=200,s="__lodash_hash_undefined__",a=1,c=2,d=9007199254740991,f="[object Arguments]",_="[object Array]",g="[object AsyncFunction]",D="[object Boolean]",N="[object Date]",P="[object Error]",T="[object Function]",R="[object GeneratorFunction]",H="[object Map]",G="[object Number]",ie="[object Null]",E="[object Object]",x="[object Promise]",m="[object Proxy]",S="[object RegExp]",y="[object Set]",u="[object String]",v="[object Symbol]",K="[object Undefined]",V="[object WeakMap]",ae="[object ArrayBuffer]",ce="[object DataView]",ge="[object Float32Array]",U="[object Float64Array]",z="[object Int8Array]",le="[object Int16Array]",te="[object Int32Array]",W="[object Uint8Array]",ee="[object Uint8ClampedArray]",Y="[object Uint16Array]",re="[object Uint32Array]",xe=/[\\^$.*+?()[\]{}|]/g,ne=/^\[object .+?Constructor\]$/,me=/^(?:0|[1-9]\d*)$/,he={};he[ge]=he[U]=he[z]=he[le]=he[te]=he[W]=he[ee]=he[Y]=he[re]=!0,he[f]=he[_]=he[ae]=he[D]=he[ce]=he[N]=he[P]=he[T]=he[H]=he[G]=he[E]=he[S]=he[y]=he[u]=he[V]=!1;var ye=typeof Gi=="object"&&Gi&&Gi.Object===Object&&Gi,q=typeof self=="object"&&self&&self.Object===Object&&self,M=ye||q||Function("return this")(),$=t&&!t.nodeType&&t,l=$&&!0&&i&&!i.nodeType&&i,C=l&&l.exports===$,se=C&&ye.process,fe=function(){try{return se&&se.binding&&se.binding("util")}catch{}}(),Se=fe&&fe.isTypedArray;function He(I,F){for(var Z=-1,de=I==null?0:I.length,ot=0,Ne=[];++Z<de;){var lt=I[Z];F(lt,Z,I)&&(Ne[ot++]=lt)}return Ne}function Ve(I,F){for(var Z=-1,de=F.length,ot=I.length;++Z<de;)I[ot+Z]=F[Z];return I}function je(I,F){for(var Z=-1,de=I==null?0:I.length;++Z<de;)if(F(I[Z],Z,I))return!0;return!1}function dt(I,F){for(var Z=-1,de=Array(I);++Z<I;)de[Z]=F(Z);return de}function pt(I){return function(F){return I(F)}}function Me(I,F){return I.has(F)}function Ie(I,F){return I?.[F]}function Re(I){var F=-1,Z=Array(I.size);return I.forEach(function(de,ot){Z[++F]=[ot,de]}),Z}function $e(I,F){return function(Z){return I(F(Z))}}function qe(I){var F=-1,Z=Array(I.size);return I.forEach(function(de){Z[++F]=de}),Z}var Pe=Array.prototype,Ue=Function.prototype,De=Object.prototype,Ce=M["__core-js_shared__"],Be=Ue.toString,Oe=De.hasOwnProperty,ke=function(){var I=/[^.]+$/.exec(Ce&&Ce.keys&&Ce.keys.IE_PROTO||"");return I?"Symbol(src)_1."+I:""}(),We=De.toString,et=RegExp("^"+Be.call(Oe).replace(xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=C?M.Buffer:void 0,Je=M.Symbol,Qt=M.Uint8Array,ur=De.propertyIsEnumerable,Br=Pe.splice,er=Je?Je.toStringTag:void 0,Qr=Object.getOwnPropertySymbols,fi=tt?tt.isBuffer:void 0,Ci=$e(Object.keys,Object),mt=yr(M,"DataView"),gt=yr(M,"Map"),wt=yr(M,"Promise"),Et=yr(M,"Set"),vt=yr(M,"WeakMap"),_t=yr(Object,"create"),Rt=ti(mt),$t=ti(gt),Dt=ti(wt),Ut=ti(Et),St=ti(vt),Pt=Je?Je.prototype:void 0,It=Pt?Pt.valueOf:void 0;function ht(I){var F=-1,Z=I==null?0:I.length;for(this.clear();++F<Z;){var de=I[F];this.set(de[0],de[1])}}function Ft(){this.__data__=_t?_t(null):{},this.size=0}function jt(I){var F=this.has(I)&&delete this.__data__[I];return this.size-=F?1:0,F}function Ka(I){var F=this.__data__;if(_t){var Z=F[I];return Z===s?void 0:Z}return Oe.call(F,I)?F[I]:void 0}function Va(I){var F=this.__data__;return _t?F[I]!==void 0:Oe.call(F,I)}function ka(I,F){var Z=this.__data__;return this.size+=this.has(I)?0:1,Z[I]=_t&&F===void 0?s:F,this}ht.prototype.clear=Ft,ht.prototype.delete=jt,ht.prototype.get=Ka,ht.prototype.has=Va,ht.prototype.set=ka;function Sr(I){var F=-1,Z=I==null?0:I.length;for(this.clear();++F<Z;){var de=I[F];this.set(de[0],de[1])}}function Ga(){this.__data__=[],this.size=0}function Wa(I){var F=this.__data__,Z=Ai(F,I);if(Z<0)return!1;var de=F.length-1;return Z==de?F.pop():Br.call(F,Z,1),--this.size,!0}function Ya(I){var F=this.__data__,Z=Ai(F,I);return Z<0?void 0:F[Z][1]}function Ja(I){return Ai(this.__data__,I)>-1}function Xa(I,F){var Z=this.__data__,de=Ai(Z,I);return de<0?(++this.size,Z.push([I,F])):Z[de][1]=F,this}Sr.prototype.clear=Ga,Sr.prototype.delete=Wa,Sr.prototype.get=Ya,Sr.prototype.has=Ja,Sr.prototype.set=Xa;function ei(I){var F=-1,Z=I==null?0:I.length;for(this.clear();++F<Z;){var de=I[F];this.set(de[0],de[1])}}function Qi(){this.size=0,this.__data__={hash:new ht,map:new(gt||Sr),string:new ht}}function Za(I){var F=di(this,I).delete(I);return this.size-=F?1:0,F}function en(I){return di(this,I).get(I)}function Qa(I){return di(this,I).has(I)}function eo(I,F){var Z=di(this,I),de=Z.size;return Z.set(I,F),this.size+=Z.size==de?0:1,this}ei.prototype.clear=Qi,ei.prototype.delete=Za,ei.prototype.get=en,ei.prototype.has=Qa,ei.prototype.set=eo;function tn(I){var F=-1,Z=I==null?0:I.length;for(this.__data__=new ei;++F<Z;)this.add(I[F])}function ys(I){return this.__data__.set(I,s),this}function vs(I){return this.__data__.has(I)}tn.prototype.add=tn.prototype.push=ys,tn.prototype.has=vs;function jr(I){var F=this.__data__=new Sr(I);this.size=F.size}function to(){this.__data__=new Sr,this.size=0}function ro(I){var F=this.__data__,Z=F.delete(I);return this.size=F.size,Z}function io(I){return this.__data__.get(I)}function no(I){return this.__data__.has(I)}function bs(I,F){var Z=this.__data__;if(Z instanceof Sr){var de=Z.__data__;if(!gt||de.length<e-1)return de.push([I,F]),this.size=++Z.size,this;Z=this.__data__=new ei(de)}return Z.set(I,F),this.size=Z.size,this}jr.prototype.clear=to,jr.prototype.delete=ro,jr.prototype.get=io,jr.prototype.has=no,jr.prototype.set=bs;function ms(I,F){var Z=sn(I),de=!Z&&Ts(I),ot=!Z&&!de&&Nn(I),Ne=!Z&&!de&&!ot&&Us(I),lt=Z||de||ot||Ne,Lt=lt?dt(I.length,String):[],Xe=Lt.length;for(var ct in I)(F||Oe.call(I,ct))&&!(lt&&(ct=="length"||ot&&(ct=="offset"||ct=="parent")||Ne&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||Os(ct,Xe)))&&Lt.push(ct);return Lt}function Ai(I,F){for(var Z=I.length;Z--;)if(Ns(I[Z][0],F))return Z;return-1}function Cn(I,F,Z){var de=F(I);return sn(I)?de:Ve(de,Z(I))}function Ni(I){return I==null?I===void 0?K:ie:er&&er in Object(I)?Is(I):oo(I)}function An(I){return Ri(I)&&Ni(I)==f}function Ti(I,F,Z,de,ot){return I===F?!0:I==null||F==null||!Ri(I)&&!Ri(F)?I!==I&&F!==F:ws(I,F,Z,de,Ti,ot)}function ws(I,F,Z,de,ot,Ne){var lt=sn(I),Lt=sn(F),Xe=lt?_:Kr(I),ct=Lt?_:Kr(F);Xe=Xe==f?E:Xe,ct=ct==f?E:ct;var Ct=Xe==E,hr=ct==E,Mt=Xe==ct;if(Mt&&Nn(I)){if(!Nn(F))return!1;lt=!0,Ct=!1}if(Mt&&!Ct)return Ne||(Ne=new jr),lt||Us(I)?rn(I,F,Z,de,ot,Ne):ao(I,F,Xe,Z,de,ot,Ne);if(!(Z&a)){var ft=Ct&&Oe.call(I,"__wrapped__"),tr=hr&&Oe.call(F,"__wrapped__");if(ft||tr){var Lr=ft?I.value():I,Ir=tr?F.value():F;return Ne||(Ne=new jr),ot(Lr,Ir,Z,de,Ne)}}return Mt?(Ne||(Ne=new jr),Ss(I,F,Z,de,ot,Ne)):!1}function so(I){if(!$s(I)||Cs(I))return!1;var F=an(I)?et:ne;return F.test(ti(I))}function Es(I){return Ri(I)&&Rs(I.length)&&!!he[Ni(I)]}function Ds(I){if(!As(I))return Ci(I);var F=[];for(var Z in Object(I))Oe.call(I,Z)&&Z!="constructor"&&F.push(Z);return F}function rn(I,F,Z,de,ot,Ne){var lt=Z&a,Lt=I.length,Xe=F.length;if(Lt!=Xe&&!(lt&&Xe>Lt))return!1;var ct=Ne.get(I);if(ct&&Ne.get(F))return ct==F;var Ct=-1,hr=!0,Mt=Z&c?new tn:void 0;for(Ne.set(I,F),Ne.set(F,I);++Ct<Lt;){var ft=I[Ct],tr=F[Ct];if(de)var Lr=lt?de(tr,ft,Ct,F,I,Ne):de(ft,tr,Ct,I,F,Ne);if(Lr!==void 0){if(Lr)continue;hr=!1;break}if(Mt){if(!je(F,function(Ir,Vr){if(!Me(Mt,Vr)&&(ft===Ir||ot(ft,Ir,Z,de,Ne)))return Mt.push(Vr)})){hr=!1;break}}else if(!(ft===tr||ot(ft,tr,Z,de,Ne))){hr=!1;break}}return Ne.delete(I),Ne.delete(F),hr}function ao(I,F,Z,de,ot,Ne,lt){switch(Z){case ce:if(I.byteLength!=F.byteLength||I.byteOffset!=F.byteOffset)return!1;I=I.buffer,F=F.buffer;case ae:return!(I.byteLength!=F.byteLength||!Ne(new Qt(I),new Qt(F)));case D:case N:case G:return Ns(+I,+F);case P:return I.name==F.name&&I.message==F.message;case S:case u:return I==F+"";case H:var Lt=Re;case y:var Xe=de&a;if(Lt||(Lt=qe),I.size!=F.size&&!Xe)return!1;var ct=lt.get(I);if(ct)return ct==F;de|=c,lt.set(I,F);var Ct=rn(Lt(I),Lt(F),de,ot,Ne,lt);return lt.delete(I),Ct;case v:if(It)return It.call(I)==It.call(F)}return!1}function Ss(I,F,Z,de,ot,Ne){var lt=Z&a,Lt=nn(I),Xe=Lt.length,ct=nn(F),Ct=ct.length;if(Xe!=Ct&&!lt)return!1;for(var hr=Xe;hr--;){var Mt=Lt[hr];if(!(lt?Mt in F:Oe.call(F,Mt)))return!1}var ft=Ne.get(I);if(ft&&Ne.get(F))return ft==F;var tr=!0;Ne.set(I,F),Ne.set(F,I);for(var Lr=lt;++hr<Xe;){Mt=Lt[hr];var Ir=I[Mt],Vr=F[Mt];if(de)var Tn=lt?de(Vr,Ir,Mt,F,I,Ne):de(Ir,Vr,Mt,I,F,Ne);if(!(Tn===void 0?Ir===Vr||ot(Ir,Vr,Z,de,Ne):Tn)){tr=!1;break}Lr||(Lr=Mt=="constructor")}if(tr&&!Lr){var $i=I.constructor,Kt=F.constructor;$i!=Kt&&"constructor"in I&&"constructor"in F&&!(typeof $i=="function"&&$i instanceof $i&&typeof Kt=="function"&&Kt instanceof Kt)&&(tr=!1)}return Ne.delete(I),Ne.delete(F),tr}function nn(I){return Cn(I,ho,xs)}function di(I,F){var Z=I.__data__;return Ps(F)?Z[typeof F=="string"?"string":"hash"]:Z.map}function yr(I,F){var Z=Ie(I,F);return so(Z)?Z:void 0}function Is(I){var F=Oe.call(I,er),Z=I[er];try{I[er]=void 0;var de=!0}catch{}var ot=We.call(I);return de&&(F?I[er]=Z:delete I[er]),ot}var xs=Qr?function(I){return I==null?[]:(I=Object(I),He(Qr(I),function(F){return ur.call(I,F)}))}:at,Kr=Ni;(mt&&Kr(new mt(new ArrayBuffer(1)))!=ce||gt&&Kr(new gt)!=H||wt&&Kr(wt.resolve())!=x||Et&&Kr(new Et)!=y||vt&&Kr(new vt)!=V)&&(Kr=function(I){var F=Ni(I),Z=F==E?I.constructor:void 0,de=Z?ti(Z):"";if(de)switch(de){case Rt:return ce;case $t:return H;case Dt:return x;case Ut:return y;case St:return V}return F});function Os(I,F){return F=F??d,!!F&&(typeof I=="number"||me.test(I))&&I>-1&&I%1==0&&I<F}function Ps(I){var F=typeof I;return F=="string"||F=="number"||F=="symbol"||F=="boolean"?I!=="__proto__":I===null}function Cs(I){return!!ke&&ke in I}function As(I){var F=I&&I.constructor,Z=typeof F=="function"&&F.prototype||De;return I===Z}function oo(I){return We.call(I)}function ti(I){if(I!=null){try{return Be.call(I)}catch{}try{return I+""}catch{}}return""}function Ns(I,F){return I===F||I!==I&&F!==F}var Ts=An(function(){return arguments}())?An:function(I){return Ri(I)&&Oe.call(I,"callee")&&!ur.call(I,"callee")},sn=Array.isArray;function co(I){return I!=null&&Rs(I.length)&&!an(I)}var Nn=fi||st;function uo(I,F){return Ti(I,F)}function an(I){if(!$s(I))return!1;var F=Ni(I);return F==T||F==R||F==g||F==m}function Rs(I){return typeof I=="number"&&I>-1&&I%1==0&&I<=d}function $s(I){var F=typeof I;return I!=null&&(F=="object"||F=="function")}function Ri(I){return I!=null&&typeof I=="object"}var Us=Se?pt(Se):Es;function ho(I){return co(I)?ms(I):Ds(I)}function at(){return[]}function st(){return!1}i.exports=uo})(Ta,Ta.exports);var O6=Ta.exports,P6=kv(O6);function C6(i,t){if(i.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),s=0;s<e.length;s++)e[s]=255;for(var a=0;a<i.length;a++){var c=i.charAt(a),d=c.charCodeAt(0);if(e[d]!==255)throw new TypeError(c+" is ambiguous");e[d]=a}var f=i.length,_=i.charAt(0),g=Math.log(f)/Math.log(256),D=Math.log(256)/Math.log(f);function N(R){if(R instanceof Uint8Array||(ArrayBuffer.isView(R)?R=new Uint8Array(R.buffer,R.byteOffset,R.byteLength):Array.isArray(R)&&(R=Uint8Array.from(R))),!(R instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(R.length===0)return"";for(var H=0,G=0,ie=0,E=R.length;ie!==E&&R[ie]===0;)ie++,H++;for(var x=(E-ie)*D+1>>>0,m=new Uint8Array(x);ie!==E;){for(var S=R[ie],y=0,u=x-1;(S!==0||y<G)&&u!==-1;u--,y++)S+=256*m[u]>>>0,m[u]=S%f>>>0,S=S/f>>>0;if(S!==0)throw new Error("Non-zero carry");G=y,ie++}for(var v=x-G;v!==x&&m[v]===0;)v++;for(var K=_.repeat(H);v<x;++v)K+=i.charAt(m[v]);return K}function P(R){if(typeof R!="string")throw new TypeError("Expected String");if(R.length===0)return new Uint8Array;var H=0;if(R[H]!==" "){for(var G=0,ie=0;R[H]===_;)G++,H++;for(var E=(R.length-H)*g+1>>>0,x=new Uint8Array(E);R[H];){var m=e[R.charCodeAt(H)];if(m===255)return;for(var S=0,y=E-1;(m!==0||S<ie)&&y!==-1;y--,S++)m+=f*x[y]>>>0,x[y]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");ie=S,H++}if(R[H]!==" "){for(var u=E-ie;u!==E&&x[u]===0;)u++;for(var v=new Uint8Array(G+(E-u)),K=G;u!==E;)v[K++]=x[u++];return v}}}function T(R){var H=P(R);if(H)return H;throw new Error(`Non-${t} character`)}return{encode:N,decodeUnsafe:P,decode:T}}var A6=C6,N6=A6;const Gd=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},T6=i=>new TextEncoder().encode(i),R6=i=>new TextDecoder().decode(i);class $6{constructor(t,e,s){this.name=t,this.prefix=e,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class U6{constructor(t,e,s){if(this.name=t,this.prefix=e,e.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Wd(this,t)}}class F6{constructor(t){this.decoders=t}or(t){return Wd(this,t)}decode(t){const e=t[0],s=this.decoders[e];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Wd=(i,t)=>new F6({...i.decoders||{[i.prefix]:i},...t.decoders||{[t.prefix]:t}});class j6{constructor(t,e,s,a){this.name=t,this.prefix=e,this.baseEncode=s,this.baseDecode=a,this.encoder=new $6(t,e,s),this.decoder=new U6(t,e,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Ha=({name:i,prefix:t,encode:e,decode:s})=>new j6(i,t,e,s),_s=({prefix:i,name:t,alphabet:e})=>{const{encode:s,decode:a}=N6(e,t);return Ha({prefix:i,name:t,encode:s,decode:c=>Gd(a(c))})},L6=(i,t,e,s)=>{const a={};for(let D=0;D<t.length;++D)a[t[D]]=D;let c=i.length;for(;i[c-1]==="=";)--c;const d=new Uint8Array(c*e/8|0);let f=0,_=0,g=0;for(let D=0;D<c;++D){const N=a[i[D]];if(N===void 0)throw new SyntaxError(`Non-${s} character`);_=_<<e|N,f+=e,f>=8&&(f-=8,d[g++]=255&_>>f)}if(f>=e||255&_<<8-f)throw new SyntaxError("Unexpected end of data");return d},M6=(i,t,e)=>{const s=t[t.length-1]==="=",a=(1<<e)-1;let c="",d=0,f=0;for(let _=0;_<i.length;++_)for(f=f<<8|i[_],d+=8;d>e;)d-=e,c+=t[a&f>>d];if(d&&(c+=t[a&f<<e-d]),s)for(;c.length*e&7;)c+="=";return c},Yt=({name:i,prefix:t,bitsPerChar:e,alphabet:s})=>Ha({prefix:t,name:i,encode(a){return M6(a,s,e)},decode(a){return L6(a,s,e,i)}}),q6=Ha({prefix:"\0",name:"identity",encode:i=>R6(i),decode:i=>T6(i)});var z6=Object.freeze({__proto__:null,identity:q6});const H6=Yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var B6=Object.freeze({__proto__:null,base2:H6});const K6=Yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var V6=Object.freeze({__proto__:null,base8:K6});const k6=_s({prefix:"9",name:"base10",alphabet:"0123456789"});var G6=Object.freeze({__proto__:null,base10:k6});const W6=Yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Y6=Yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var J6=Object.freeze({__proto__:null,base16:W6,base16upper:Y6});const X6=Yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Z6=Yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Q6=Yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),e2=Yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),t2=Yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),r2=Yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),i2=Yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),n2=Yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),s2=Yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var a2=Object.freeze({__proto__:null,base32:X6,base32upper:Z6,base32pad:Q6,base32padupper:e2,base32hex:t2,base32hexupper:r2,base32hexpad:i2,base32hexpadupper:n2,base32z:s2});const o2=_s({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),c2=_s({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var u2=Object.freeze({__proto__:null,base36:o2,base36upper:c2});const h2=_s({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),l2=_s({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var f2=Object.freeze({__proto__:null,base58btc:h2,base58flickr:l2});const d2=Yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),p2=Yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),g2=Yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),_2=Yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var y2=Object.freeze({__proto__:null,base64:d2,base64pad:p2,base64url:g2,base64urlpad:_2});const Yd=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),v2=Yd.reduce((i,t,e)=>(i[e]=t,i),[]),b2=Yd.reduce((i,t,e)=>(i[t.codePointAt(0)]=e,i),[]);function m2(i){return i.reduce((t,e)=>(t+=v2[e],t),"")}function w2(i){const t=[];for(const e of i){const s=b2[e.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${e}`);t.push(s)}return new Uint8Array(t)}const E2=Ha({prefix:"\u{1F680}",name:"base256emoji",encode:m2,decode:w2});var D2=Object.freeze({__proto__:null,base256emoji:E2}),S2=Jd,wf=128,I2=127,x2=~I2,O2=Math.pow(2,31);function Jd(i,t,e){t=t||[],e=e||0;for(var s=e;i>=O2;)t[e++]=i&255|wf,i/=128;for(;i&x2;)t[e++]=i&255|wf,i>>>=7;return t[e]=i|0,Jd.bytes=e-s+1,t}var P2=su,C2=128,Ef=127;function su(i,s){var e=0,s=s||0,a=0,c=s,d,f=i.length;do{if(c>=f)throw su.bytes=0,new RangeError("Could not decode varint");d=i[c++],e+=a<28?(d&Ef)<<a:(d&Ef)*Math.pow(2,a),a+=7}while(d>=C2);return su.bytes=c-s,e}var A2=Math.pow(2,7),N2=Math.pow(2,14),T2=Math.pow(2,21),R2=Math.pow(2,28),$2=Math.pow(2,35),U2=Math.pow(2,42),F2=Math.pow(2,49),j2=Math.pow(2,56),L2=Math.pow(2,63),M2=function(i){return i<A2?1:i<N2?2:i<T2?3:i<R2?4:i<$2?5:i<U2?6:i<F2?7:i<j2?8:i<L2?9:10},q2={encode:S2,decode:P2,encodingLength:M2},Xd=q2;const Df=(i,t,e=0)=>(Xd.encode(i,t,e),t),Sf=i=>Xd.encodingLength(i),au=(i,t)=>{const e=t.byteLength,s=Sf(i),a=s+Sf(e),c=new Uint8Array(a+e);return Df(i,c,0),Df(e,c,s),c.set(t,a),new z2(i,e,t,c)};class z2{constructor(t,e,s,a){this.code=t,this.size=e,this.digest=s,this.bytes=a}}const Zd=({name:i,code:t,encode:e})=>new H2(i,t,e);class H2{constructor(t,e,s){this.name=t,this.code=e,this.encode=s}digest(t){if(t instanceof Uint8Array){const e=this.encode(t);return e instanceof Uint8Array?au(this.code,e):e.then(s=>au(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Qd=i=>async t=>new Uint8Array(await crypto.subtle.digest(i,t)),B2=Zd({name:"sha2-256",code:18,encode:Qd("SHA-256")}),K2=Zd({name:"sha2-512",code:19,encode:Qd("SHA-512")});var V2=Object.freeze({__proto__:null,sha256:B2,sha512:K2});const ep=0,k2="identity",tp=Gd,G2=i=>au(ep,tp(i)),W2={code:ep,name:k2,encode:tp,digest:G2};var Y2=Object.freeze({__proto__:null,identity:W2});new TextEncoder,new TextDecoder;const If={...z6,...B6,...V6,...G6,...J6,...a2,...u2,...f2,...y2,...D2};({...V2,...Y2});function rp(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function J2(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?rp(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function ip(i,t,e,s){return{name:i,prefix:t,encoder:{name:i,prefix:t,encode:e},decoder:{decode:s}}}const xf=ip("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),xc=ip("ascii","a",i=>{let t="a";for(let e=0;e<i.length;e++)t+=String.fromCharCode(i[e]);return t},i=>{i=i.substring(1);const t=J2(i.length);for(let e=0;e<i.length;e++)t[e]=i.charCodeAt(e);return t}),X2={utf8:xf,"utf-8":xf,hex:If.base16,latin1:xc,ascii:xc,binary:xc,...If};function Z2(i,t="utf8"){const e=X2[t];if(!e)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?rp(globalThis.Buffer.from(i,"utf-8")):e.decoder.decode(`${e.prefix}${i}`)}const np="wc",Q2=2,Cu="core",Ii=`${np}@2:${Cu}:`,eD={name:Cu,logger:"error"},tD={database:":memory:"},rD="crypto",Of="client_ed25519_seed",iD=ve.ONE_DAY,nD="keychain",sD="0.3",aD="messages",oD="0.3",cD=ve.SIX_HOURS,uD="publisher",sp="irn",hD="error",ap="wss://relay.walletconnect.com",lD="relayer",Ot={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},fD="_subscription",ts={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},dD=ve.ONE_SECOND/2,pD="2.8.0",gD=1e4,_D="0.3",yD="WALLETCONNECT_CLIENT_ID",Xr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},vD="subscription",bD="0.3",mD=ve.FIVE_SECONDS*1e3,wD="pairing",ED="0.3",rs={wc_pairingDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:0},res:{ttl:ve.ONE_DAY,prompt:!1,tag:0}}},Jr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},DD="history",SD="0.3",ID="expirer",$r={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},xD="0.3",Oc="verify-api",Pf="https://verify.walletconnect.com";class OD{constructor(t,e){this.core=t,this.logger=e,this.keychain=new Map,this.name=nD,this.version=sD,this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:c}=ue("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Qe.generateChildLogger(e,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,qd(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?zd(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}}class PD{constructor(t,e,s){this.core=t,this.logger=e,this.name=rD,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),c=cf(a);return Rd(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=_3();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const c=await this.getClientSeed(),d=cf(c),f=iu();return await p3(f,a,iD,d)},this.generateSharedKey=(a,c,d)=>{this.isInitialized();const f=this.getPrivateKey(a),_=y3(f,c);return this.setSymKey(_,d)},this.setSymKey=async(a,c)=>{this.isInitialized();const d=c||v3(a);return await this.keychain.set(d,a),d},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,c,d)=>{this.isInitialized();const f=jd(d),_=fu(c);if(hf(f)){const P=f.senderPublicKey,T=f.receiverPublicKey;a=await this.generateSharedKey(P,T)}const g=this.getSymKey(a),{type:D,senderPublicKey:N}=f;return m3({type:D,symKey:g,message:_,senderPublicKey:N})},this.decode=async(a,c,d)=>{this.isInitialized();const f=D3(c,d);if(hf(f)){const D=f.receiverPublicKey,N=f.senderPublicKey;a=await this.generateSharedKey(D,N)}const _=this.getSymKey(a),g=w3({symKey:_,encoded:c});return rd(g)},this.getPayloadType=a=>{const c=Aa(a);return gs(c.type)},this.getPayloadSenderPublicKey=a=>{const c=Aa(a);return c.senderPublicKey?cr(c.senderPublicKey,or):void 0},this.core=t,this.logger=Qe.generateChildLogger(e,this.name),this.keychain=s||new OD(this.core,this.logger)}get context(){return Qe.getLoggerContext(this.logger)}async setPrivateKey(t,e){return await this.keychain.set(t,e),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Of)}catch{t=iu(),await this.keychain.set(Of,t)}return Z2(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}}class CD extends kE{constructor(t,e){super(t,e),this.logger=t,this.core=e,this.messages=new Map,this.name=aD,this.version=oD,this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const c=Dn(a);let d=this.messages.get(s);return typeof d>"u"&&(d={}),typeof d[c]<"u"||(d[c]=a,this.messages.set(s,d),await this.persist()),c},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const c=this.get(s),d=Dn(a);return typeof c[d]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Qe.generateChildLogger(t,this.name),this.core=e}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,qd(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?zd(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}}let AD=class extends GE{constructor(t,e){super(t,e),this.relayer=t,this.logger=e,this.events=new Fr,this.name=uD,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(s,a,c)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:c}});try{const d=c?.ttl||cD,f=nu(c),_=c?.prompt||!1,g=c?.tag||0,D=c?.id||id().toString(),N={topic:s,message:a,opts:{ttl:d,relay:f,prompt:_,tag:g,id:D}};this.queue.set(D,N);try{await await Na(this.rpcPublish(s,a,d,f,_,g,D),this.publishTimeout),this.relayer.events.emit(Ot.publish,N)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(Ot.connection_stalled);return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:c}})}catch(d){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(d),d}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=t,this.logger=Qe.generateChildLogger(e,this.name),this.registerEventListeners()}get context(){return Qe.getLoggerContext(this.logger)}rpcPublish(t,e,s,a,c,d,f){var _,g,D,N;const P={method:Sa(a.protocol).publish,params:{topic:t,message:e,ttl:s,prompt:c,tag:d},id:f};return ar((_=P.params)==null?void 0:_.prompt)&&((g=P.params)==null||delete g.prompt),ar((D=P.params)==null?void 0:D.tag)&&((N=P.params)==null||delete N.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:P}),this.relayer.request(P)}onPublish(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:e,message:s,opts:a}=t;await this.publish(e,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(ps.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()}),this.relayer.on(Ot.message_ack,t=>{this.onPublish(t.id.toString())})}};class ND{constructor(){this.map=new Map,this.set=(t,e)=>{const s=this.get(t);this.exists(t,e)||this.map.set(t,[...s,e])},this.get=t=>this.map.get(t)||[],this.exists=(t,e)=>this.get(t).includes(e),this.delete=(t,e)=>{if(typeof e>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,e))return;const a=s.filter(c=>c!==e);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var TD=Object.defineProperty,RD=Object.defineProperties,$D=Object.getOwnPropertyDescriptors,Cf=Object.getOwnPropertySymbols,UD=Object.prototype.hasOwnProperty,FD=Object.prototype.propertyIsEnumerable,Af=(i,t,e)=>t in i?TD(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,is=(i,t)=>{for(var e in t||(t={}))UD.call(t,e)&&Af(i,e,t[e]);if(Cf)for(var e of Cf(t))FD.call(t,e)&&Af(i,e,t[e]);return i},Pc=(i,t)=>RD(i,$D(t));class jD extends JE{constructor(t,e){super(t,e),this.relayer=t,this.logger=e,this.subscriptions=new Map,this.topicMap=new ND,this.events=new Fr,this.name=vD,this.version=bD,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ii,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const c=nu(a),d={topic:s,relay:c};this.pending.set(s,d);const f=await this.rpcSubscribe(s,c);return this.onSubscribe(f,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),f}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof a?.id<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,c)=>{const d=new ve.Watch;d.start(this.pendingSubscriptionWatchLabel);const f=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(f),d.stop(this.pendingSubscriptionWatchLabel),a(!0)),d.elapsed(this.pendingSubscriptionWatchLabel)>=mD&&(clearInterval(f),d.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Qe.generateChildLogger(e,this.name),this.clientId=""}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,e){let s=!1;try{s=this.getSubscription(t).topic===e}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,e){const s=this.topicMap.get(t);await Promise.all(s.map(async a=>await this.unsubscribeById(t,a,e)))}async unsubscribeById(t,e,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:e,opts:s}});try{const a=nu(s);await this.rpcUnsubscribe(t,e,a);const c=zt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,e,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:e,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,e){const s={method:Sa(e.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Na(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ot.connection_stalled)}return Dn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const e=t[0].relay,s={method:Sa(e.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Na(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ot.connection_stalled)}}rpcUnsubscribe(t,e,s){const a={method:Sa(s.protocol).unsubscribe,params:{topic:t,id:e}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,e){this.setSubscription(t,Pc(is({},e),{id:t})),this.pending.delete(e.topic)}onBatchSubscribe(t){t.length&&t.forEach(e=>{this.setSubscription(e.id,is({},e)),this.pending.delete(e.topic)})}async onUnsubscribe(t,e,s){this.events.removeAllListeners(e),this.hasSubscription(e,t)&&this.deleteSubscription(e,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,e){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:e}),this.addSubscription(t,e))}addSubscription(t,e){this.subscriptions.set(t,is({},e)),this.topicMap.set(e.topic,t),this.events.emit(Xr.created,e)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const e=this.subscriptions.get(t);if(!e){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return e}deleteSubscription(t,e){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:e});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(Xr.deleted,Pc(is({},s),{reason:e}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Xr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let e=0;e<t;e++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Xr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:e}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const e=await this.rpcBatchSubscribe(t);Pn(e)&&this.onBatchSubscribe(e.map((s,a)=>Pc(is({},t[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(e=>{t.push(e)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(ps.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Ot.connect,async()=>{await this.onConnect()}),this.relayer.on(Ot.disconnect,()=>{this.onDisconnect()}),this.events.on(Xr.created,async t=>{const e=Xr.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),await this.persist()}),this.events.on(Xr.deleted,async t=>{const e=Xr.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const e=setInterval(()=>{this.restartInProgress||(clearInterval(e),t())},this.pollingInterval)})}}var LD=Object.defineProperty,Nf=Object.getOwnPropertySymbols,MD=Object.prototype.hasOwnProperty,qD=Object.prototype.propertyIsEnumerable,Tf=(i,t,e)=>t in i?LD(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,zD=(i,t)=>{for(var e in t||(t={}))MD.call(t,e)&&Tf(i,e,t[e]);if(Nf)for(var e of Nf(t))qD.call(t,e)&&Tf(i,e,t[e]);return i};class HD extends WE{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Fr,this.name=lD,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async e=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(e)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Qe.generateChildLogger(t.logger,this.name):Qe.pino(Qe.getDefaultLoggerOptions({level:t.logger||hD})),this.messages=new CD(this.logger,t.core),this.subscriber=new jD(this,this.logger),this.publisher=new AD(this,this.logger),this.relayUrl=t?.relayUrl||ap,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribted to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},gD)}get context(){return Qe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,e,s){this.isInitialized(),await this.publisher.publish(t,e,s),await this.recordMessageEvent({topic:t,message:e,publishedAt:Date.now()})}async subscribe(t,e){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";return a||(await Promise.all([new Promise(c=>{this.subscriber.once(Xr.created,d=>{d.topic===t&&c()})}),new Promise(async c=>{a=await this.subscriber.subscribe(t,e),c()})]),a)}async unsubscribe(t,e){this.isInitialized(),await this.subscriber.unsubscribe(t,e)}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Ot.transport_closed))}async transportOpen(t){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=t||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(e=>{this.initialized||e(),this.subscriber.once(Xr.resubscribed,()=>{e()})}),await Promise.race([new Promise(async(e,s)=>{await Na(this.provider.connect(),5e3,"socket stalled").catch(a=>s(a)).then(()=>e()).finally(()=>this.removeListener(Ot.transport_closed,this.rejectTransportOpen))}),new Promise(e=>this.once(Ot.transport_closed,this.rejectTransportOpen))])])}catch(e){this.logger.error(e);const s=e;if(!this.isConnectionStalled(s.message))throw e;this.events.emit(Ot.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(t){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=t||this.relayUrl,this.connected&&await Promise.all([new Promise(e=>{this.provider.once(ts.disconnect,()=>{e()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(t){return this.staleConnectionErrors.some(e=>t.includes(e))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new xi(new x6($3({sdkVersion:pD,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:e,message:s}=t;await this.messages.set(e,s)}async shouldIgnoreMessageEvent(t){const{topic:e,message:s}=t;return await this.subscriber.isSubscribed(e)?this.messages.has(e,s):!0}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),pu(t)){if(!t.method.endsWith(fD))return;const e=t.params,{topic:s,message:a,publishedAt:c}=e.data,d={topic:s,message:a,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(zD({type:"event",event:e.id},d)),this.events.emit(e.id,d),await this.acknowledgePayload(t),await this.onMessageEvent(d)}else gu(t)&&this.events.emit(Ot.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Ot.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const e=_u(t.id,!0);await this.provider.connection.send(e)}registerProviderListeners(){this.provider.on(ts.payload,t=>this.onProviderPayload(t)),this.provider.on(ts.connect,()=>{this.events.emit(Ot.connect)}),this.provider.on(ts.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(ts.error,t=>{this.logger.error(t),this.events.emit(Ot.error,t)})}registerEventListeners(){this.events.on(Ot.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Ot.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},ve.toMiliseconds(dD))}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(t=>{const e=setInterval(()=>{this.connected&&(clearInterval(e),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var BD=Object.defineProperty,Rf=Object.getOwnPropertySymbols,KD=Object.prototype.hasOwnProperty,VD=Object.prototype.propertyIsEnumerable,$f=(i,t,e)=>t in i?BD(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Uf=(i,t)=>{for(var e in t||(t={}))KD.call(t,e)&&$f(i,e,t[e]);if(Rf)for(var e of Rf(t))VD.call(t,e)&&$f(i,e,t[e]);return i};class Ba extends YE{constructor(t,e,s,a=Ii,c=void 0){super(t,e,s,a),this.core=t,this.logger=e,this.name=s,this.map=new Map,this.version=_D,this.cached=[],this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!ar(d)?this.map.set(this.getKey(d),d):i6(d)?this.map.set(d.id,d):n6(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,f)=>{this.isInitialized(),this.map.has(d)?await this.update(d,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:f}),this.map.set(d,f),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(f=>Object.keys(d).every(_=>P6(f[_],d[_]))):this.values),this.update=async(d,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:f});const _=Uf(Uf({},this.getData(d)),f);this.map.set(d,_),await this.persist()},this.delete=async(d,f)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:f}),this.map.delete(d),await this.persist())},this.logger=Qe.generateChildLogger(e,this.name),this.storagePrefix=a,this.getKey=c}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const e=this.map.get(t);if(!e){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return e}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:e}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}}class kD{constructor(t,e){this.core=t,this.logger=e,this.name=wD,this.version=ED,this.events=new Fr,this.initialized=!1,this.storagePrefix=Ii,this.ignoredPayloadTypes=[Zi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=iu(),a=await this.core.crypto.setSymKey(s),c=Zr(ve.FIVE_MINUTES),d={protocol:sp},f={topic:a,expiry:c,relay:d,active:!1},_=G3({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:d});return await this.pairings.set(a,f),await this.core.relayer.subscribe(a),this.core.expirer.set(a,c),{topic:a,uri:_}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:c,relay:d}=K3(s.uri);if(this.pairings.keys.includes(a))throw new Error(`Pairing already exists: ${a}`);if(this.core.crypto.hasKeys(a))throw new Error(`Keychain already exists: ${a}`);const f=Zr(ve.FIVE_MINUTES),_={topic:a,relay:d,expiry:f,active:!1};return await this.pairings.set(a,_),await this.core.crypto.setSymKey(c,a),await this.core.relayer.subscribe(a,{relay:d}),this.core.expirer.set(a,f),s.activatePairing&&await this.activate({topic:a}),_},this.activate=async({topic:s})=>{this.isInitialized();const a=Zr(ve.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const c=await this.sendRequest(a,"wc_pairingPing",{}),{done:d,resolve:f,reject:_}=En();this.events.once(qt("pairing_ping",c),({error:g})=>{g?_(g):f()}),await d()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",zt("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,c)=>{const d=yu(a,c),f=await this.core.crypto.encode(s,d),_=rs[a].req;return this.core.history.set(s,d),this.core.relayer.publish(s,f,_),d.id},this.sendResult=async(s,a,c)=>{const d=_u(s,c),f=await this.core.crypto.encode(a,d),_=await this.core.history.get(a,s),g=rs[_.request.method].res;await this.core.relayer.publish(a,f,g),await this.core.history.resolve(d)},this.sendError=async(s,a,c)=>{const d=du(s,c),f=await this.core.crypto.encode(a,d),_=await this.core.history.get(a,s),g=rs[_.request.method]?rs[_.request.method].res:rs.unregistered_method.res;await this.core.relayer.publish(a,f,g),await this.core.history.resolve(d)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,zt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Si(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:c}=s,d=c.method;if(this.pairings.keys.includes(a))switch(d){case"wc_pairingPing":return this.onPairingPingRequest(a,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,c);default:return this.onUnknownRpcMethodRequest(a,c)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:c}=s,d=(await this.core.history.get(a,c.id)).request.method;if(this.pairings.keys.includes(a))switch(d){case"wc_pairingPing":return this.onPairingPingResponse(a,c);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(s,a)=>{const{id:c}=a;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit("pairing_ping",{id:c,topic:s})}catch(d){await this.sendError(c,s,d),this.logger.error(d)}},this.onPairingPingResponse=(s,a)=>{const{id:c}=a;setTimeout(()=>{Di(a)?this.events.emit(qt("pairing_ping",c),{}):li(a)&&this.events.emit(qt("pairing_ping",c),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:c}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:c,topic:s})}catch(d){await this.sendError(c,s,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:c,method:d}=a;try{if(this.registeredMethods.includes(d))return;const f=zt("WC_METHOD_UNSUPPORTED",d);await this.sendError(c,s,f),this.logger.error(f)}catch(f){await this.sendError(c,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(zt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!gr(s)){const{message:a}=ue("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(a)}if(!r6(s.uri)){const{message:a}=ue("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(a)}},this.isValidPing=async s=>{if(!gr(s)){const{message:c}=ue("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!gr(s)){const{message:c}=ue("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!kt(s,!1)){const{message:a}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Si(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=ue("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=t,this.logger=Qe.generateChildLogger(e,this.name),this.pairings=new Ba(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Qe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Ot.message,async t=>{const{topic:e,message:s}=t;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(e,s);pu(a)?(this.core.history.set(e,a),this.onRelayEventRequest({topic:e,payload:a})):gu(a)&&(await this.core.history.resolve(a),this.onRelayEventResponse({topic:e,payload:a}))})}registerExpirerEvents(){this.core.expirer.on($r.expired,async t=>{const{topic:e}=Bd(t.target);e&&this.pairings.keys.includes(e)&&(await this.deletePairing(e,!0),this.events.emit("pairing_expire",{topic:e}))})}}class GD extends VE{constructor(t,e){super(t,e),this.core=t,this.logger=e,this.records=new Map,this.events=new Fr,this.name=DD,this.version=SD,this.cached=[],this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:c}),this.records.has(a.id))return;const d={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:c};this.records.set(d.id,d),this.events.emit(Jr.created,d)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=li(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(Jr.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(c=>{if(c.topic===s){if(typeof a<"u"&&c.id!==a)return;this.records.delete(c.id),this.events.emit(Jr.deleted,c)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Qe.generateChildLogger(e,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(e=>{if(typeof e.response<"u")return;const s={topic:e.topic,request:yu(e.request.method,e.request.params,e.id),chainId:e.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const e=this.records.get(t);if(!e){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return e}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Jr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:e}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Jr.created,t=>{const e=Jr.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t}),this.persist()}),this.events.on(Jr.updated,t=>{const e=Jr.updated;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t}),this.persist()}),this.events.on(Jr.deleted,t=>{const e=Jr.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}}class WD extends XE{constructor(t,e){super(t,e),this.core=t,this.logger=e,this.expirations=new Map,this.events=new Fr,this.name=ID,this.version=xD,this.cached=[],this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const c=this.formatTarget(s),d={target:c,expiry:a};this.expirations.set(c,d),this.checkExpiry(c,d),this.events.emit($r.created,{target:c,expiration:d})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),c=this.getExpiration(a);this.expirations.delete(a),this.events.emit($r.deleted,{target:a,expiration:c})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Qe.generateChildLogger(e,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return U3(t);if(typeof t=="number")return F3(t);const{message:e}=ue("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(e)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit($r.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:e}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const e=this.expirations.get(t);if(!e){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return e}checkExpiry(t,e){const{expiry:s}=e;ve.toMiliseconds(s)-Date.now()<=0&&this.expire(t,e)}expire(t,e){this.expirations.delete(t),this.events.emit($r.expired,{target:t,expiration:e})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,e)=>this.checkExpiry(e,t))}registerEventListeners(){this.core.heartbeat.on(ps.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on($r.created,t=>{const e=$r.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()}),this.events.on($r.expired,t=>{const e=$r.expired;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()}),this.events.on($r.deleted,t=>{const e=$r.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}}class YD extends ZE{constructor(t,e){super(t,e),this.projectId=t,this.logger=e,this.name=Oc,this.initialized=!1,this.init=async s=>{Ld()||!xu()||(this.verifyUrl=s?.verifyUrl||Pf,await this.createIframe())},this.register=async s=>{var a;this.initialized||await this.init(),this.iframe&&((a=this.iframe.contentWindow)==null||a.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`))},this.resolve=async s=>{var a;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const c=this.startAbortTimer(ve.FIVE_SECONDS),d=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(c),d.status===200?(a=await d.json())==null?void 0:a.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((s,a)=>{if(document.getElementById(Oc))return s();const c=document.createElement("iframe");c.setAttribute("id",Oc),c.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),c.style.display="none",c.addEventListener("load",()=>{this.initialized=!0,s()}),c.addEventListener("error",d=>{a(d)}),document.body.append(c),this.iframe=c}),new Promise(s=>{setTimeout(()=>s("iframe load timeout"),ve.toMiliseconds(ve.ONE_SECOND/2))})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=Qe.generateChildLogger(e,this.name),this.verifyUrl=Pf,this.abortController=new AbortController,this.isDevEnv=Iu()&&process.env.IS_VITEST}get context(){return Qe.getLoggerContext(this.logger)}startAbortTimer(t){return setTimeout(()=>this.abortController.abort(),ve.toMiliseconds(t))}}var JD=Object.defineProperty,Ff=Object.getOwnPropertySymbols,XD=Object.prototype.hasOwnProperty,ZD=Object.prototype.propertyIsEnumerable,jf=(i,t,e)=>t in i?JD(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Lf=(i,t)=>{for(var e in t||(t={}))XD.call(t,e)&&jf(i,e,t[e]);if(Ff)for(var e of Ff(t))ZD.call(t,e)&&jf(i,e,t[e]);return i};let QD=class op extends KE{constructor(t){super(t),this.protocol=np,this.version=Q2,this.name=Cu,this.events=new Fr,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=t?.projectId,this.relayUrl=t?.relayUrl||ap;const e=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:t?.logger||eD.logger}));this.logger=Qe.generateChildLogger(e,this.name),this.heartbeat=new ps.HeartBeat,this.crypto=new PD(this,this.logger,t?.keychain),this.history=new GD(this,this.logger),this.expirer=new WD(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Ww(Lf(Lf({},tD),t?.storageOptions)),this.relayer=new HD({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new kD(this,this.logger),this.verify=new YD(this.projectId||"",this.logger)}static async init(t){const e=new op(t);await e.initialize();const s=await e.crypto.getClientId();return await e.storage.setItem(yD,s),e}get context(){return Qe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}};const e5=QD,cp="wc",up=2,hp="client",Au=`${cp}@${up}:${hp}:`,Cc={name:hp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},t5="WALLETCONNECT_DEEPLINK_CHOICE",r5="proposal",lp="Proposal expired",i5="session",wa=ve.SEVEN_DAYS,n5="engine",ns={wc_sessionPropose:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1115}}},Ac={min:ve.FIVE_MINUTES,max:ve.SEVEN_DAYS},s5="request",a5=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var o5=Object.defineProperty,c5=Object.defineProperties,u5=Object.getOwnPropertyDescriptors,Mf=Object.getOwnPropertySymbols,h5=Object.prototype.hasOwnProperty,l5=Object.prototype.propertyIsEnumerable,qf=(i,t,e)=>t in i?o5(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Rr=(i,t)=>{for(var e in t||(t={}))h5.call(t,e)&&qf(i,e,t[e]);if(Mf)for(var e of Mf(t))l5.call(t,e)&&qf(i,e,t[e]);return i},Nc=(i,t)=>c5(i,u5(t));class f5 extends e3{constructor(t){super(t),this.name=n5,this.events=new Fr,this.initialized=!1,this.ignoredPayloadTypes=[Zi],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(ns)}),this.initialized=!0)},this.connect=async e=>{this.isInitialized();const s=Nc(Rr({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:c,optionalNamespaces:d,sessionProperties:f,relays:_}=s;let g=a,D,N=!1;if(g&&(N=this.client.core.pairing.pairings.get(g).active),!g||!N){const{topic:x,uri:m}=await this.client.core.pairing.create();g=x,D=m}const P=await this.client.core.crypto.generateKeyPair(),T=Rr({requiredNamespaces:c,optionalNamespaces:d,relays:_??[{protocol:sp}],proposer:{publicKey:P,metadata:this.client.metadata}},f&&{sessionProperties:f}),{reject:R,resolve:H,done:G}=En(ve.FIVE_MINUTES,lp);if(this.events.once(qt("session_connect"),async({error:x,session:m})=>{if(x)R(x);else if(m){m.self.publicKey=P;const S=Nc(Rr({},m),{requiredNamespaces:m.requiredNamespaces,optionalNamespaces:m.optionalNamespaces});await this.client.session.set(m.topic,S),await this.setExpiry(m.topic,m.expiry),g&&await this.client.core.pairing.updateMetadata({topic:g,metadata:m.peer.metadata}),H(S)}}),!g){const{message:x}=ue("NO_MATCHING_KEY",`connect() pairing topic: ${g}`);throw new Error(x)}const ie=await this.sendRequest(g,"wc_sessionPropose",T),E=Zr(ve.FIVE_MINUTES);return await this.setProposal(ie,Rr({id:ie,expiry:E},T)),{uri:D,approval:G}},this.pair=async e=>(this.isInitialized(),await this.client.core.pairing.pair(e)),this.approve=async e=>{this.isInitialized(),await this.isValidApprove(e);const{id:s,relayProtocol:a,namespaces:c,sessionProperties:d}=e,f=this.client.proposal.get(s);let{pairingTopic:_,proposer:g,requiredNamespaces:D,optionalNamespaces:N}=f;_=_||"",Sn(D)||(D=X3(c,"approve()"));const P=await this.client.core.crypto.generateKeyPair(),T=g.publicKey,R=await this.client.core.crypto.generateSharedKey(P,T);_&&s&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:g.metadata}),await this.sendResult(s,_,{relay:{protocol:a??"irn"},responderPublicKey:P}),await this.client.proposal.delete(s,zt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const H=Rr({relay:{protocol:a??"irn"},namespaces:c,requiredNamespaces:D,optionalNamespaces:N,pairingTopic:_,controller:{publicKey:P,metadata:this.client.metadata},expiry:Zr(wa)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(R),await this.sendRequest(R,"wc_sessionSettle",H);const G=Nc(Rr({},H),{topic:R,pairingTopic:_,acknowledged:!1,self:H.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:P});return await this.client.session.set(R,G),await this.setExpiry(R,Zr(wa)),{topic:R,acknowledged:()=>new Promise(ie=>setTimeout(()=>ie(this.client.session.get(R)),500))}},this.reject=async e=>{this.isInitialized(),await this.isValidReject(e);const{id:s,reason:a}=e,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,a),await this.client.proposal.delete(s,zt("USER_DISCONNECTED")))},this.update=async e=>{this.isInitialized(),await this.isValidUpdate(e);const{topic:s,namespaces:a}=e,c=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:a}),{done:d,resolve:f,reject:_}=En();return this.events.once(qt("session_update",c),({error:g})=>{g?_(g):f()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:d}},this.extend=async e=>{this.isInitialized(),await this.isValidExtend(e);const{topic:s}=e,a=await this.sendRequest(s,"wc_sessionExtend",{}),{done:c,resolve:d,reject:f}=En();return this.events.once(qt("session_extend",a),({error:_})=>{_?f(_):d()}),await this.setExpiry(s,Zr(wa)),{acknowledged:c}},this.request=async e=>{this.isInitialized(),await this.isValidRequest(e);const{chainId:s,request:a,topic:c,expiry:d}=e,f=await this.sendRequest(c,"wc_sessionRequest",{request:a,chainId:s},d),{done:_,resolve:g,reject:D}=En(d);this.events.once(qt("session_request",f),({error:P,result:T})=>{P?D(P):g(T)}),this.client.events.emit("session_request_sent",{topic:c,request:a,chainId:s,id:f});const N=await this.client.core.storage.getItem(t5);return j3({id:f,topic:c,wcDeepLink:N}),await _()},this.respond=async e=>{this.isInitialized(),await this.isValidRespond(e);const{topic:s,response:a}=e,{id:c}=a;Di(a)?await this.sendResult(c,s,a.result):li(a)&&await this.sendError(c,s,a.error),this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0})},this.ping=async e=>{this.isInitialized(),await this.isValidPing(e);const{topic:s}=e;if(this.client.session.keys.includes(s)){const a=await this.sendRequest(s,"wc_sessionPing",{}),{done:c,resolve:d,reject:f}=En();this.events.once(qt("session_ping",a),({error:_})=>{_?f(_):d()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async e=>{this.isInitialized(),await this.isValidEmit(e);const{topic:s,event:a,chainId:c}=e;await this.sendRequest(s,"wc_sessionEvent",{event:a,chainId:c})},this.disconnect=async e=>{this.isInitialized(),await this.isValidDisconnect(e);const{topic:s}=e;if(this.client.session.keys.includes(s)){const a=id().toString();let c;const d=f=>{f?.id.toString()===a&&(this.client.core.relayer.events.removeListener(Ot.message_ack,d),c())};await Promise.all([new Promise(f=>{c=f,this.client.core.relayer.on(Ot.message_ack,d)}),this.sendRequest(s,"wc_sessionDelete",zt("USER_DISCONNECTED"),void 0,a)]),await this.deleteSession(s)}else await this.client.core.pairing.disconnect({topic:s})},this.find=e=>(this.isInitialized(),this.client.session.getAll().filter(s=>e6(s,e))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async e=>{try{const s=this.client.core.pairing.pairings.get(e.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(c=>{var d,f;return((d=c.peerMetadata)==null?void 0:d.url)&&((f=c.peerMetadata)==null?void 0:f.url)===e.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(e,s)=>{const{self:a}=this.client.session.get(e);await this.client.core.relayer.unsubscribe(e),this.client.session.delete(e,zt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(e)&&await this.client.core.crypto.deleteSymKey(e),s||this.client.core.expirer.del(e)},this.deleteProposal=async(e,s)=>{await Promise.all([this.client.proposal.delete(e,zt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(e)])},this.deletePendingSessionRequest=async(e,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,s),a?Promise.resolve():this.client.core.expirer.del(e)])},this.setExpiry=async(e,s)=>{this.client.session.keys.includes(e)&&await this.client.session.update(e,{expiry:s}),this.client.core.expirer.set(e,s)},this.setProposal=async(e,s)=>{await this.client.proposal.set(e,s),this.client.core.expirer.set(e,s.expiry)},this.setPendingSessionRequest=async e=>{const s=ns.wc_sessionRequest.req.ttl,{id:a,topic:c,params:d}=e;await this.client.pendingRequest.set(a,{id:a,topic:c,params:d}),s&&this.client.core.expirer.set(a,Zr(s))},this.sendRequest=async(e,s,a,c,d)=>{const f=yu(s,a);if(xu()&&a5.includes(s)){const D=Dn(JSON.stringify(f));await this.client.core.verify.register({attestationId:D})}const _=await this.client.core.crypto.encode(e,f),g=ns[s].req;return c&&(g.ttl=c),d&&(g.id=d),this.client.core.history.set(e,f),this.client.core.relayer.publish(e,_,g),f.id},this.sendResult=async(e,s,a)=>{const c=_u(e,a),d=await this.client.core.crypto.encode(s,c),f=await this.client.core.history.get(s,e),_=ns[f.request.method].res;this.client.core.relayer.publish(s,d,_),await this.client.core.history.resolve(c)},this.sendError=async(e,s,a)=>{const c=du(e,a),d=await this.client.core.crypto.encode(s,c),f=await this.client.core.history.get(s,e),_=ns[f.request.method].res;this.client.core.relayer.publish(s,d,_),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const e=[],s=[];this.client.session.getAll().forEach(a=>{Si(a.expiry)&&e.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Si(a.expiry)&&s.push(a.id)}),await Promise.all([...e.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=e=>{const{topic:s,payload:a}=e,c=a.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async e=>{const{topic:s,payload:a}=e,c=(await this.client.core.history.get(s,a.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=e=>{const{topic:s}=e,{message:a}=ue("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(e,s)=>{const{params:a,id:c}=s;try{this.isValidConnect(Rr({},s.params));const d=Zr(ve.FIVE_MINUTES),f=Rr({id:c,pairingTopic:e,expiry:d},a);await this.setProposal(c,f);const _=Dn(JSON.stringify(s)),g=await this.getVerifyContext(_,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:g})}catch(d){await this.sendError(c,e,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(e,s)=>{const{id:a}=s;if(Di(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const d=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const f=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const _=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const g=await this.client.core.crypto.generateSharedKey(f,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:g});const D=await this.client.core.relayer.subscribe(g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:D}),await this.client.core.pairing.activate({topic:e})}else li(s)&&(await this.client.proposal.delete(a,zt("USER_DISCONNECTED")),this.events.emit(qt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(e,s)=>{const{id:a,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:d,controller:f,expiry:_,namespaces:g,requiredNamespaces:D,optionalNamespaces:N,sessionProperties:P,pairingTopic:T}=s.params,R=Rr({topic:e,relay:d,expiry:_,namespaces:g,acknowledged:!0,pairingTopic:T,requiredNamespaces:D,optionalNamespaces:N,controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},P&&{sessionProperties:P});await this.sendResult(s.id,e,!0),this.events.emit(qt("session_connect"),{session:R}),this.cleanupDuplicatePairings(R)}catch(d){await this.sendError(a,e,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(e,s)=>{const{id:a}=s;Di(s)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(qt("session_approve",a),{})):li(s)&&(await this.client.session.delete(e,zt("USER_DISCONNECTED")),this.events.emit(qt("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(e,s)=>{const{params:a,id:c}=s;try{this.isValidUpdate(Rr({topic:e},a)),await this.client.session.update(e,{namespaces:a.namespaces}),await this.sendResult(c,e,!0),this.client.events.emit("session_update",{id:c,topic:e,params:a})}catch(d){await this.sendError(c,e,d),this.client.logger.error(d)}},this.onSessionUpdateResponse=(e,s)=>{const{id:a}=s;Di(s)?this.events.emit(qt("session_update",a),{}):li(s)&&this.events.emit(qt("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(e,s)=>{const{id:a}=s;try{this.isValidExtend({topic:e}),await this.setExpiry(e,Zr(wa)),await this.sendResult(a,e,!0),this.client.events.emit("session_extend",{id:a,topic:e})}catch(c){await this.sendError(a,e,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(e,s)=>{const{id:a}=s;Di(s)?this.events.emit(qt("session_extend",a),{}):li(s)&&this.events.emit(qt("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(e,s)=>{const{id:a}=s;try{this.isValidPing({topic:e}),await this.sendResult(a,e,!0),this.client.events.emit("session_ping",{id:a,topic:e})}catch(c){await this.sendError(a,e,c),this.client.logger.error(c)}},this.onSessionPingResponse=(e,s)=>{const{id:a}=s;setTimeout(()=>{Di(s)?this.events.emit(qt("session_ping",a),{}):li(s)&&this.events.emit(qt("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(e,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:e,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(Ot.publish,async()=>{c(await this.deleteSession(e))})}),this.sendResult(a,e,!0)]),this.client.events.emit("session_delete",{id:a,topic:e})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(e,s)=>{const{id:a,params:c}=s;try{this.isValidRequest(Rr({topic:e},c)),await this.setPendingSessionRequest({id:a,topic:e,params:c});const d=Dn(JSON.stringify(s)),f=this.client.session.get(e),_=await this.getVerifyContext(d,f.peer.metadata);this.client.events.emit("session_request",{id:a,topic:e,params:c,verifyContext:_})}catch(d){await this.sendError(a,e,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(e,s)=>{const{id:a}=s;Di(s)?this.events.emit(qt("session_request",a),{result:s.result}):li(s)&&this.events.emit(qt("session_request",a),{error:s.error})},this.onSessionEventRequest=async(e,s)=>{const{id:a,params:c}=s;try{this.isValidEmit(Rr({topic:e},c)),this.client.events.emit("session_event",{id:a,topic:e,params:c})}catch(d){await this.sendError(a,e,d),this.client.logger.error(d)}},this.isValidConnect=async e=>{if(!gr(e)){const{message:_}=ue("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw new Error(_)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:c,sessionProperties:d,relays:f}=e;if(ar(s)||await this.isValidPairingTopic(s),!f6(f,!0)){const{message:_}=ue("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(_)}!ar(a)&&Sn(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!ar(c)&&Sn(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),ar(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(e,s)=>{const a=l6(e,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async e=>{if(!gr(e))throw new Error(ue("MISSING_OR_INVALID",`approve() params: ${e}`).message);const{id:s,namespaces:a,relayProtocol:c,sessionProperties:d}=e;await this.isValidProposalId(s);const f=this.client.proposal.get(s),_=xa(a,"approve()");if(_)throw new Error(_.message);const g=vf(f.requiredNamespaces,a,"approve()");if(g)throw new Error(g.message);if(!kt(c,!0)){const{message:D}=ue("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(D)}ar(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async e=>{if(!gr(e)){const{message:c}=ue("MISSING_OR_INVALID",`reject() params: ${e}`);throw new Error(c)}const{id:s,reason:a}=e;if(await this.isValidProposalId(s),!p6(a)){const{message:c}=ue("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(c)}},this.isValidSessionSettleRequest=e=>{if(!gr(e)){const{message:g}=ue("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw new Error(g)}const{relay:s,controller:a,namespaces:c,expiry:d}=e;if(!kd(s)){const{message:g}=ue("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(g)}const f=s6(a,"onSessionSettleRequest()");if(f)throw new Error(f.message);const _=xa(c,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(Si(d)){const{message:g}=ue("EXPIRED","onSessionSettleRequest()");throw new Error(g)}},this.isValidUpdate=async e=>{if(!gr(e)){const{message:_}=ue("MISSING_OR_INVALID",`update() params: ${e}`);throw new Error(_)}const{topic:s,namespaces:a}=e;await this.isValidSessionTopic(s);const c=this.client.session.get(s),d=xa(a,"update()");if(d)throw new Error(d.message);const f=vf(c.requiredNamespaces,a,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async e=>{if(!gr(e)){const{message:a}=ue("MISSING_OR_INVALID",`extend() params: ${e}`);throw new Error(a)}const{topic:s}=e;await this.isValidSessionTopic(s)},this.isValidRequest=async e=>{if(!gr(e)){const{message:_}=ue("MISSING_OR_INVALID",`request() params: ${e}`);throw new Error(_)}const{topic:s,request:a,chainId:c,expiry:d}=e;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!yf(f,c)){const{message:_}=ue("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(_)}if(!g6(a)){const{message:_}=ue("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(_)}if(!v6(f,c,a.method)){const{message:_}=ue("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(_)}if(d&&!E6(d,Ac)){const{message:_}=ue("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${Ac.min} and ${Ac.max}`);throw new Error(_)}},this.isValidRespond=async e=>{if(!gr(e)){const{message:c}=ue("MISSING_OR_INVALID",`respond() params: ${e}`);throw new Error(c)}const{topic:s,response:a}=e;if(await this.isValidSessionTopic(s),!_6(a)){const{message:c}=ue("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(c)}},this.isValidPing=async e=>{if(!gr(e)){const{message:a}=ue("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(a)}const{topic:s}=e;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async e=>{if(!gr(e)){const{message:f}=ue("MISSING_OR_INVALID",`emit() params: ${e}`);throw new Error(f)}const{topic:s,event:a,chainId:c}=e;await this.isValidSessionTopic(s);const{namespaces:d}=this.client.session.get(s);if(!yf(d,c)){const{message:f}=ue("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(f)}if(!y6(a)){const{message:f}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(f)}if(!b6(d,c,a.name)){const{message:f}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(f)}},this.isValidDisconnect=async e=>{if(!gr(e)){const{message:a}=ue("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(a)}const{topic:s}=e;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(e,s)=>{const a={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:e,verifyUrl:s.verifyUrl});c&&(a.verified.origin=c,a.verified.validation=c===s.url?"VALID":"INVALID")}catch(c){this.client.logger.error(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(e,s)=>{Object.values(e).forEach(a=>{if(!kt(a,!1)){const{message:c}=ue("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(c)}})}}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.client.core.relayer.on(Ot.message,async t=>{const{topic:e,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(e,s);pu(a)?(this.client.core.history.set(e,a),this.onRelayEventRequest({topic:e,payload:a})):gu(a)?(await this.client.core.history.resolve(a),this.onRelayEventResponse({topic:e,payload:a})):this.onRelayEventUnknownPayload({topic:e,payload:a})})}registerExpirerEvents(){this.client.core.expirer.on($r.expired,async t=>{const{topic:e,id:s}=Bd(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ue("EXPIRED"),!0);e?this.client.session.keys.includes(e)&&(await this.deleteSession(e,!0),this.client.events.emit("session_expire",{topic:e})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(t){if(!kt(t,!1)){const{message:e}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(e)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:e}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(e)}if(Si(this.client.core.pairing.pairings.get(t).expiry)){const{message:e}=ue("EXPIRED",`pairing topic: ${t}`);throw new Error(e)}}async isValidSessionTopic(t){if(!kt(t,!1)){const{message:e}=ue("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(e)}if(!this.client.session.keys.includes(t)){const{message:e}=ue("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(e)}if(Si(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:e}=ue("EXPIRED",`session topic: ${t}`);throw new Error(e)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(kt(t,!1)){const{message:e}=ue("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(e)}else{const{message:e}=ue("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(e)}}async isValidProposalId(t){if(!d6(t)){const{message:e}=ue("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(e)}if(!this.client.proposal.keys.includes(t)){const{message:e}=ue("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(e)}if(Si(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:e}=ue("EXPIRED",`proposal id: ${t}`);throw new Error(e)}}}class d5 extends Ba{constructor(t,e){super(t,e,r5,Au),this.core=t,this.logger=e}}class p5 extends Ba{constructor(t,e){super(t,e,i5,Au),this.core=t,this.logger=e}}class g5 extends Ba{constructor(t,e){super(t,e,s5,Au,s=>s.id),this.core=t,this.logger=e}}let _5=class fp extends QE{constructor(t){super(t),this.protocol=cp,this.version=up,this.name=Cc.name,this.events=new Fr,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=t?.name||Cc.name,this.metadata=t?.metadata||A3();const e=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:t?.logger||Cc.logger}));this.core=t?.core||new e5(t),this.logger=Qe.generateChildLogger(e,this.name),this.session=new p5(this.core,this.logger),this.proposal=new d5(this.core,this.logger),this.pendingRequest=new g5(this.core,this.logger),this.engine=new f5(this)}static async init(t){const e=new fp(t);return await e.initialize(),e}get context(){return Qe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};const zf="error",y5="wss://relay.walletconnect.com",v5="wc",b5="universal_provider",Hf=`${v5}@2:${b5}:`,m5="https://rpc.walletconnect.com/v1",Pi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ss=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ou={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(i,t){(function(){var e,s="4.17.21",a=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",f="Invalid `variable` option passed into `_.template`",_="__lodash_hash_undefined__",g=500,D="__lodash_placeholder__",N=1,P=2,T=4,R=1,H=2,G=1,ie=2,E=4,x=8,m=16,S=32,y=64,u=128,v=256,K=512,V=30,ae="...",ce=800,ge=16,U=1,z=2,le=3,te=1/0,W=9007199254740991,ee=17976931348623157e292,Y=0/0,re=4294967295,xe=re-1,ne=re>>>1,me=[["ary",u],["bind",G],["bindKey",ie],["curry",x],["curryRight",m],["flip",K],["partial",S],["partialRight",y],["rearg",v]],he="[object Arguments]",ye="[object Array]",q="[object AsyncFunction]",M="[object Boolean]",$="[object Date]",l="[object DOMException]",C="[object Error]",se="[object Function]",fe="[object GeneratorFunction]",Se="[object Map]",He="[object Number]",Ve="[object Null]",je="[object Object]",dt="[object Promise]",pt="[object Proxy]",Me="[object RegExp]",Ie="[object Set]",Re="[object String]",$e="[object Symbol]",qe="[object Undefined]",Pe="[object WeakMap]",Ue="[object WeakSet]",De="[object ArrayBuffer]",Ce="[object DataView]",Be="[object Float32Array]",Oe="[object Float64Array]",ke="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Je="[object Uint8ClampedArray]",Qt="[object Uint16Array]",ur="[object Uint32Array]",Br=/\b__p \+= '';/g,er=/\b(__p \+=) '' \+/g,Qr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,fi=/&(?:amp|lt|gt|quot|#39);/g,Ci=/[&<>"']/g,mt=RegExp(fi.source),gt=RegExp(Ci.source),wt=/<%-([\s\S]+?)%>/g,Et=/<%([\s\S]+?)%>/g,vt=/<%=([\s\S]+?)%>/g,_t=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Rt=/^\w*$/,$t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Dt=/[\\^$.*+?()[\]{}|]/g,Ut=RegExp(Dt.source),St=/^\s+/,Pt=/\s/,It=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,Ft=/,? & /,jt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ka=/[()=,{}\[\]\/\s]/,Va=/\\(\\)?/g,ka=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Sr=/\w*$/,Ga=/^[-+]0x[0-9a-f]+$/i,Wa=/^0b[01]+$/i,Ya=/^\[object .+?Constructor\]$/,Ja=/^0o[0-7]+$/i,Xa=/^(?:0|[1-9]\d*)$/,ei=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Qi=/($^)/,Za=/['\n\r\u2028\u2029\\]/g,en="\\ud800-\\udfff",Qa="\\u0300-\\u036f",eo="\\ufe20-\\ufe2f",tn="\\u20d0-\\u20ff",ys=Qa+eo+tn,vs="\\u2700-\\u27bf",jr="a-z\\xdf-\\xf6\\xf8-\\xff",to="\\xac\\xb1\\xd7\\xf7",ro="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",io="\\u2000-\\u206f",no=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",bs="A-Z\\xc0-\\xd6\\xd8-\\xde",ms="\\ufe0e\\ufe0f",Ai=to+ro+io+no,Cn="['\u2019]",Ni="["+en+"]",An="["+Ai+"]",Ti="["+ys+"]",ws="\\d+",so="["+vs+"]",Es="["+jr+"]",Ds="[^"+en+Ai+ws+vs+jr+bs+"]",rn="\\ud83c[\\udffb-\\udfff]",ao="(?:"+Ti+"|"+rn+")",Ss="[^"+en+"]",nn="(?:\\ud83c[\\udde6-\\uddff]){2}",di="[\\ud800-\\udbff][\\udc00-\\udfff]",yr="["+bs+"]",Is="\\u200d",xs="(?:"+Es+"|"+Ds+")",Kr="(?:"+yr+"|"+Ds+")",Os="(?:"+Cn+"(?:d|ll|m|re|s|t|ve))?",Ps="(?:"+Cn+"(?:D|LL|M|RE|S|T|VE))?",Cs=ao+"?",As="["+ms+"]?",oo="(?:"+Is+"(?:"+[Ss,nn,di].join("|")+")"+As+Cs+")*",ti="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ns="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ts=As+Cs+oo,sn="(?:"+[so,nn,di].join("|")+")"+Ts,co="(?:"+[Ss+Ti+"?",Ti,nn,di,Ni].join("|")+")",Nn=RegExp(Cn,"g"),uo=RegExp(Ti,"g"),an=RegExp(rn+"(?="+rn+")|"+co+Ts,"g"),Rs=RegExp([yr+"?"+Es+"+"+Os+"(?="+[An,yr,"$"].join("|")+")",Kr+"+"+Ps+"(?="+[An,yr+xs,"$"].join("|")+")",yr+"?"+xs+"+"+Os,yr+"+"+Ps,Ns,ti,ws,sn].join("|"),"g"),$s=RegExp("["+Is+en+ys+ms+"]"),Ri=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Us=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ho=-1,at={};at[Be]=at[Oe]=at[ke]=at[We]=at[et]=at[tt]=at[Je]=at[Qt]=at[ur]=!0,at[he]=at[ye]=at[De]=at[M]=at[Ce]=at[$]=at[C]=at[se]=at[Se]=at[He]=at[je]=at[Me]=at[Ie]=at[Re]=at[Pe]=!1;var st={};st[he]=st[ye]=st[De]=st[Ce]=st[M]=st[$]=st[Be]=st[Oe]=st[ke]=st[We]=st[et]=st[Se]=st[He]=st[je]=st[Me]=st[Ie]=st[Re]=st[$e]=st[tt]=st[Je]=st[Qt]=st[ur]=!0,st[C]=st[se]=st[Pe]=!1;var I={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},F={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Z={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},de={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ot=parseFloat,Ne=parseInt,lt=typeof ss=="object"&&ss&&ss.Object===Object&&ss,Lt=typeof self=="object"&&self&&self.Object===Object&&self,Xe=lt||Lt||Function("return this")(),ct=t&&!t.nodeType&&t,Ct=ct&&!0&&i&&!i.nodeType&&i,hr=Ct&&Ct.exports===ct,Mt=hr&&lt.process,ft=function(){try{var j=Ct&&Ct.require&&Ct.require("util").types;return j||Mt&&Mt.binding&&Mt.binding("util")}catch{}}(),tr=ft&&ft.isArrayBuffer,Lr=ft&&ft.isDate,Ir=ft&&ft.isMap,Vr=ft&&ft.isRegExp,Tn=ft&&ft.isSet,$i=ft&&ft.isTypedArray;function Kt(j,k,B){switch(B.length){case 0:return j.call(k);case 1:return j.call(k,B[0]);case 2:return j.call(k,B[0],B[1]);case 3:return j.call(k,B[0],B[1],B[2])}return j.apply(k,B)}function gp(j,k,B,pe){for(var Ae=-1,rt=j==null?0:j.length;++Ae<rt;){var Ht=j[Ae];k(pe,Ht,B(Ht),j)}return pe}function xr(j,k){for(var B=-1,pe=j==null?0:j.length;++B<pe&&k(j[B],B,j)!==!1;);return j}function _p(j,k){for(var B=j==null?0:j.length;B--&&k(j[B],B,j)!==!1;);return j}function Tu(j,k){for(var B=-1,pe=j==null?0:j.length;++B<pe;)if(!k(j[B],B,j))return!1;return!0}function pi(j,k){for(var B=-1,pe=j==null?0:j.length,Ae=0,rt=[];++B<pe;){var Ht=j[B];k(Ht,B,j)&&(rt[Ae++]=Ht)}return rt}function Fs(j,k){var B=j==null?0:j.length;return!!B&&on(j,k,0)>-1}function lo(j,k,B){for(var pe=-1,Ae=j==null?0:j.length;++pe<Ae;)if(B(k,j[pe]))return!0;return!1}function yt(j,k){for(var B=-1,pe=j==null?0:j.length,Ae=Array(pe);++B<pe;)Ae[B]=k(j[B],B,j);return Ae}function gi(j,k){for(var B=-1,pe=k.length,Ae=j.length;++B<pe;)j[Ae+B]=k[B];return j}function fo(j,k,B,pe){var Ae=-1,rt=j==null?0:j.length;for(pe&&rt&&(B=j[++Ae]);++Ae<rt;)B=k(B,j[Ae],Ae,j);return B}function yp(j,k,B,pe){var Ae=j==null?0:j.length;for(pe&&Ae&&(B=j[--Ae]);Ae--;)B=k(B,j[Ae],Ae,j);return B}function po(j,k){for(var B=-1,pe=j==null?0:j.length;++B<pe;)if(k(j[B],B,j))return!0;return!1}var vp=go("length");function bp(j){return j.split("")}function mp(j){return j.match(jt)||[]}function Ru(j,k,B){var pe;return B(j,function(Ae,rt,Ht){if(k(Ae,rt,Ht))return pe=rt,!1}),pe}function js(j,k,B,pe){for(var Ae=j.length,rt=B+(pe?1:-1);pe?rt--:++rt<Ae;)if(k(j[rt],rt,j))return rt;return-1}function on(j,k,B){return k===k?Tp(j,k,B):js(j,$u,B)}function wp(j,k,B,pe){for(var Ae=B-1,rt=j.length;++Ae<rt;)if(pe(j[Ae],k))return Ae;return-1}function $u(j){return j!==j}function Uu(j,k){var B=j==null?0:j.length;return B?yo(j,k)/B:Y}function go(j){return function(k){return k==null?e:k[j]}}function _o(j){return function(k){return j==null?e:j[k]}}function Fu(j,k,B,pe,Ae){return Ae(j,function(rt,Ht,ut){B=pe?(pe=!1,rt):k(B,rt,Ht,ut)}),B}function Ep(j,k){var B=j.length;for(j.sort(k);B--;)j[B]=j[B].value;return j}function yo(j,k){for(var B,pe=-1,Ae=j.length;++pe<Ae;){var rt=k(j[pe]);rt!==e&&(B=B===e?rt:B+rt)}return B}function vo(j,k){for(var B=-1,pe=Array(j);++B<j;)pe[B]=k(B);return pe}function Dp(j,k){return yt(k,function(B){return[B,j[B]]})}function ju(j){return j&&j.slice(0,zu(j)+1).replace(St,"")}function vr(j){return function(k){return j(k)}}function bo(j,k){return yt(k,function(B){return j[B]})}function Rn(j,k){return j.has(k)}function Lu(j,k){for(var B=-1,pe=j.length;++B<pe&&on(k,j[B],0)>-1;);return B}function Mu(j,k){for(var B=j.length;B--&&on(k,j[B],0)>-1;);return B}function Sp(j,k){for(var B=j.length,pe=0;B--;)j[B]===k&&++pe;return pe}var Ip=_o(I),xp=_o(F);function Op(j){return"\\"+de[j]}function Pp(j,k){return j==null?e:j[k]}function cn(j){return $s.test(j)}function Cp(j){return Ri.test(j)}function Ap(j){for(var k,B=[];!(k=j.next()).done;)B.push(k.value);return B}function mo(j){var k=-1,B=Array(j.size);return j.forEach(function(pe,Ae){B[++k]=[Ae,pe]}),B}function qu(j,k){return function(B){return j(k(B))}}function _i(j,k){for(var B=-1,pe=j.length,Ae=0,rt=[];++B<pe;){var Ht=j[B];(Ht===k||Ht===D)&&(j[B]=D,rt[Ae++]=B)}return rt}function Ls(j){var k=-1,B=Array(j.size);return j.forEach(function(pe){B[++k]=pe}),B}function Np(j){var k=-1,B=Array(j.size);return j.forEach(function(pe){B[++k]=[pe,pe]}),B}function Tp(j,k,B){for(var pe=B-1,Ae=j.length;++pe<Ae;)if(j[pe]===k)return pe;return-1}function Rp(j,k,B){for(var pe=B+1;pe--;)if(j[pe]===k)return pe;return pe}function un(j){return cn(j)?Up(j):vp(j)}function Mr(j){return cn(j)?Fp(j):bp(j)}function zu(j){for(var k=j.length;k--&&Pt.test(j.charAt(k)););return k}var $p=_o(Z);function Up(j){for(var k=an.lastIndex=0;an.test(j);)++k;return k}function Fp(j){return j.match(an)||[]}function jp(j){return j.match(Rs)||[]}var Lp=function j(k){k=k==null?Xe:hn.defaults(Xe.Object(),k,hn.pick(Xe,Us));var B=k.Array,pe=k.Date,Ae=k.Error,rt=k.Function,Ht=k.Math,ut=k.Object,wo=k.RegExp,Mp=k.String,Or=k.TypeError,Ms=B.prototype,qp=rt.prototype,ln=ut.prototype,qs=k["__core-js_shared__"],zs=qp.toString,nt=ln.hasOwnProperty,zp=0,Hu=function(){var r=/[^.]+$/.exec(qs&&qs.keys&&qs.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),Hs=ln.toString,Hp=zs.call(ut),Bp=Xe._,Kp=wo("^"+zs.call(nt).replace(Dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bs=hr?k.Buffer:e,yi=k.Symbol,Ks=k.Uint8Array,Bu=Bs?Bs.allocUnsafe:e,Vs=qu(ut.getPrototypeOf,ut),Ku=ut.create,Vu=ln.propertyIsEnumerable,ks=Ms.splice,ku=yi?yi.isConcatSpreadable:e,$n=yi?yi.iterator:e,Ui=yi?yi.toStringTag:e,Gs=function(){try{var r=qi(ut,"defineProperty");return r({},"",{}),r}catch{}}(),Vp=k.clearTimeout!==Xe.clearTimeout&&k.clearTimeout,kp=pe&&pe.now!==Xe.Date.now&&pe.now,Gp=k.setTimeout!==Xe.setTimeout&&k.setTimeout,Ws=Ht.ceil,Ys=Ht.floor,Eo=ut.getOwnPropertySymbols,Wp=Bs?Bs.isBuffer:e,Gu=k.isFinite,Yp=Ms.join,Jp=qu(ut.keys,ut),Bt=Ht.max,Jt=Ht.min,Xp=pe.now,Zp=k.parseInt,Wu=Ht.random,Qp=Ms.reverse,Do=qi(k,"DataView"),Un=qi(k,"Map"),So=qi(k,"Promise"),fn=qi(k,"Set"),Fn=qi(k,"WeakMap"),jn=qi(ut,"create"),Js=Fn&&new Fn,dn={},eg=zi(Do),tg=zi(Un),rg=zi(So),ig=zi(fn),ng=zi(Fn),Xs=yi?yi.prototype:e,Ln=Xs?Xs.valueOf:e,Yu=Xs?Xs.toString:e;function b(r){if(xt(r)&&!Te(r)&&!(r instanceof Ye)){if(r instanceof Pr)return r;if(nt.call(r,"__wrapped__"))return Jh(r)}return new Pr(r)}var pn=function(){function r(){}return function(n){if(!bt(n))return{};if(Ku)return Ku(n);r.prototype=n;var o=new r;return r.prototype=e,o}}();function Zs(){}function Pr(r,n){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=e}b.templateSettings={escape:wt,evaluate:Et,interpolate:vt,variable:"",imports:{_:b}},b.prototype=Zs.prototype,b.prototype.constructor=b,Pr.prototype=pn(Zs.prototype),Pr.prototype.constructor=Pr;function Ye(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function sg(){var r=new Ye(this.__wrapped__);return r.__actions__=lr(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=lr(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=lr(this.__views__),r}function ag(){if(this.__filtered__){var r=new Ye(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function og(){var r=this.__wrapped__.value(),n=this.__dir__,o=Te(r),h=n<0,p=o?r.length:0,w=b0(0,p,this.__views__),O=w.start,A=w.end,L=A-O,J=h?A:O-1,X=this.__iteratees__,Q=X.length,oe=0,_e=Jt(L,this.__takeCount__);if(!o||!h&&p==L&&_e==L)return bh(r,this.__actions__);var we=[];e:for(;L--&&oe<_e;){J+=n;for(var ze=-1,Ee=r[J];++ze<Q;){var Ge=X[ze],Ze=Ge.iteratee,wr=Ge.type,nr=Ze(Ee);if(wr==z)Ee=nr;else if(!nr){if(wr==U)continue e;break e}}we[oe++]=Ee}return we}Ye.prototype=pn(Zs.prototype),Ye.prototype.constructor=Ye;function Fi(r){var n=-1,o=r==null?0:r.length;for(this.clear();++n<o;){var h=r[n];this.set(h[0],h[1])}}function cg(){this.__data__=jn?jn(null):{},this.size=0}function ug(r){var n=this.has(r)&&delete this.__data__[r];return this.size-=n?1:0,n}function hg(r){var n=this.__data__;if(jn){var o=n[r];return o===_?e:o}return nt.call(n,r)?n[r]:e}function lg(r){var n=this.__data__;return jn?n[r]!==e:nt.call(n,r)}function fg(r,n){var o=this.__data__;return this.size+=this.has(r)?0:1,o[r]=jn&&n===e?_:n,this}Fi.prototype.clear=cg,Fi.prototype.delete=ug,Fi.prototype.get=hg,Fi.prototype.has=lg,Fi.prototype.set=fg;function ri(r){var n=-1,o=r==null?0:r.length;for(this.clear();++n<o;){var h=r[n];this.set(h[0],h[1])}}function dg(){this.__data__=[],this.size=0}function pg(r){var n=this.__data__,o=Qs(n,r);if(o<0)return!1;var h=n.length-1;return o==h?n.pop():ks.call(n,o,1),--this.size,!0}function gg(r){var n=this.__data__,o=Qs(n,r);return o<0?e:n[o][1]}function _g(r){return Qs(this.__data__,r)>-1}function yg(r,n){var o=this.__data__,h=Qs(o,r);return h<0?(++this.size,o.push([r,n])):o[h][1]=n,this}ri.prototype.clear=dg,ri.prototype.delete=pg,ri.prototype.get=gg,ri.prototype.has=_g,ri.prototype.set=yg;function ii(r){var n=-1,o=r==null?0:r.length;for(this.clear();++n<o;){var h=r[n];this.set(h[0],h[1])}}function vg(){this.size=0,this.__data__={hash:new Fi,map:new(Un||ri),string:new Fi}}function bg(r){var n=la(this,r).delete(r);return this.size-=n?1:0,n}function mg(r){return la(this,r).get(r)}function wg(r){return la(this,r).has(r)}function Eg(r,n){var o=la(this,r),h=o.size;return o.set(r,n),this.size+=o.size==h?0:1,this}ii.prototype.clear=vg,ii.prototype.delete=bg,ii.prototype.get=mg,ii.prototype.has=wg,ii.prototype.set=Eg;function ji(r){var n=-1,o=r==null?0:r.length;for(this.__data__=new ii;++n<o;)this.add(r[n])}function Dg(r){return this.__data__.set(r,_),this}function Sg(r){return this.__data__.has(r)}ji.prototype.add=ji.prototype.push=Dg,ji.prototype.has=Sg;function qr(r){var n=this.__data__=new ri(r);this.size=n.size}function Ig(){this.__data__=new ri,this.size=0}function xg(r){var n=this.__data__,o=n.delete(r);return this.size=n.size,o}function Og(r){return this.__data__.get(r)}function Pg(r){return this.__data__.has(r)}function Cg(r,n){var o=this.__data__;if(o instanceof ri){var h=o.__data__;if(!Un||h.length<a-1)return h.push([r,n]),this.size=++o.size,this;o=this.__data__=new ii(h)}return o.set(r,n),this.size=o.size,this}qr.prototype.clear=Ig,qr.prototype.delete=xg,qr.prototype.get=Og,qr.prototype.has=Pg,qr.prototype.set=Cg;function Ju(r,n){var o=Te(r),h=!o&&Hi(r),p=!o&&!h&&Ei(r),w=!o&&!h&&!p&&vn(r),O=o||h||p||w,A=O?vo(r.length,Mp):[],L=A.length;for(var J in r)(n||nt.call(r,J))&&!(O&&(J=="length"||p&&(J=="offset"||J=="parent")||w&&(J=="buffer"||J=="byteLength"||J=="byteOffset")||oi(J,L)))&&A.push(J);return A}function Xu(r){var n=r.length;return n?r[Uo(0,n-1)]:e}function Ag(r,n){return fa(lr(r),Li(n,0,r.length))}function Ng(r){return fa(lr(r))}function Io(r,n,o){(o!==e&&!zr(r[n],o)||o===e&&!(n in r))&&ni(r,n,o)}function Mn(r,n,o){var h=r[n];(!(nt.call(r,n)&&zr(h,o))||o===e&&!(n in r))&&ni(r,n,o)}function Qs(r,n){for(var o=r.length;o--;)if(zr(r[o][0],n))return o;return-1}function Tg(r,n,o,h){return vi(r,function(p,w,O){n(h,p,o(p),O)}),h}function Zu(r,n){return r&&Gr(n,Vt(n),r)}function Rg(r,n){return r&&Gr(n,dr(n),r)}function ni(r,n,o){n=="__proto__"&&Gs?Gs(r,n,{configurable:!0,enumerable:!0,value:o,writable:!0}):r[n]=o}function xo(r,n){for(var o=-1,h=n.length,p=B(h),w=r==null;++o<h;)p[o]=w?e:ac(r,n[o]);return p}function Li(r,n,o){return r===r&&(o!==e&&(r=r<=o?r:o),n!==e&&(r=r>=n?r:n)),r}function Cr(r,n,o,h,p,w){var O,A=n&N,L=n&P,J=n&T;if(o&&(O=p?o(r,h,p,w):o(r)),O!==e)return O;if(!bt(r))return r;var X=Te(r);if(X){if(O=w0(r),!A)return lr(r,O)}else{var Q=Xt(r),oe=Q==se||Q==fe;if(Ei(r))return Eh(r,A);if(Q==je||Q==he||oe&&!p){if(O=L||oe?{}:zh(r),!A)return L?h0(r,Rg(O,r)):u0(r,Zu(O,r))}else{if(!st[Q])return p?r:{};O=E0(r,Q,A)}}w||(w=new qr);var _e=w.get(r);if(_e)return _e;w.set(r,O),_l(r)?r.forEach(function(Ee){O.add(Cr(Ee,n,o,Ee,r,w))}):pl(r)&&r.forEach(function(Ee,Ge){O.set(Ge,Cr(Ee,n,o,Ge,r,w))});var we=J?L?ko:Vo:L?dr:Vt,ze=X?e:we(r);return xr(ze||r,function(Ee,Ge){ze&&(Ge=Ee,Ee=r[Ge]),Mn(O,Ge,Cr(Ee,n,o,Ge,r,w))}),O}function $g(r){var n=Vt(r);return function(o){return Qu(o,r,n)}}function Qu(r,n,o){var h=o.length;if(r==null)return!h;for(r=ut(r);h--;){var p=o[h],w=n[p],O=r[p];if(O===e&&!(p in r)||!w(O))return!1}return!0}function eh(r,n,o){if(typeof r!="function")throw new Or(d);return kn(function(){r.apply(e,o)},n)}function qn(r,n,o,h){var p=-1,w=Fs,O=!0,A=r.length,L=[],J=n.length;if(!A)return L;o&&(n=yt(n,vr(o))),h?(w=lo,O=!1):n.length>=a&&(w=Rn,O=!1,n=new ji(n));e:for(;++p<A;){var X=r[p],Q=o==null?X:o(X);if(X=h||X!==0?X:0,O&&Q===Q){for(var oe=J;oe--;)if(n[oe]===Q)continue e;L.push(X)}else w(n,Q,h)||L.push(X)}return L}var vi=Oh(kr),th=Oh(Po,!0);function Ug(r,n){var o=!0;return vi(r,function(h,p,w){return o=!!n(h,p,w),o}),o}function ea(r,n,o){for(var h=-1,p=r.length;++h<p;){var w=r[h],O=n(w);if(O!=null&&(A===e?O===O&&!mr(O):o(O,A)))var A=O,L=w}return L}function Fg(r,n,o,h){var p=r.length;for(o=Le(o),o<0&&(o=-o>p?0:p+o),h=h===e||h>p?p:Le(h),h<0&&(h+=p),h=o>h?0:vl(h);o<h;)r[o++]=n;return r}function rh(r,n){var o=[];return vi(r,function(h,p,w){n(h,p,w)&&o.push(h)}),o}function Gt(r,n,o,h,p){var w=-1,O=r.length;for(o||(o=S0),p||(p=[]);++w<O;){var A=r[w];n>0&&o(A)?n>1?Gt(A,n-1,o,h,p):gi(p,A):h||(p[p.length]=A)}return p}var Oo=Ph(),ih=Ph(!0);function kr(r,n){return r&&Oo(r,n,Vt)}function Po(r,n){return r&&ih(r,n,Vt)}function ta(r,n){return pi(n,function(o){return ci(r[o])})}function Mi(r,n){n=mi(n,r);for(var o=0,h=n.length;r!=null&&o<h;)r=r[Wr(n[o++])];return o&&o==h?r:e}function nh(r,n,o){var h=n(r);return Te(r)?h:gi(h,o(r))}function rr(r){return r==null?r===e?qe:Ve:Ui&&Ui in ut(r)?v0(r):N0(r)}function Co(r,n){return r>n}function jg(r,n){return r!=null&&nt.call(r,n)}function Lg(r,n){return r!=null&&n in ut(r)}function Mg(r,n,o){return r>=Jt(n,o)&&r<Bt(n,o)}function Ao(r,n,o){for(var h=o?lo:Fs,p=r[0].length,w=r.length,O=w,A=B(w),L=1/0,J=[];O--;){var X=r[O];O&&n&&(X=yt(X,vr(n))),L=Jt(X.length,L),A[O]=!o&&(n||p>=120&&X.length>=120)?new ji(O&&X):e}X=r[0];var Q=-1,oe=A[0];e:for(;++Q<p&&J.length<L;){var _e=X[Q],we=n?n(_e):_e;if(_e=o||_e!==0?_e:0,!(oe?Rn(oe,we):h(J,we,o))){for(O=w;--O;){var ze=A[O];if(!(ze?Rn(ze,we):h(r[O],we,o)))continue e}oe&&oe.push(we),J.push(_e)}}return J}function qg(r,n,o,h){return kr(r,function(p,w,O){n(h,o(p),w,O)}),h}function zn(r,n,o){n=mi(n,r),r=Vh(r,n);var h=r==null?r:r[Wr(Nr(n))];return h==null?e:Kt(h,r,o)}function sh(r){return xt(r)&&rr(r)==he}function zg(r){return xt(r)&&rr(r)==De}function Hg(r){return xt(r)&&rr(r)==$}function Hn(r,n,o,h,p){return r===n?!0:r==null||n==null||!xt(r)&&!xt(n)?r!==r&&n!==n:Bg(r,n,o,h,Hn,p)}function Bg(r,n,o,h,p,w){var O=Te(r),A=Te(n),L=O?ye:Xt(r),J=A?ye:Xt(n);L=L==he?je:L,J=J==he?je:J;var X=L==je,Q=J==je,oe=L==J;if(oe&&Ei(r)){if(!Ei(n))return!1;O=!0,X=!1}if(oe&&!X)return w||(w=new qr),O||vn(r)?Lh(r,n,o,h,p,w):_0(r,n,L,o,h,p,w);if(!(o&R)){var _e=X&&nt.call(r,"__wrapped__"),we=Q&&nt.call(n,"__wrapped__");if(_e||we){var ze=_e?r.value():r,Ee=we?n.value():n;return w||(w=new qr),p(ze,Ee,o,h,w)}}return oe?(w||(w=new qr),y0(r,n,o,h,p,w)):!1}function Kg(r){return xt(r)&&Xt(r)==Se}function No(r,n,o,h){var p=o.length,w=p,O=!h;if(r==null)return!w;for(r=ut(r);p--;){var A=o[p];if(O&&A[2]?A[1]!==r[A[0]]:!(A[0]in r))return!1}for(;++p<w;){A=o[p];var L=A[0],J=r[L],X=A[1];if(O&&A[2]){if(J===e&&!(L in r))return!1}else{var Q=new qr;if(h)var oe=h(J,X,L,r,n,Q);if(!(oe===e?Hn(X,J,R|H,h,Q):oe))return!1}}return!0}function ah(r){if(!bt(r)||x0(r))return!1;var n=ci(r)?Kp:Ya;return n.test(zi(r))}function Vg(r){return xt(r)&&rr(r)==Me}function kg(r){return xt(r)&&Xt(r)==Ie}function Gg(r){return xt(r)&&va(r.length)&&!!at[rr(r)]}function oh(r){return typeof r=="function"?r:r==null?pr:typeof r=="object"?Te(r)?hh(r[0],r[1]):uh(r):Cl(r)}function To(r){if(!Vn(r))return Jp(r);var n=[];for(var o in ut(r))nt.call(r,o)&&o!="constructor"&&n.push(o);return n}function Wg(r){if(!bt(r))return A0(r);var n=Vn(r),o=[];for(var h in r)h=="constructor"&&(n||!nt.call(r,h))||o.push(h);return o}function Ro(r,n){return r<n}function ch(r,n){var o=-1,h=fr(r)?B(r.length):[];return vi(r,function(p,w,O){h[++o]=n(p,w,O)}),h}function uh(r){var n=Wo(r);return n.length==1&&n[0][2]?Bh(n[0][0],n[0][1]):function(o){return o===r||No(o,r,n)}}function hh(r,n){return Jo(r)&&Hh(n)?Bh(Wr(r),n):function(o){var h=ac(o,r);return h===e&&h===n?oc(o,r):Hn(n,h,R|H)}}function ra(r,n,o,h,p){r!==n&&Oo(n,function(w,O){if(p||(p=new qr),bt(w))Yg(r,n,O,o,ra,h,p);else{var A=h?h(Zo(r,O),w,O+"",r,n,p):e;A===e&&(A=w),Io(r,O,A)}},dr)}function Yg(r,n,o,h,p,w,O){var A=Zo(r,o),L=Zo(n,o),J=O.get(L);if(J){Io(r,o,J);return}var X=w?w(A,L,o+"",r,n,O):e,Q=X===e;if(Q){var oe=Te(L),_e=!oe&&Ei(L),we=!oe&&!_e&&vn(L);X=L,oe||_e||we?Te(A)?X=A:At(A)?X=lr(A):_e?(Q=!1,X=Eh(L,!0)):we?(Q=!1,X=Dh(L,!0)):X=[]:Gn(L)||Hi(L)?(X=A,Hi(A)?X=bl(A):(!bt(A)||ci(A))&&(X=zh(L))):Q=!1}Q&&(O.set(L,X),p(X,L,h,w,O),O.delete(L)),Io(r,o,X)}function lh(r,n){var o=r.length;if(o)return n+=n<0?o:0,oi(n,o)?r[n]:e}function fh(r,n,o){n.length?n=yt(n,function(w){return Te(w)?function(O){return Mi(O,w.length===1?w[0]:w)}:w}):n=[pr];var h=-1;n=yt(n,vr(be()));var p=ch(r,function(w,O,A){var L=yt(n,function(J){return J(w)});return{criteria:L,index:++h,value:w}});return Ep(p,function(w,O){return c0(w,O,o)})}function Jg(r,n){return dh(r,n,function(o,h){return oc(r,h)})}function dh(r,n,o){for(var h=-1,p=n.length,w={};++h<p;){var O=n[h],A=Mi(r,O);o(A,O)&&Bn(w,mi(O,r),A)}return w}function Xg(r){return function(n){return Mi(n,r)}}function $o(r,n,o,h){var p=h?wp:on,w=-1,O=n.length,A=r;for(r===n&&(n=lr(n)),o&&(A=yt(r,vr(o)));++w<O;)for(var L=0,J=n[w],X=o?o(J):J;(L=p(A,X,L,h))>-1;)A!==r&&ks.call(A,L,1),ks.call(r,L,1);return r}function ph(r,n){for(var o=r?n.length:0,h=o-1;o--;){var p=n[o];if(o==h||p!==w){var w=p;oi(p)?ks.call(r,p,1):Lo(r,p)}}return r}function Uo(r,n){return r+Ys(Wu()*(n-r+1))}function Zg(r,n,o,h){for(var p=-1,w=Bt(Ws((n-r)/(o||1)),0),O=B(w);w--;)O[h?w:++p]=r,r+=o;return O}function Fo(r,n){var o="";if(!r||n<1||n>W)return o;do n%2&&(o+=r),n=Ys(n/2),n&&(r+=r);while(n);return o}function Ke(r,n){return Qo(Kh(r,n,pr),r+"")}function Qg(r){return Xu(bn(r))}function e0(r,n){var o=bn(r);return fa(o,Li(n,0,o.length))}function Bn(r,n,o,h){if(!bt(r))return r;n=mi(n,r);for(var p=-1,w=n.length,O=w-1,A=r;A!=null&&++p<w;){var L=Wr(n[p]),J=o;if(L==="__proto__"||L==="constructor"||L==="prototype")return r;if(p!=O){var X=A[L];J=h?h(X,L,A):e,J===e&&(J=bt(X)?X:oi(n[p+1])?[]:{})}Mn(A,L,J),A=A[L]}return r}var gh=Js?function(r,n){return Js.set(r,n),r}:pr,t0=Gs?function(r,n){return Gs(r,"toString",{configurable:!0,enumerable:!1,value:uc(n),writable:!0})}:pr;function r0(r){return fa(bn(r))}function Ar(r,n,o){var h=-1,p=r.length;n<0&&(n=-n>p?0:p+n),o=o>p?p:o,o<0&&(o+=p),p=n>o?0:o-n>>>0,n>>>=0;for(var w=B(p);++h<p;)w[h]=r[h+n];return w}function i0(r,n){var o;return vi(r,function(h,p,w){return o=n(h,p,w),!o}),!!o}function ia(r,n,o){var h=0,p=r==null?h:r.length;if(typeof n=="number"&&n===n&&p<=ne){for(;h<p;){var w=h+p>>>1,O=r[w];O!==null&&!mr(O)&&(o?O<=n:O<n)?h=w+1:p=w}return p}return jo(r,n,pr,o)}function jo(r,n,o,h){var p=0,w=r==null?0:r.length;if(w===0)return 0;n=o(n);for(var O=n!==n,A=n===null,L=mr(n),J=n===e;p<w;){var X=Ys((p+w)/2),Q=o(r[X]),oe=Q!==e,_e=Q===null,we=Q===Q,ze=mr(Q);if(O)var Ee=h||we;else J?Ee=we&&(h||oe):A?Ee=we&&oe&&(h||!_e):L?Ee=we&&oe&&!_e&&(h||!ze):_e||ze?Ee=!1:Ee=h?Q<=n:Q<n;Ee?p=X+1:w=X}return Jt(w,xe)}function _h(r,n){for(var o=-1,h=r.length,p=0,w=[];++o<h;){var O=r[o],A=n?n(O):O;if(!o||!zr(A,L)){var L=A;w[p++]=O===0?0:O}}return w}function yh(r){return typeof r=="number"?r:mr(r)?Y:+r}function br(r){if(typeof r=="string")return r;if(Te(r))return yt(r,br)+"";if(mr(r))return Yu?Yu.call(r):"";var n=r+"";return n=="0"&&1/r==-te?"-0":n}function bi(r,n,o){var h=-1,p=Fs,w=r.length,O=!0,A=[],L=A;if(o)O=!1,p=lo;else if(w>=a){var J=n?null:p0(r);if(J)return Ls(J);O=!1,p=Rn,L=new ji}else L=n?[]:A;e:for(;++h<w;){var X=r[h],Q=n?n(X):X;if(X=o||X!==0?X:0,O&&Q===Q){for(var oe=L.length;oe--;)if(L[oe]===Q)continue e;n&&L.push(Q),A.push(X)}else p(L,Q,o)||(L!==A&&L.push(Q),A.push(X))}return A}function Lo(r,n){return n=mi(n,r),r=Vh(r,n),r==null||delete r[Wr(Nr(n))]}function vh(r,n,o,h){return Bn(r,n,o(Mi(r,n)),h)}function na(r,n,o,h){for(var p=r.length,w=h?p:-1;(h?w--:++w<p)&&n(r[w],w,r););return o?Ar(r,h?0:w,h?w+1:p):Ar(r,h?w+1:0,h?p:w)}function bh(r,n){var o=r;return o instanceof Ye&&(o=o.value()),fo(n,function(h,p){return p.func.apply(p.thisArg,gi([h],p.args))},o)}function Mo(r,n,o){var h=r.length;if(h<2)return h?bi(r[0]):[];for(var p=-1,w=B(h);++p<h;)for(var O=r[p],A=-1;++A<h;)A!=p&&(w[p]=qn(w[p]||O,r[A],n,o));return bi(Gt(w,1),n,o)}function mh(r,n,o){for(var h=-1,p=r.length,w=n.length,O={};++h<p;){var A=h<w?n[h]:e;o(O,r[h],A)}return O}function qo(r){return At(r)?r:[]}function zo(r){return typeof r=="function"?r:pr}function mi(r,n){return Te(r)?r:Jo(r,n)?[r]:Yh(it(r))}var n0=Ke;function wi(r,n,o){var h=r.length;return o=o===e?h:o,!n&&o>=h?r:Ar(r,n,o)}var wh=Vp||function(r){return Xe.clearTimeout(r)};function Eh(r,n){if(n)return r.slice();var o=r.length,h=Bu?Bu(o):new r.constructor(o);return r.copy(h),h}function Ho(r){var n=new r.constructor(r.byteLength);return new Ks(n).set(new Ks(r)),n}function s0(r,n){var o=n?Ho(r.buffer):r.buffer;return new r.constructor(o,r.byteOffset,r.byteLength)}function a0(r){var n=new r.constructor(r.source,Sr.exec(r));return n.lastIndex=r.lastIndex,n}function o0(r){return Ln?ut(Ln.call(r)):{}}function Dh(r,n){var o=n?Ho(r.buffer):r.buffer;return new r.constructor(o,r.byteOffset,r.length)}function Sh(r,n){if(r!==n){var o=r!==e,h=r===null,p=r===r,w=mr(r),O=n!==e,A=n===null,L=n===n,J=mr(n);if(!A&&!J&&!w&&r>n||w&&O&&L&&!A&&!J||h&&O&&L||!o&&L||!p)return 1;if(!h&&!w&&!J&&r<n||J&&o&&p&&!h&&!w||A&&o&&p||!O&&p||!L)return-1}return 0}function c0(r,n,o){for(var h=-1,p=r.criteria,w=n.criteria,O=p.length,A=o.length;++h<O;){var L=Sh(p[h],w[h]);if(L){if(h>=A)return L;var J=o[h];return L*(J=="desc"?-1:1)}}return r.index-n.index}function Ih(r,n,o,h){for(var p=-1,w=r.length,O=o.length,A=-1,L=n.length,J=Bt(w-O,0),X=B(L+J),Q=!h;++A<L;)X[A]=n[A];for(;++p<O;)(Q||p<w)&&(X[o[p]]=r[p]);for(;J--;)X[A++]=r[p++];return X}function xh(r,n,o,h){for(var p=-1,w=r.length,O=-1,A=o.length,L=-1,J=n.length,X=Bt(w-A,0),Q=B(X+J),oe=!h;++p<X;)Q[p]=r[p];for(var _e=p;++L<J;)Q[_e+L]=n[L];for(;++O<A;)(oe||p<w)&&(Q[_e+o[O]]=r[p++]);return Q}function lr(r,n){var o=-1,h=r.length;for(n||(n=B(h));++o<h;)n[o]=r[o];return n}function Gr(r,n,o,h){var p=!o;o||(o={});for(var w=-1,O=n.length;++w<O;){var A=n[w],L=h?h(o[A],r[A],A,o,r):e;L===e&&(L=r[A]),p?ni(o,A,L):Mn(o,A,L)}return o}function u0(r,n){return Gr(r,Yo(r),n)}function h0(r,n){return Gr(r,Mh(r),n)}function sa(r,n){return function(o,h){var p=Te(o)?gp:Tg,w=n?n():{};return p(o,r,be(h,2),w)}}function gn(r){return Ke(function(n,o){var h=-1,p=o.length,w=p>1?o[p-1]:e,O=p>2?o[2]:e;for(w=r.length>3&&typeof w=="function"?(p--,w):e,O&&ir(o[0],o[1],O)&&(w=p<3?e:w,p=1),n=ut(n);++h<p;){var A=o[h];A&&r(n,A,h,w)}return n})}function Oh(r,n){return function(o,h){if(o==null)return o;if(!fr(o))return r(o,h);for(var p=o.length,w=n?p:-1,O=ut(o);(n?w--:++w<p)&&h(O[w],w,O)!==!1;);return o}}function Ph(r){return function(n,o,h){for(var p=-1,w=ut(n),O=h(n),A=O.length;A--;){var L=O[r?A:++p];if(o(w[L],L,w)===!1)break}return n}}function l0(r,n,o){var h=n&G,p=Kn(r);function w(){var O=this&&this!==Xe&&this instanceof w?p:r;return O.apply(h?o:this,arguments)}return w}function Ch(r){return function(n){n=it(n);var o=cn(n)?Mr(n):e,h=o?o[0]:n.charAt(0),p=o?wi(o,1).join(""):n.slice(1);return h[r]()+p}}function _n(r){return function(n){return fo(Ol(xl(n).replace(Nn,"")),r,"")}}function Kn(r){return function(){var n=arguments;switch(n.length){case 0:return new r;case 1:return new r(n[0]);case 2:return new r(n[0],n[1]);case 3:return new r(n[0],n[1],n[2]);case 4:return new r(n[0],n[1],n[2],n[3]);case 5:return new r(n[0],n[1],n[2],n[3],n[4]);case 6:return new r(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new r(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var o=pn(r.prototype),h=r.apply(o,n);return bt(h)?h:o}}function f0(r,n,o){var h=Kn(r);function p(){for(var w=arguments.length,O=B(w),A=w,L=yn(p);A--;)O[A]=arguments[A];var J=w<3&&O[0]!==L&&O[w-1]!==L?[]:_i(O,L);if(w-=J.length,w<o)return $h(r,n,aa,p.placeholder,e,O,J,e,e,o-w);var X=this&&this!==Xe&&this instanceof p?h:r;return Kt(X,this,O)}return p}function Ah(r){return function(n,o,h){var p=ut(n);if(!fr(n)){var w=be(o,3);n=Vt(n),o=function(A){return w(p[A],A,p)}}var O=r(n,o,h);return O>-1?p[w?n[O]:O]:e}}function Nh(r){return ai(function(n){var o=n.length,h=o,p=Pr.prototype.thru;for(r&&n.reverse();h--;){var w=n[h];if(typeof w!="function")throw new Or(d);if(p&&!O&&ha(w)=="wrapper")var O=new Pr([],!0)}for(h=O?h:o;++h<o;){w=n[h];var A=ha(w),L=A=="wrapper"?Go(w):e;L&&Xo(L[0])&&L[1]==(u|x|S|v)&&!L[4].length&&L[9]==1?O=O[ha(L[0])].apply(O,L[3]):O=w.length==1&&Xo(w)?O[A]():O.thru(w)}return function(){var J=arguments,X=J[0];if(O&&J.length==1&&Te(X))return O.plant(X).value();for(var Q=0,oe=o?n[Q].apply(this,J):X;++Q<o;)oe=n[Q].call(this,oe);return oe}})}function aa(r,n,o,h,p,w,O,A,L,J){var X=n&u,Q=n&G,oe=n&ie,_e=n&(x|m),we=n&K,ze=oe?e:Kn(r);function Ee(){for(var Ge=arguments.length,Ze=B(Ge),wr=Ge;wr--;)Ze[wr]=arguments[wr];if(_e)var nr=yn(Ee),Er=Sp(Ze,nr);if(h&&(Ze=Ih(Ze,h,p,_e)),w&&(Ze=xh(Ze,w,O,_e)),Ge-=Er,_e&&Ge<J){var Nt=_i(Ze,nr);return $h(r,n,aa,Ee.placeholder,o,Ze,Nt,A,L,J-Ge)}var Hr=Q?o:this,hi=oe?Hr[r]:r;return Ge=Ze.length,A?Ze=T0(Ze,A):we&&Ge>1&&Ze.reverse(),X&&L<Ge&&(Ze.length=L),this&&this!==Xe&&this instanceof Ee&&(hi=ze||Kn(hi)),hi.apply(Hr,Ze)}return Ee}function Th(r,n){return function(o,h){return qg(o,r,n(h),{})}}function oa(r,n){return function(o,h){var p;if(o===e&&h===e)return n;if(o!==e&&(p=o),h!==e){if(p===e)return h;typeof o=="string"||typeof h=="string"?(o=br(o),h=br(h)):(o=yh(o),h=yh(h)),p=r(o,h)}return p}}function Bo(r){return ai(function(n){return n=yt(n,vr(be())),Ke(function(o){var h=this;return r(n,function(p){return Kt(p,h,o)})})})}function ca(r,n){n=n===e?" ":br(n);var o=n.length;if(o<2)return o?Fo(n,r):n;var h=Fo(n,Ws(r/un(n)));return cn(n)?wi(Mr(h),0,r).join(""):h.slice(0,r)}function d0(r,n,o,h){var p=n&G,w=Kn(r);function O(){for(var A=-1,L=arguments.length,J=-1,X=h.length,Q=B(X+L),oe=this&&this!==Xe&&this instanceof O?w:r;++J<X;)Q[J]=h[J];for(;L--;)Q[J++]=arguments[++A];return Kt(oe,p?o:this,Q)}return O}function Rh(r){return function(n,o,h){return h&&typeof h!="number"&&ir(n,o,h)&&(o=h=e),n=ui(n),o===e?(o=n,n=0):o=ui(o),h=h===e?n<o?1:-1:ui(h),Zg(n,o,h,r)}}function ua(r){return function(n,o){return typeof n=="string"&&typeof o=="string"||(n=Tr(n),o=Tr(o)),r(n,o)}}function $h(r,n,o,h,p,w,O,A,L,J){var X=n&x,Q=X?O:e,oe=X?e:O,_e=X?w:e,we=X?e:w;n|=X?S:y,n&=~(X?y:S),n&E||(n&=~(G|ie));var ze=[r,n,p,_e,Q,we,oe,A,L,J],Ee=o.apply(e,ze);return Xo(r)&&kh(Ee,ze),Ee.placeholder=h,Gh(Ee,r,n)}function Ko(r){var n=Ht[r];return function(o,h){if(o=Tr(o),h=h==null?0:Jt(Le(h),292),h&&Gu(o)){var p=(it(o)+"e").split("e"),w=n(p[0]+"e"+(+p[1]+h));return p=(it(w)+"e").split("e"),+(p[0]+"e"+(+p[1]-h))}return n(o)}}var p0=fn&&1/Ls(new fn([,-0]))[1]==te?function(r){return new fn(r)}:fc;function Uh(r){return function(n){var o=Xt(n);return o==Se?mo(n):o==Ie?Np(n):Dp(n,r(n))}}function si(r,n,o,h,p,w,O,A){var L=n&ie;if(!L&&typeof r!="function")throw new Or(d);var J=h?h.length:0;if(J||(n&=~(S|y),h=p=e),O=O===e?O:Bt(Le(O),0),A=A===e?A:Le(A),J-=p?p.length:0,n&y){var X=h,Q=p;h=p=e}var oe=L?e:Go(r),_e=[r,n,o,h,p,X,Q,w,O,A];if(oe&&C0(_e,oe),r=_e[0],n=_e[1],o=_e[2],h=_e[3],p=_e[4],A=_e[9]=_e[9]===e?L?0:r.length:Bt(_e[9]-J,0),!A&&n&(x|m)&&(n&=~(x|m)),!n||n==G)var we=l0(r,n,o);else n==x||n==m?we=f0(r,n,A):(n==S||n==(G|S))&&!p.length?we=d0(r,n,o,h):we=aa.apply(e,_e);var ze=oe?gh:kh;return Gh(ze(we,_e),r,n)}function Fh(r,n,o,h){return r===e||zr(r,ln[o])&&!nt.call(h,o)?n:r}function jh(r,n,o,h,p,w){return bt(r)&&bt(n)&&(w.set(n,r),ra(r,n,e,jh,w),w.delete(n)),r}function g0(r){return Gn(r)?e:r}function Lh(r,n,o,h,p,w){var O=o&R,A=r.length,L=n.length;if(A!=L&&!(O&&L>A))return!1;var J=w.get(r),X=w.get(n);if(J&&X)return J==n&&X==r;var Q=-1,oe=!0,_e=o&H?new ji:e;for(w.set(r,n),w.set(n,r);++Q<A;){var we=r[Q],ze=n[Q];if(h)var Ee=O?h(ze,we,Q,n,r,w):h(we,ze,Q,r,n,w);if(Ee!==e){if(Ee)continue;oe=!1;break}if(_e){if(!po(n,function(Ge,Ze){if(!Rn(_e,Ze)&&(we===Ge||p(we,Ge,o,h,w)))return _e.push(Ze)})){oe=!1;break}}else if(!(we===ze||p(we,ze,o,h,w))){oe=!1;break}}return w.delete(r),w.delete(n),oe}function _0(r,n,o,h,p,w,O){switch(o){case Ce:if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case De:return!(r.byteLength!=n.byteLength||!w(new Ks(r),new Ks(n)));case M:case $:case He:return zr(+r,+n);case C:return r.name==n.name&&r.message==n.message;case Me:case Re:return r==n+"";case Se:var A=mo;case Ie:var L=h&R;if(A||(A=Ls),r.size!=n.size&&!L)return!1;var J=O.get(r);if(J)return J==n;h|=H,O.set(r,n);var X=Lh(A(r),A(n),h,p,w,O);return O.delete(r),X;case $e:if(Ln)return Ln.call(r)==Ln.call(n)}return!1}function y0(r,n,o,h,p,w){var O=o&R,A=Vo(r),L=A.length,J=Vo(n),X=J.length;if(L!=X&&!O)return!1;for(var Q=L;Q--;){var oe=A[Q];if(!(O?oe in n:nt.call(n,oe)))return!1}var _e=w.get(r),we=w.get(n);if(_e&&we)return _e==n&&we==r;var ze=!0;w.set(r,n),w.set(n,r);for(var Ee=O;++Q<L;){oe=A[Q];var Ge=r[oe],Ze=n[oe];if(h)var wr=O?h(Ze,Ge,oe,n,r,w):h(Ge,Ze,oe,r,n,w);if(!(wr===e?Ge===Ze||p(Ge,Ze,o,h,w):wr)){ze=!1;break}Ee||(Ee=oe=="constructor")}if(ze&&!Ee){var nr=r.constructor,Er=n.constructor;nr!=Er&&"constructor"in r&&"constructor"in n&&!(typeof nr=="function"&&nr instanceof nr&&typeof Er=="function"&&Er instanceof Er)&&(ze=!1)}return w.delete(r),w.delete(n),ze}function ai(r){return Qo(Kh(r,e,Qh),r+"")}function Vo(r){return nh(r,Vt,Yo)}function ko(r){return nh(r,dr,Mh)}var Go=Js?function(r){return Js.get(r)}:fc;function ha(r){for(var n=r.name+"",o=dn[n],h=nt.call(dn,n)?o.length:0;h--;){var p=o[h],w=p.func;if(w==null||w==r)return p.name}return n}function yn(r){var n=nt.call(b,"placeholder")?b:r;return n.placeholder}function be(){var r=b.iteratee||hc;return r=r===hc?oh:r,arguments.length?r(arguments[0],arguments[1]):r}function la(r,n){var o=r.__data__;return I0(n)?o[typeof n=="string"?"string":"hash"]:o.map}function Wo(r){for(var n=Vt(r),o=n.length;o--;){var h=n[o],p=r[h];n[o]=[h,p,Hh(p)]}return n}function qi(r,n){var o=Pp(r,n);return ah(o)?o:e}function v0(r){var n=nt.call(r,Ui),o=r[Ui];try{r[Ui]=e;var h=!0}catch{}var p=Hs.call(r);return h&&(n?r[Ui]=o:delete r[Ui]),p}var Yo=Eo?function(r){return r==null?[]:(r=ut(r),pi(Eo(r),function(n){return Vu.call(r,n)}))}:dc,Mh=Eo?function(r){for(var n=[];r;)gi(n,Yo(r)),r=Vs(r);return n}:dc,Xt=rr;(Do&&Xt(new Do(new ArrayBuffer(1)))!=Ce||Un&&Xt(new Un)!=Se||So&&Xt(So.resolve())!=dt||fn&&Xt(new fn)!=Ie||Fn&&Xt(new Fn)!=Pe)&&(Xt=function(r){var n=rr(r),o=n==je?r.constructor:e,h=o?zi(o):"";if(h)switch(h){case eg:return Ce;case tg:return Se;case rg:return dt;case ig:return Ie;case ng:return Pe}return n});function b0(r,n,o){for(var h=-1,p=o.length;++h<p;){var w=o[h],O=w.size;switch(w.type){case"drop":r+=O;break;case"dropRight":n-=O;break;case"take":n=Jt(n,r+O);break;case"takeRight":r=Bt(r,n-O);break}}return{start:r,end:n}}function m0(r){var n=r.match(ht);return n?n[1].split(Ft):[]}function qh(r,n,o){n=mi(n,r);for(var h=-1,p=n.length,w=!1;++h<p;){var O=Wr(n[h]);if(!(w=r!=null&&o(r,O)))break;r=r[O]}return w||++h!=p?w:(p=r==null?0:r.length,!!p&&va(p)&&oi(O,p)&&(Te(r)||Hi(r)))}function w0(r){var n=r.length,o=new r.constructor(n);return n&&typeof r[0]=="string"&&nt.call(r,"index")&&(o.index=r.index,o.input=r.input),o}function zh(r){return typeof r.constructor=="function"&&!Vn(r)?pn(Vs(r)):{}}function E0(r,n,o){var h=r.constructor;switch(n){case De:return Ho(r);case M:case $:return new h(+r);case Ce:return s0(r,o);case Be:case Oe:case ke:case We:case et:case tt:case Je:case Qt:case ur:return Dh(r,o);case Se:return new h;case He:case Re:return new h(r);case Me:return a0(r);case Ie:return new h;case $e:return o0(r)}}function D0(r,n){var o=n.length;if(!o)return r;var h=o-1;return n[h]=(o>1?"& ":"")+n[h],n=n.join(o>2?", ":" "),r.replace(It,`{
/* [wrapped with `+n+`] */
`)}function S0(r){return Te(r)||Hi(r)||!!(ku&&r&&r[ku])}function oi(r,n){var o=typeof r;return n=n??W,!!n&&(o=="number"||o!="symbol"&&Xa.test(r))&&r>-1&&r%1==0&&r<n}function ir(r,n,o){if(!bt(o))return!1;var h=typeof n;return(h=="number"?fr(o)&&oi(n,o.length):h=="string"&&n in o)?zr(o[n],r):!1}function Jo(r,n){if(Te(r))return!1;var o=typeof r;return o=="number"||o=="symbol"||o=="boolean"||r==null||mr(r)?!0:Rt.test(r)||!_t.test(r)||n!=null&&r in ut(n)}function I0(r){var n=typeof r;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?r!=="__proto__":r===null}function Xo(r){var n=ha(r),o=b[n];if(typeof o!="function"||!(n in Ye.prototype))return!1;if(r===o)return!0;var h=Go(o);return!!h&&r===h[0]}function x0(r){return!!Hu&&Hu in r}var O0=qs?ci:pc;function Vn(r){var n=r&&r.constructor,o=typeof n=="function"&&n.prototype||ln;return r===o}function Hh(r){return r===r&&!bt(r)}function Bh(r,n){return function(o){return o==null?!1:o[r]===n&&(n!==e||r in ut(o))}}function P0(r){var n=_a(r,function(h){return o.size===g&&o.clear(),h}),o=n.cache;return n}function C0(r,n){var o=r[1],h=n[1],p=o|h,w=p<(G|ie|u),O=h==u&&o==x||h==u&&o==v&&r[7].length<=n[8]||h==(u|v)&&n[7].length<=n[8]&&o==x;if(!(w||O))return r;h&G&&(r[2]=n[2],p|=o&G?0:E);var A=n[3];if(A){var L=r[3];r[3]=L?Ih(L,A,n[4]):A,r[4]=L?_i(r[3],D):n[4]}return A=n[5],A&&(L=r[5],r[5]=L?xh(L,A,n[6]):A,r[6]=L?_i(r[5],D):n[6]),A=n[7],A&&(r[7]=A),h&u&&(r[8]=r[8]==null?n[8]:Jt(r[8],n[8])),r[9]==null&&(r[9]=n[9]),r[0]=n[0],r[1]=p,r}function A0(r){var n=[];if(r!=null)for(var o in ut(r))n.push(o);return n}function N0(r){return Hs.call(r)}function Kh(r,n,o){return n=Bt(n===e?r.length-1:n,0),function(){for(var h=arguments,p=-1,w=Bt(h.length-n,0),O=B(w);++p<w;)O[p]=h[n+p];p=-1;for(var A=B(n+1);++p<n;)A[p]=h[p];return A[n]=o(O),Kt(r,this,A)}}function Vh(r,n){return n.length<2?r:Mi(r,Ar(n,0,-1))}function T0(r,n){for(var o=r.length,h=Jt(n.length,o),p=lr(r);h--;){var w=n[h];r[h]=oi(w,o)?p[w]:e}return r}function Zo(r,n){if(!(n==="constructor"&&typeof r[n]=="function")&&n!="__proto__")return r[n]}var kh=Wh(gh),kn=Gp||function(r,n){return Xe.setTimeout(r,n)},Qo=Wh(t0);function Gh(r,n,o){var h=n+"";return Qo(r,D0(h,R0(m0(h),o)))}function Wh(r){var n=0,o=0;return function(){var h=Xp(),p=ge-(h-o);if(o=h,p>0){if(++n>=ce)return arguments[0]}else n=0;return r.apply(e,arguments)}}function fa(r,n){var o=-1,h=r.length,p=h-1;for(n=n===e?h:n;++o<n;){var w=Uo(o,p),O=r[w];r[w]=r[o],r[o]=O}return r.length=n,r}var Yh=P0(function(r){var n=[];return r.charCodeAt(0)===46&&n.push(""),r.replace($t,function(o,h,p,w){n.push(p?w.replace(Va,"$1"):h||o)}),n});function Wr(r){if(typeof r=="string"||mr(r))return r;var n=r+"";return n=="0"&&1/r==-te?"-0":n}function zi(r){if(r!=null){try{return zs.call(r)}catch{}try{return r+""}catch{}}return""}function R0(r,n){return xr(me,function(o){var h="_."+o[0];n&o[1]&&!Fs(r,h)&&r.push(h)}),r.sort()}function Jh(r){if(r instanceof Ye)return r.clone();var n=new Pr(r.__wrapped__,r.__chain__);return n.__actions__=lr(r.__actions__),n.__index__=r.__index__,n.__values__=r.__values__,n}function $0(r,n,o){(o?ir(r,n,o):n===e)?n=1:n=Bt(Le(n),0);var h=r==null?0:r.length;if(!h||n<1)return[];for(var p=0,w=0,O=B(Ws(h/n));p<h;)O[w++]=Ar(r,p,p+=n);return O}function U0(r){for(var n=-1,o=r==null?0:r.length,h=0,p=[];++n<o;){var w=r[n];w&&(p[h++]=w)}return p}function F0(){var r=arguments.length;if(!r)return[];for(var n=B(r-1),o=arguments[0],h=r;h--;)n[h-1]=arguments[h];return gi(Te(o)?lr(o):[o],Gt(n,1))}var j0=Ke(function(r,n){return At(r)?qn(r,Gt(n,1,At,!0)):[]}),L0=Ke(function(r,n){var o=Nr(n);return At(o)&&(o=e),At(r)?qn(r,Gt(n,1,At,!0),be(o,2)):[]}),M0=Ke(function(r,n){var o=Nr(n);return At(o)&&(o=e),At(r)?qn(r,Gt(n,1,At,!0),e,o):[]});function q0(r,n,o){var h=r==null?0:r.length;return h?(n=o||n===e?1:Le(n),Ar(r,n<0?0:n,h)):[]}function z0(r,n,o){var h=r==null?0:r.length;return h?(n=o||n===e?1:Le(n),n=h-n,Ar(r,0,n<0?0:n)):[]}function H0(r,n){return r&&r.length?na(r,be(n,3),!0,!0):[]}function B0(r,n){return r&&r.length?na(r,be(n,3),!0):[]}function K0(r,n,o,h){var p=r==null?0:r.length;return p?(o&&typeof o!="number"&&ir(r,n,o)&&(o=0,h=p),Fg(r,n,o,h)):[]}function Xh(r,n,o){var h=r==null?0:r.length;if(!h)return-1;var p=o==null?0:Le(o);return p<0&&(p=Bt(h+p,0)),js(r,be(n,3),p)}function Zh(r,n,o){var h=r==null?0:r.length;if(!h)return-1;var p=h-1;return o!==e&&(p=Le(o),p=o<0?Bt(h+p,0):Jt(p,h-1)),js(r,be(n,3),p,!0)}function Qh(r){var n=r==null?0:r.length;return n?Gt(r,1):[]}function V0(r){var n=r==null?0:r.length;return n?Gt(r,te):[]}function k0(r,n){var o=r==null?0:r.length;return o?(n=n===e?1:Le(n),Gt(r,n)):[]}function G0(r){for(var n=-1,o=r==null?0:r.length,h={};++n<o;){var p=r[n];h[p[0]]=p[1]}return h}function el(r){return r&&r.length?r[0]:e}function W0(r,n,o){var h=r==null?0:r.length;if(!h)return-1;var p=o==null?0:Le(o);return p<0&&(p=Bt(h+p,0)),on(r,n,p)}function Y0(r){var n=r==null?0:r.length;return n?Ar(r,0,-1):[]}var J0=Ke(function(r){var n=yt(r,qo);return n.length&&n[0]===r[0]?Ao(n):[]}),X0=Ke(function(r){var n=Nr(r),o=yt(r,qo);return n===Nr(o)?n=e:o.pop(),o.length&&o[0]===r[0]?Ao(o,be(n,2)):[]}),Z0=Ke(function(r){var n=Nr(r),o=yt(r,qo);return n=typeof n=="function"?n:e,n&&o.pop(),o.length&&o[0]===r[0]?Ao(o,e,n):[]});function Q0(r,n){return r==null?"":Yp.call(r,n)}function Nr(r){var n=r==null?0:r.length;return n?r[n-1]:e}function e1(r,n,o){var h=r==null?0:r.length;if(!h)return-1;var p=h;return o!==e&&(p=Le(o),p=p<0?Bt(h+p,0):Jt(p,h-1)),n===n?Rp(r,n,p):js(r,$u,p,!0)}function t1(r,n){return r&&r.length?lh(r,Le(n)):e}var r1=Ke(tl);function tl(r,n){return r&&r.length&&n&&n.length?$o(r,n):r}function i1(r,n,o){return r&&r.length&&n&&n.length?$o(r,n,be(o,2)):r}function n1(r,n,o){return r&&r.length&&n&&n.length?$o(r,n,e,o):r}var s1=ai(function(r,n){var o=r==null?0:r.length,h=xo(r,n);return ph(r,yt(n,function(p){return oi(p,o)?+p:p}).sort(Sh)),h});function a1(r,n){var o=[];if(!(r&&r.length))return o;var h=-1,p=[],w=r.length;for(n=be(n,3);++h<w;){var O=r[h];n(O,h,r)&&(o.push(O),p.push(h))}return ph(r,p),o}function ec(r){return r==null?r:Qp.call(r)}function o1(r,n,o){var h=r==null?0:r.length;return h?(o&&typeof o!="number"&&ir(r,n,o)?(n=0,o=h):(n=n==null?0:Le(n),o=o===e?h:Le(o)),Ar(r,n,o)):[]}function c1(r,n){return ia(r,n)}function u1(r,n,o){return jo(r,n,be(o,2))}function h1(r,n){var o=r==null?0:r.length;if(o){var h=ia(r,n);if(h<o&&zr(r[h],n))return h}return-1}function l1(r,n){return ia(r,n,!0)}function f1(r,n,o){return jo(r,n,be(o,2),!0)}function d1(r,n){var o=r==null?0:r.length;if(o){var h=ia(r,n,!0)-1;if(zr(r[h],n))return h}return-1}function p1(r){return r&&r.length?_h(r):[]}function g1(r,n){return r&&r.length?_h(r,be(n,2)):[]}function _1(r){var n=r==null?0:r.length;return n?Ar(r,1,n):[]}function y1(r,n,o){return r&&r.length?(n=o||n===e?1:Le(n),Ar(r,0,n<0?0:n)):[]}function v1(r,n,o){var h=r==null?0:r.length;return h?(n=o||n===e?1:Le(n),n=h-n,Ar(r,n<0?0:n,h)):[]}function b1(r,n){return r&&r.length?na(r,be(n,3),!1,!0):[]}function m1(r,n){return r&&r.length?na(r,be(n,3)):[]}var w1=Ke(function(r){return bi(Gt(r,1,At,!0))}),E1=Ke(function(r){var n=Nr(r);return At(n)&&(n=e),bi(Gt(r,1,At,!0),be(n,2))}),D1=Ke(function(r){var n=Nr(r);return n=typeof n=="function"?n:e,bi(Gt(r,1,At,!0),e,n)});function S1(r){return r&&r.length?bi(r):[]}function I1(r,n){return r&&r.length?bi(r,be(n,2)):[]}function x1(r,n){return n=typeof n=="function"?n:e,r&&r.length?bi(r,e,n):[]}function tc(r){if(!(r&&r.length))return[];var n=0;return r=pi(r,function(o){if(At(o))return n=Bt(o.length,n),!0}),vo(n,function(o){return yt(r,go(o))})}function rl(r,n){if(!(r&&r.length))return[];var o=tc(r);return n==null?o:yt(o,function(h){return Kt(n,e,h)})}var O1=Ke(function(r,n){return At(r)?qn(r,n):[]}),P1=Ke(function(r){return Mo(pi(r,At))}),C1=Ke(function(r){var n=Nr(r);return At(n)&&(n=e),Mo(pi(r,At),be(n,2))}),A1=Ke(function(r){var n=Nr(r);return n=typeof n=="function"?n:e,Mo(pi(r,At),e,n)}),N1=Ke(tc);function T1(r,n){return mh(r||[],n||[],Mn)}function R1(r,n){return mh(r||[],n||[],Bn)}var $1=Ke(function(r){var n=r.length,o=n>1?r[n-1]:e;return o=typeof o=="function"?(r.pop(),o):e,rl(r,o)});function il(r){var n=b(r);return n.__chain__=!0,n}function U1(r,n){return n(r),r}function da(r,n){return n(r)}var F1=ai(function(r){var n=r.length,o=n?r[0]:0,h=this.__wrapped__,p=function(w){return xo(w,r)};return n>1||this.__actions__.length||!(h instanceof Ye)||!oi(o)?this.thru(p):(h=h.slice(o,+o+(n?1:0)),h.__actions__.push({func:da,args:[p],thisArg:e}),new Pr(h,this.__chain__).thru(function(w){return n&&!w.length&&w.push(e),w}))});function j1(){return il(this)}function L1(){return new Pr(this.value(),this.__chain__)}function M1(){this.__values__===e&&(this.__values__=yl(this.value()));var r=this.__index__>=this.__values__.length,n=r?e:this.__values__[this.__index__++];return{done:r,value:n}}function q1(){return this}function z1(r){for(var n,o=this;o instanceof Zs;){var h=Jh(o);h.__index__=0,h.__values__=e,n?p.__wrapped__=h:n=h;var p=h;o=o.__wrapped__}return p.__wrapped__=r,n}function H1(){var r=this.__wrapped__;if(r instanceof Ye){var n=r;return this.__actions__.length&&(n=new Ye(this)),n=n.reverse(),n.__actions__.push({func:da,args:[ec],thisArg:e}),new Pr(n,this.__chain__)}return this.thru(ec)}function B1(){return bh(this.__wrapped__,this.__actions__)}var K1=sa(function(r,n,o){nt.call(r,o)?++r[o]:ni(r,o,1)});function V1(r,n,o){var h=Te(r)?Tu:Ug;return o&&ir(r,n,o)&&(n=e),h(r,be(n,3))}function k1(r,n){var o=Te(r)?pi:rh;return o(r,be(n,3))}var G1=Ah(Xh),W1=Ah(Zh);function Y1(r,n){return Gt(pa(r,n),1)}function J1(r,n){return Gt(pa(r,n),te)}function X1(r,n,o){return o=o===e?1:Le(o),Gt(pa(r,n),o)}function nl(r,n){var o=Te(r)?xr:vi;return o(r,be(n,3))}function sl(r,n){var o=Te(r)?_p:th;return o(r,be(n,3))}var Z1=sa(function(r,n,o){nt.call(r,o)?r[o].push(n):ni(r,o,[n])});function Q1(r,n,o,h){r=fr(r)?r:bn(r),o=o&&!h?Le(o):0;var p=r.length;return o<0&&(o=Bt(p+o,0)),ba(r)?o<=p&&r.indexOf(n,o)>-1:!!p&&on(r,n,o)>-1}var e_=Ke(function(r,n,o){var h=-1,p=typeof n=="function",w=fr(r)?B(r.length):[];return vi(r,function(O){w[++h]=p?Kt(n,O,o):zn(O,n,o)}),w}),t_=sa(function(r,n,o){ni(r,o,n)});function pa(r,n){var o=Te(r)?yt:ch;return o(r,be(n,3))}function r_(r,n,o,h){return r==null?[]:(Te(n)||(n=n==null?[]:[n]),o=h?e:o,Te(o)||(o=o==null?[]:[o]),fh(r,n,o))}var i_=sa(function(r,n,o){r[o?0:1].push(n)},function(){return[[],[]]});function n_(r,n,o){var h=Te(r)?fo:Fu,p=arguments.length<3;return h(r,be(n,4),o,p,vi)}function s_(r,n,o){var h=Te(r)?yp:Fu,p=arguments.length<3;return h(r,be(n,4),o,p,th)}function a_(r,n){var o=Te(r)?pi:rh;return o(r,ya(be(n,3)))}function o_(r){var n=Te(r)?Xu:Qg;return n(r)}function c_(r,n,o){(o?ir(r,n,o):n===e)?n=1:n=Le(n);var h=Te(r)?Ag:e0;return h(r,n)}function u_(r){var n=Te(r)?Ng:r0;return n(r)}function h_(r){if(r==null)return 0;if(fr(r))return ba(r)?un(r):r.length;var n=Xt(r);return n==Se||n==Ie?r.size:To(r).length}function l_(r,n,o){var h=Te(r)?po:i0;return o&&ir(r,n,o)&&(n=e),h(r,be(n,3))}var f_=Ke(function(r,n){if(r==null)return[];var o=n.length;return o>1&&ir(r,n[0],n[1])?n=[]:o>2&&ir(n[0],n[1],n[2])&&(n=[n[0]]),fh(r,Gt(n,1),[])}),ga=kp||function(){return Xe.Date.now()};function d_(r,n){if(typeof n!="function")throw new Or(d);return r=Le(r),function(){if(--r<1)return n.apply(this,arguments)}}function al(r,n,o){return n=o?e:n,n=r&&n==null?r.length:n,si(r,u,e,e,e,e,n)}function ol(r,n){var o;if(typeof n!="function")throw new Or(d);return r=Le(r),function(){return--r>0&&(o=n.apply(this,arguments)),r<=1&&(n=e),o}}var rc=Ke(function(r,n,o){var h=G;if(o.length){var p=_i(o,yn(rc));h|=S}return si(r,h,n,o,p)}),cl=Ke(function(r,n,o){var h=G|ie;if(o.length){var p=_i(o,yn(cl));h|=S}return si(n,h,r,o,p)});function ul(r,n,o){n=o?e:n;var h=si(r,x,e,e,e,e,e,n);return h.placeholder=ul.placeholder,h}function hl(r,n,o){n=o?e:n;var h=si(r,m,e,e,e,e,e,n);return h.placeholder=hl.placeholder,h}function ll(r,n,o){var h,p,w,O,A,L,J=0,X=!1,Q=!1,oe=!0;if(typeof r!="function")throw new Or(d);n=Tr(n)||0,bt(o)&&(X=!!o.leading,Q="maxWait"in o,w=Q?Bt(Tr(o.maxWait)||0,n):w,oe="trailing"in o?!!o.trailing:oe);function _e(Nt){var Hr=h,hi=p;return h=p=e,J=Nt,O=r.apply(hi,Hr),O}function we(Nt){return J=Nt,A=kn(Ge,n),X?_e(Nt):O}function ze(Nt){var Hr=Nt-L,hi=Nt-J,Al=n-Hr;return Q?Jt(Al,w-hi):Al}function Ee(Nt){var Hr=Nt-L,hi=Nt-J;return L===e||Hr>=n||Hr<0||Q&&hi>=w}function Ge(){var Nt=ga();if(Ee(Nt))return Ze(Nt);A=kn(Ge,ze(Nt))}function Ze(Nt){return A=e,oe&&h?_e(Nt):(h=p=e,O)}function wr(){A!==e&&wh(A),J=0,h=L=p=A=e}function nr(){return A===e?O:Ze(ga())}function Er(){var Nt=ga(),Hr=Ee(Nt);if(h=arguments,p=this,L=Nt,Hr){if(A===e)return we(L);if(Q)return wh(A),A=kn(Ge,n),_e(L)}return A===e&&(A=kn(Ge,n)),O}return Er.cancel=wr,Er.flush=nr,Er}var p_=Ke(function(r,n){return eh(r,1,n)}),g_=Ke(function(r,n,o){return eh(r,Tr(n)||0,o)});function __(r){return si(r,K)}function _a(r,n){if(typeof r!="function"||n!=null&&typeof n!="function")throw new Or(d);var o=function(){var h=arguments,p=n?n.apply(this,h):h[0],w=o.cache;if(w.has(p))return w.get(p);var O=r.apply(this,h);return o.cache=w.set(p,O)||w,O};return o.cache=new(_a.Cache||ii),o}_a.Cache=ii;function ya(r){if(typeof r!="function")throw new Or(d);return function(){var n=arguments;switch(n.length){case 0:return!r.call(this);case 1:return!r.call(this,n[0]);case 2:return!r.call(this,n[0],n[1]);case 3:return!r.call(this,n[0],n[1],n[2])}return!r.apply(this,n)}}function y_(r){return ol(2,r)}var v_=n0(function(r,n){n=n.length==1&&Te(n[0])?yt(n[0],vr(be())):yt(Gt(n,1),vr(be()));var o=n.length;return Ke(function(h){for(var p=-1,w=Jt(h.length,o);++p<w;)h[p]=n[p].call(this,h[p]);return Kt(r,this,h)})}),ic=Ke(function(r,n){var o=_i(n,yn(ic));return si(r,S,e,n,o)}),fl=Ke(function(r,n){var o=_i(n,yn(fl));return si(r,y,e,n,o)}),b_=ai(function(r,n){return si(r,v,e,e,e,n)});function m_(r,n){if(typeof r!="function")throw new Or(d);return n=n===e?n:Le(n),Ke(r,n)}function w_(r,n){if(typeof r!="function")throw new Or(d);return n=n==null?0:Bt(Le(n),0),Ke(function(o){var h=o[n],p=wi(o,0,n);return h&&gi(p,h),Kt(r,this,p)})}function E_(r,n,o){var h=!0,p=!0;if(typeof r!="function")throw new Or(d);return bt(o)&&(h="leading"in o?!!o.leading:h,p="trailing"in o?!!o.trailing:p),ll(r,n,{leading:h,maxWait:n,trailing:p})}function D_(r){return al(r,1)}function S_(r,n){return ic(zo(n),r)}function I_(){if(!arguments.length)return[];var r=arguments[0];return Te(r)?r:[r]}function x_(r){return Cr(r,T)}function O_(r,n){return n=typeof n=="function"?n:e,Cr(r,T,n)}function P_(r){return Cr(r,N|T)}function C_(r,n){return n=typeof n=="function"?n:e,Cr(r,N|T,n)}function A_(r,n){return n==null||Qu(r,n,Vt(n))}function zr(r,n){return r===n||r!==r&&n!==n}var N_=ua(Co),T_=ua(function(r,n){return r>=n}),Hi=sh(function(){return arguments}())?sh:function(r){return xt(r)&&nt.call(r,"callee")&&!Vu.call(r,"callee")},Te=B.isArray,R_=tr?vr(tr):zg;function fr(r){return r!=null&&va(r.length)&&!ci(r)}function At(r){return xt(r)&&fr(r)}function $_(r){return r===!0||r===!1||xt(r)&&rr(r)==M}var Ei=Wp||pc,U_=Lr?vr(Lr):Hg;function F_(r){return xt(r)&&r.nodeType===1&&!Gn(r)}function j_(r){if(r==null)return!0;if(fr(r)&&(Te(r)||typeof r=="string"||typeof r.splice=="function"||Ei(r)||vn(r)||Hi(r)))return!r.length;var n=Xt(r);if(n==Se||n==Ie)return!r.size;if(Vn(r))return!To(r).length;for(var o in r)if(nt.call(r,o))return!1;return!0}function L_(r,n){return Hn(r,n)}function M_(r,n,o){o=typeof o=="function"?o:e;var h=o?o(r,n):e;return h===e?Hn(r,n,e,o):!!h}function nc(r){if(!xt(r))return!1;var n=rr(r);return n==C||n==l||typeof r.message=="string"&&typeof r.name=="string"&&!Gn(r)}function q_(r){return typeof r=="number"&&Gu(r)}function ci(r){if(!bt(r))return!1;var n=rr(r);return n==se||n==fe||n==q||n==pt}function dl(r){return typeof r=="number"&&r==Le(r)}function va(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=W}function bt(r){var n=typeof r;return r!=null&&(n=="object"||n=="function")}function xt(r){return r!=null&&typeof r=="object"}var pl=Ir?vr(Ir):Kg;function z_(r,n){return r===n||No(r,n,Wo(n))}function H_(r,n,o){return o=typeof o=="function"?o:e,No(r,n,Wo(n),o)}function B_(r){return gl(r)&&r!=+r}function K_(r){if(O0(r))throw new Ae(c);return ah(r)}function V_(r){return r===null}function k_(r){return r==null}function gl(r){return typeof r=="number"||xt(r)&&rr(r)==He}function Gn(r){if(!xt(r)||rr(r)!=je)return!1;var n=Vs(r);if(n===null)return!0;var o=nt.call(n,"constructor")&&n.constructor;return typeof o=="function"&&o instanceof o&&zs.call(o)==Hp}var sc=Vr?vr(Vr):Vg;function G_(r){return dl(r)&&r>=-W&&r<=W}var _l=Tn?vr(Tn):kg;function ba(r){return typeof r=="string"||!Te(r)&&xt(r)&&rr(r)==Re}function mr(r){return typeof r=="symbol"||xt(r)&&rr(r)==$e}var vn=$i?vr($i):Gg;function W_(r){return r===e}function Y_(r){return xt(r)&&Xt(r)==Pe}function J_(r){return xt(r)&&rr(r)==Ue}var X_=ua(Ro),Z_=ua(function(r,n){return r<=n});function yl(r){if(!r)return[];if(fr(r))return ba(r)?Mr(r):lr(r);if($n&&r[$n])return Ap(r[$n]());var n=Xt(r),o=n==Se?mo:n==Ie?Ls:bn;return o(r)}function ui(r){if(!r)return r===0?r:0;if(r=Tr(r),r===te||r===-te){var n=r<0?-1:1;return n*ee}return r===r?r:0}function Le(r){var n=ui(r),o=n%1;return n===n?o?n-o:n:0}function vl(r){return r?Li(Le(r),0,re):0}function Tr(r){if(typeof r=="number")return r;if(mr(r))return Y;if(bt(r)){var n=typeof r.valueOf=="function"?r.valueOf():r;r=bt(n)?n+"":n}if(typeof r!="string")return r===0?r:+r;r=ju(r);var o=Wa.test(r);return o||Ja.test(r)?Ne(r.slice(2),o?2:8):Ga.test(r)?Y:+r}function bl(r){return Gr(r,dr(r))}function Q_(r){return r?Li(Le(r),-W,W):r===0?r:0}function it(r){return r==null?"":br(r)}var ey=gn(function(r,n){if(Vn(n)||fr(n)){Gr(n,Vt(n),r);return}for(var o in n)nt.call(n,o)&&Mn(r,o,n[o])}),ml=gn(function(r,n){Gr(n,dr(n),r)}),ma=gn(function(r,n,o,h){Gr(n,dr(n),r,h)}),ty=gn(function(r,n,o,h){Gr(n,Vt(n),r,h)}),ry=ai(xo);function iy(r,n){var o=pn(r);return n==null?o:Zu(o,n)}var ny=Ke(function(r,n){r=ut(r);var o=-1,h=n.length,p=h>2?n[2]:e;for(p&&ir(n[0],n[1],p)&&(h=1);++o<h;)for(var w=n[o],O=dr(w),A=-1,L=O.length;++A<L;){var J=O[A],X=r[J];(X===e||zr(X,ln[J])&&!nt.call(r,J))&&(r[J]=w[J])}return r}),sy=Ke(function(r){return r.push(e,jh),Kt(wl,e,r)});function ay(r,n){return Ru(r,be(n,3),kr)}function oy(r,n){return Ru(r,be(n,3),Po)}function cy(r,n){return r==null?r:Oo(r,be(n,3),dr)}function uy(r,n){return r==null?r:ih(r,be(n,3),dr)}function hy(r,n){return r&&kr(r,be(n,3))}function ly(r,n){return r&&Po(r,be(n,3))}function fy(r){return r==null?[]:ta(r,Vt(r))}function dy(r){return r==null?[]:ta(r,dr(r))}function ac(r,n,o){var h=r==null?e:Mi(r,n);return h===e?o:h}function py(r,n){return r!=null&&qh(r,n,jg)}function oc(r,n){return r!=null&&qh(r,n,Lg)}var gy=Th(function(r,n,o){n!=null&&typeof n.toString!="function"&&(n=Hs.call(n)),r[n]=o},uc(pr)),_y=Th(function(r,n,o){n!=null&&typeof n.toString!="function"&&(n=Hs.call(n)),nt.call(r,n)?r[n].push(o):r[n]=[o]},be),yy=Ke(zn);function Vt(r){return fr(r)?Ju(r):To(r)}function dr(r){return fr(r)?Ju(r,!0):Wg(r)}function vy(r,n){var o={};return n=be(n,3),kr(r,function(h,p,w){ni(o,n(h,p,w),h)}),o}function by(r,n){var o={};return n=be(n,3),kr(r,function(h,p,w){ni(o,p,n(h,p,w))}),o}var my=gn(function(r,n,o){ra(r,n,o)}),wl=gn(function(r,n,o,h){ra(r,n,o,h)}),wy=ai(function(r,n){var o={};if(r==null)return o;var h=!1;n=yt(n,function(w){return w=mi(w,r),h||(h=w.length>1),w}),Gr(r,ko(r),o),h&&(o=Cr(o,N|P|T,g0));for(var p=n.length;p--;)Lo(o,n[p]);return o});function Ey(r,n){return El(r,ya(be(n)))}var Dy=ai(function(r,n){return r==null?{}:Jg(r,n)});function El(r,n){if(r==null)return{};var o=yt(ko(r),function(h){return[h]});return n=be(n),dh(r,o,function(h,p){return n(h,p[0])})}function Sy(r,n,o){n=mi(n,r);var h=-1,p=n.length;for(p||(p=1,r=e);++h<p;){var w=r==null?e:r[Wr(n[h])];w===e&&(h=p,w=o),r=ci(w)?w.call(r):w}return r}function Iy(r,n,o){return r==null?r:Bn(r,n,o)}function xy(r,n,o,h){return h=typeof h=="function"?h:e,r==null?r:Bn(r,n,o,h)}var Dl=Uh(Vt),Sl=Uh(dr);function Oy(r,n,o){var h=Te(r),p=h||Ei(r)||vn(r);if(n=be(n,4),o==null){var w=r&&r.constructor;p?o=h?new w:[]:bt(r)?o=ci(w)?pn(Vs(r)):{}:o={}}return(p?xr:kr)(r,function(O,A,L){return n(o,O,A,L)}),o}function Py(r,n){return r==null?!0:Lo(r,n)}function Cy(r,n,o){return r==null?r:vh(r,n,zo(o))}function Ay(r,n,o,h){return h=typeof h=="function"?h:e,r==null?r:vh(r,n,zo(o),h)}function bn(r){return r==null?[]:bo(r,Vt(r))}function Ny(r){return r==null?[]:bo(r,dr(r))}function Ty(r,n,o){return o===e&&(o=n,n=e),o!==e&&(o=Tr(o),o=o===o?o:0),n!==e&&(n=Tr(n),n=n===n?n:0),Li(Tr(r),n,o)}function Ry(r,n,o){return n=ui(n),o===e?(o=n,n=0):o=ui(o),r=Tr(r),Mg(r,n,o)}function $y(r,n,o){if(o&&typeof o!="boolean"&&ir(r,n,o)&&(n=o=e),o===e&&(typeof n=="boolean"?(o=n,n=e):typeof r=="boolean"&&(o=r,r=e)),r===e&&n===e?(r=0,n=1):(r=ui(r),n===e?(n=r,r=0):n=ui(n)),r>n){var h=r;r=n,n=h}if(o||r%1||n%1){var p=Wu();return Jt(r+p*(n-r+ot("1e-"+((p+"").length-1))),n)}return Uo(r,n)}var Uy=_n(function(r,n,o){return n=n.toLowerCase(),r+(o?Il(n):n)});function Il(r){return cc(it(r).toLowerCase())}function xl(r){return r=it(r),r&&r.replace(ei,Ip).replace(uo,"")}function Fy(r,n,o){r=it(r),n=br(n);var h=r.length;o=o===e?h:Li(Le(o),0,h);var p=o;return o-=n.length,o>=0&&r.slice(o,p)==n}function jy(r){return r=it(r),r&&gt.test(r)?r.replace(Ci,xp):r}function Ly(r){return r=it(r),r&&Ut.test(r)?r.replace(Dt,"\\$&"):r}var My=_n(function(r,n,o){return r+(o?"-":"")+n.toLowerCase()}),qy=_n(function(r,n,o){return r+(o?" ":"")+n.toLowerCase()}),zy=Ch("toLowerCase");function Hy(r,n,o){r=it(r),n=Le(n);var h=n?un(r):0;if(!n||h>=n)return r;var p=(n-h)/2;return ca(Ys(p),o)+r+ca(Ws(p),o)}function By(r,n,o){r=it(r),n=Le(n);var h=n?un(r):0;return n&&h<n?r+ca(n-h,o):r}function Ky(r,n,o){r=it(r),n=Le(n);var h=n?un(r):0;return n&&h<n?ca(n-h,o)+r:r}function Vy(r,n,o){return o||n==null?n=0:n&&(n=+n),Zp(it(r).replace(St,""),n||0)}function ky(r,n,o){return(o?ir(r,n,o):n===e)?n=1:n=Le(n),Fo(it(r),n)}function Gy(){var r=arguments,n=it(r[0]);return r.length<3?n:n.replace(r[1],r[2])}var Wy=_n(function(r,n,o){return r+(o?"_":"")+n.toLowerCase()});function Yy(r,n,o){return o&&typeof o!="number"&&ir(r,n,o)&&(n=o=e),o=o===e?re:o>>>0,o?(r=it(r),r&&(typeof n=="string"||n!=null&&!sc(n))&&(n=br(n),!n&&cn(r))?wi(Mr(r),0,o):r.split(n,o)):[]}var Jy=_n(function(r,n,o){return r+(o?" ":"")+cc(n)});function Xy(r,n,o){return r=it(r),o=o==null?0:Li(Le(o),0,r.length),n=br(n),r.slice(o,o+n.length)==n}function Zy(r,n,o){var h=b.templateSettings;o&&ir(r,n,o)&&(n=e),r=it(r),n=ma({},n,h,Fh);var p=ma({},n.imports,h.imports,Fh),w=Vt(p),O=bo(p,w),A,L,J=0,X=n.interpolate||Qi,Q="__p += '",oe=wo((n.escape||Qi).source+"|"+X.source+"|"+(X===vt?ka:Qi).source+"|"+(n.evaluate||Qi).source+"|$","g"),_e="//# sourceURL="+(nt.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ho+"]")+`
`;r.replace(oe,function(Ee,Ge,Ze,wr,nr,Er){return Ze||(Ze=wr),Q+=r.slice(J,Er).replace(Za,Op),Ge&&(A=!0,Q+=`' +
__e(`+Ge+`) +
'`),nr&&(L=!0,Q+=`';
`+nr+`;
__p += '`),Ze&&(Q+=`' +
((__t = (`+Ze+`)) == null ? '' : __t) +
'`),J=Er+Ee.length,Ee}),Q+=`';
`;var we=nt.call(n,"variable")&&n.variable;if(!we)Q=`with (obj) {
`+Q+`
}
`;else if(Ka.test(we))throw new Ae(f);Q=(L?Q.replace(Br,""):Q).replace(er,"$1").replace(Qr,"$1;"),Q="function("+(we||"obj")+`) {
`+(we?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(A?", __e = _.escape":"")+(L?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Q+`return __p
}`;var ze=Pl(function(){return rt(w,_e+"return "+Q).apply(e,O)});if(ze.source=Q,nc(ze))throw ze;return ze}function Qy(r){return it(r).toLowerCase()}function ev(r){return it(r).toUpperCase()}function tv(r,n,o){if(r=it(r),r&&(o||n===e))return ju(r);if(!r||!(n=br(n)))return r;var h=Mr(r),p=Mr(n),w=Lu(h,p),O=Mu(h,p)+1;return wi(h,w,O).join("")}function rv(r,n,o){if(r=it(r),r&&(o||n===e))return r.slice(0,zu(r)+1);if(!r||!(n=br(n)))return r;var h=Mr(r),p=Mu(h,Mr(n))+1;return wi(h,0,p).join("")}function iv(r,n,o){if(r=it(r),r&&(o||n===e))return r.replace(St,"");if(!r||!(n=br(n)))return r;var h=Mr(r),p=Lu(h,Mr(n));return wi(h,p).join("")}function nv(r,n){var o=V,h=ae;if(bt(n)){var p="separator"in n?n.separator:p;o="length"in n?Le(n.length):o,h="omission"in n?br(n.omission):h}r=it(r);var w=r.length;if(cn(r)){var O=Mr(r);w=O.length}if(o>=w)return r;var A=o-un(h);if(A<1)return h;var L=O?wi(O,0,A).join(""):r.slice(0,A);if(p===e)return L+h;if(O&&(A+=L.length-A),sc(p)){if(r.slice(A).search(p)){var J,X=L;for(p.global||(p=wo(p.source,it(Sr.exec(p))+"g")),p.lastIndex=0;J=p.exec(X);)var Q=J.index;L=L.slice(0,Q===e?A:Q)}}else if(r.indexOf(br(p),A)!=A){var oe=L.lastIndexOf(p);oe>-1&&(L=L.slice(0,oe))}return L+h}function sv(r){return r=it(r),r&&mt.test(r)?r.replace(fi,$p):r}var av=_n(function(r,n,o){return r+(o?" ":"")+n.toUpperCase()}),cc=Ch("toUpperCase");function Ol(r,n,o){return r=it(r),n=o?e:n,n===e?Cp(r)?jp(r):mp(r):r.match(n)||[]}var Pl=Ke(function(r,n){try{return Kt(r,e,n)}catch(o){return nc(o)?o:new Ae(o)}}),ov=ai(function(r,n){return xr(n,function(o){o=Wr(o),ni(r,o,rc(r[o],r))}),r});function cv(r){var n=r==null?0:r.length,o=be();return r=n?yt(r,function(h){if(typeof h[1]!="function")throw new Or(d);return[o(h[0]),h[1]]}):[],Ke(function(h){for(var p=-1;++p<n;){var w=r[p];if(Kt(w[0],this,h))return Kt(w[1],this,h)}})}function uv(r){return $g(Cr(r,N))}function uc(r){return function(){return r}}function hv(r,n){return r==null||r!==r?n:r}var lv=Nh(),fv=Nh(!0);function pr(r){return r}function hc(r){return oh(typeof r=="function"?r:Cr(r,N))}function dv(r){return uh(Cr(r,N))}function pv(r,n){return hh(r,Cr(n,N))}var gv=Ke(function(r,n){return function(o){return zn(o,r,n)}}),_v=Ke(function(r,n){return function(o){return zn(r,o,n)}});function lc(r,n,o){var h=Vt(n),p=ta(n,h);o==null&&!(bt(n)&&(p.length||!h.length))&&(o=n,n=r,r=this,p=ta(n,Vt(n)));var w=!(bt(o)&&"chain"in o)||!!o.chain,O=ci(r);return xr(p,function(A){var L=n[A];r[A]=L,O&&(r.prototype[A]=function(){var J=this.__chain__;if(w||J){var X=r(this.__wrapped__),Q=X.__actions__=lr(this.__actions__);return Q.push({func:L,args:arguments,thisArg:r}),X.__chain__=J,X}return L.apply(r,gi([this.value()],arguments))})}),r}function yv(){return Xe._===this&&(Xe._=Bp),this}function fc(){}function vv(r){return r=Le(r),Ke(function(n){return lh(n,r)})}var bv=Bo(yt),mv=Bo(Tu),wv=Bo(po);function Cl(r){return Jo(r)?go(Wr(r)):Xg(r)}function Ev(r){return function(n){return r==null?e:Mi(r,n)}}var Dv=Rh(),Sv=Rh(!0);function dc(){return[]}function pc(){return!1}function Iv(){return{}}function xv(){return""}function Ov(){return!0}function Pv(r,n){if(r=Le(r),r<1||r>W)return[];var o=re,h=Jt(r,re);n=be(n),r-=re;for(var p=vo(h,n);++o<r;)n(o);return p}function Cv(r){return Te(r)?yt(r,Wr):mr(r)?[r]:lr(Yh(it(r)))}function Av(r){var n=++zp;return it(r)+n}var Nv=oa(function(r,n){return r+n},0),Tv=Ko("ceil"),Rv=oa(function(r,n){return r/n},1),$v=Ko("floor");function Uv(r){return r&&r.length?ea(r,pr,Co):e}function Fv(r,n){return r&&r.length?ea(r,be(n,2),Co):e}function jv(r){return Uu(r,pr)}function Lv(r,n){return Uu(r,be(n,2))}function Mv(r){return r&&r.length?ea(r,pr,Ro):e}function qv(r,n){return r&&r.length?ea(r,be(n,2),Ro):e}var zv=oa(function(r,n){return r*n},1),Hv=Ko("round"),Bv=oa(function(r,n){return r-n},0);function Kv(r){return r&&r.length?yo(r,pr):0}function Vv(r,n){return r&&r.length?yo(r,be(n,2)):0}return b.after=d_,b.ary=al,b.assign=ey,b.assignIn=ml,b.assignInWith=ma,b.assignWith=ty,b.at=ry,b.before=ol,b.bind=rc,b.bindAll=ov,b.bindKey=cl,b.castArray=I_,b.chain=il,b.chunk=$0,b.compact=U0,b.concat=F0,b.cond=cv,b.conforms=uv,b.constant=uc,b.countBy=K1,b.create=iy,b.curry=ul,b.curryRight=hl,b.debounce=ll,b.defaults=ny,b.defaultsDeep=sy,b.defer=p_,b.delay=g_,b.difference=j0,b.differenceBy=L0,b.differenceWith=M0,b.drop=q0,b.dropRight=z0,b.dropRightWhile=H0,b.dropWhile=B0,b.fill=K0,b.filter=k1,b.flatMap=Y1,b.flatMapDeep=J1,b.flatMapDepth=X1,b.flatten=Qh,b.flattenDeep=V0,b.flattenDepth=k0,b.flip=__,b.flow=lv,b.flowRight=fv,b.fromPairs=G0,b.functions=fy,b.functionsIn=dy,b.groupBy=Z1,b.initial=Y0,b.intersection=J0,b.intersectionBy=X0,b.intersectionWith=Z0,b.invert=gy,b.invertBy=_y,b.invokeMap=e_,b.iteratee=hc,b.keyBy=t_,b.keys=Vt,b.keysIn=dr,b.map=pa,b.mapKeys=vy,b.mapValues=by,b.matches=dv,b.matchesProperty=pv,b.memoize=_a,b.merge=my,b.mergeWith=wl,b.method=gv,b.methodOf=_v,b.mixin=lc,b.negate=ya,b.nthArg=vv,b.omit=wy,b.omitBy=Ey,b.once=y_,b.orderBy=r_,b.over=bv,b.overArgs=v_,b.overEvery=mv,b.overSome=wv,b.partial=ic,b.partialRight=fl,b.partition=i_,b.pick=Dy,b.pickBy=El,b.property=Cl,b.propertyOf=Ev,b.pull=r1,b.pullAll=tl,b.pullAllBy=i1,b.pullAllWith=n1,b.pullAt=s1,b.range=Dv,b.rangeRight=Sv,b.rearg=b_,b.reject=a_,b.remove=a1,b.rest=m_,b.reverse=ec,b.sampleSize=c_,b.set=Iy,b.setWith=xy,b.shuffle=u_,b.slice=o1,b.sortBy=f_,b.sortedUniq=p1,b.sortedUniqBy=g1,b.split=Yy,b.spread=w_,b.tail=_1,b.take=y1,b.takeRight=v1,b.takeRightWhile=b1,b.takeWhile=m1,b.tap=U1,b.throttle=E_,b.thru=da,b.toArray=yl,b.toPairs=Dl,b.toPairsIn=Sl,b.toPath=Cv,b.toPlainObject=bl,b.transform=Oy,b.unary=D_,b.union=w1,b.unionBy=E1,b.unionWith=D1,b.uniq=S1,b.uniqBy=I1,b.uniqWith=x1,b.unset=Py,b.unzip=tc,b.unzipWith=rl,b.update=Cy,b.updateWith=Ay,b.values=bn,b.valuesIn=Ny,b.without=O1,b.words=Ol,b.wrap=S_,b.xor=P1,b.xorBy=C1,b.xorWith=A1,b.zip=N1,b.zipObject=T1,b.zipObjectDeep=R1,b.zipWith=$1,b.entries=Dl,b.entriesIn=Sl,b.extend=ml,b.extendWith=ma,lc(b,b),b.add=Nv,b.attempt=Pl,b.camelCase=Uy,b.capitalize=Il,b.ceil=Tv,b.clamp=Ty,b.clone=x_,b.cloneDeep=P_,b.cloneDeepWith=C_,b.cloneWith=O_,b.conformsTo=A_,b.deburr=xl,b.defaultTo=hv,b.divide=Rv,b.endsWith=Fy,b.eq=zr,b.escape=jy,b.escapeRegExp=Ly,b.every=V1,b.find=G1,b.findIndex=Xh,b.findKey=ay,b.findLast=W1,b.findLastIndex=Zh,b.findLastKey=oy,b.floor=$v,b.forEach=nl,b.forEachRight=sl,b.forIn=cy,b.forInRight=uy,b.forOwn=hy,b.forOwnRight=ly,b.get=ac,b.gt=N_,b.gte=T_,b.has=py,b.hasIn=oc,b.head=el,b.identity=pr,b.includes=Q1,b.indexOf=W0,b.inRange=Ry,b.invoke=yy,b.isArguments=Hi,b.isArray=Te,b.isArrayBuffer=R_,b.isArrayLike=fr,b.isArrayLikeObject=At,b.isBoolean=$_,b.isBuffer=Ei,b.isDate=U_,b.isElement=F_,b.isEmpty=j_,b.isEqual=L_,b.isEqualWith=M_,b.isError=nc,b.isFinite=q_,b.isFunction=ci,b.isInteger=dl,b.isLength=va,b.isMap=pl,b.isMatch=z_,b.isMatchWith=H_,b.isNaN=B_,b.isNative=K_,b.isNil=k_,b.isNull=V_,b.isNumber=gl,b.isObject=bt,b.isObjectLike=xt,b.isPlainObject=Gn,b.isRegExp=sc,b.isSafeInteger=G_,b.isSet=_l,b.isString=ba,b.isSymbol=mr,b.isTypedArray=vn,b.isUndefined=W_,b.isWeakMap=Y_,b.isWeakSet=J_,b.join=Q0,b.kebabCase=My,b.last=Nr,b.lastIndexOf=e1,b.lowerCase=qy,b.lowerFirst=zy,b.lt=X_,b.lte=Z_,b.max=Uv,b.maxBy=Fv,b.mean=jv,b.meanBy=Lv,b.min=Mv,b.minBy=qv,b.stubArray=dc,b.stubFalse=pc,b.stubObject=Iv,b.stubString=xv,b.stubTrue=Ov,b.multiply=zv,b.nth=t1,b.noConflict=yv,b.noop=fc,b.now=ga,b.pad=Hy,b.padEnd=By,b.padStart=Ky,b.parseInt=Vy,b.random=$y,b.reduce=n_,b.reduceRight=s_,b.repeat=ky,b.replace=Gy,b.result=Sy,b.round=Hv,b.runInContext=j,b.sample=o_,b.size=h_,b.snakeCase=Wy,b.some=l_,b.sortedIndex=c1,b.sortedIndexBy=u1,b.sortedIndexOf=h1,b.sortedLastIndex=l1,b.sortedLastIndexBy=f1,b.sortedLastIndexOf=d1,b.startCase=Jy,b.startsWith=Xy,b.subtract=Bv,b.sum=Kv,b.sumBy=Vv,b.template=Zy,b.times=Pv,b.toFinite=ui,b.toInteger=Le,b.toLength=vl,b.toLower=Qy,b.toNumber=Tr,b.toSafeInteger=Q_,b.toString=it,b.toUpper=ev,b.trim=tv,b.trimEnd=rv,b.trimStart=iv,b.truncate=nv,b.unescape=sv,b.uniqueId=Av,b.upperCase=av,b.upperFirst=cc,b.each=nl,b.eachRight=sl,b.first=el,lc(b,function(){var r={};return kr(b,function(n,o){nt.call(b.prototype,o)||(r[o]=n)}),r}(),{chain:!1}),b.VERSION=s,xr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){b[r].placeholder=b}),xr(["drop","take"],function(r,n){Ye.prototype[r]=function(o){o=o===e?1:Bt(Le(o),0);var h=this.__filtered__&&!n?new Ye(this):this.clone();return h.__filtered__?h.__takeCount__=Jt(o,h.__takeCount__):h.__views__.push({size:Jt(o,re),type:r+(h.__dir__<0?"Right":"")}),h},Ye.prototype[r+"Right"]=function(o){return this.reverse()[r](o).reverse()}}),xr(["filter","map","takeWhile"],function(r,n){var o=n+1,h=o==U||o==le;Ye.prototype[r]=function(p){var w=this.clone();return w.__iteratees__.push({iteratee:be(p,3),type:o}),w.__filtered__=w.__filtered__||h,w}}),xr(["head","last"],function(r,n){var o="take"+(n?"Right":"");Ye.prototype[r]=function(){return this[o](1).value()[0]}}),xr(["initial","tail"],function(r,n){var o="drop"+(n?"":"Right");Ye.prototype[r]=function(){return this.__filtered__?new Ye(this):this[o](1)}}),Ye.prototype.compact=function(){return this.filter(pr)},Ye.prototype.find=function(r){return this.filter(r).head()},Ye.prototype.findLast=function(r){return this.reverse().find(r)},Ye.prototype.invokeMap=Ke(function(r,n){return typeof r=="function"?new Ye(this):this.map(function(o){return zn(o,r,n)})}),Ye.prototype.reject=function(r){return this.filter(ya(be(r)))},Ye.prototype.slice=function(r,n){r=Le(r);var o=this;return o.__filtered__&&(r>0||n<0)?new Ye(o):(r<0?o=o.takeRight(-r):r&&(o=o.drop(r)),n!==e&&(n=Le(n),o=n<0?o.dropRight(-n):o.take(n-r)),o)},Ye.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Ye.prototype.toArray=function(){return this.take(re)},kr(Ye.prototype,function(r,n){var o=/^(?:filter|find|map|reject)|While$/.test(n),h=/^(?:head|last)$/.test(n),p=b[h?"take"+(n=="last"?"Right":""):n],w=h||/^find/.test(n);p&&(b.prototype[n]=function(){var O=this.__wrapped__,A=h?[1]:arguments,L=O instanceof Ye,J=A[0],X=L||Te(O),Q=function(Ge){var Ze=p.apply(b,gi([Ge],A));return h&&oe?Ze[0]:Ze};X&&o&&typeof J=="function"&&J.length!=1&&(L=X=!1);var oe=this.__chain__,_e=!!this.__actions__.length,we=w&&!oe,ze=L&&!_e;if(!w&&X){O=ze?O:new Ye(this);var Ee=r.apply(O,A);return Ee.__actions__.push({func:da,args:[Q],thisArg:e}),new Pr(Ee,oe)}return we&&ze?r.apply(this,A):(Ee=this.thru(Q),we?h?Ee.value()[0]:Ee.value():Ee)})}),xr(["pop","push","shift","sort","splice","unshift"],function(r){var n=Ms[r],o=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",h=/^(?:pop|shift)$/.test(r);b.prototype[r]=function(){var p=arguments;if(h&&!this.__chain__){var w=this.value();return n.apply(Te(w)?w:[],p)}return this[o](function(O){return n.apply(Te(O)?O:[],p)})}}),kr(Ye.prototype,function(r,n){var o=b[n];if(o){var h=o.name+"";nt.call(dn,h)||(dn[h]=[]),dn[h].push({name:n,func:o})}}),dn[aa(e,ie).name]=[{name:"wrapper",func:e}],Ye.prototype.clone=sg,Ye.prototype.reverse=ag,Ye.prototype.value=og,b.prototype.at=F1,b.prototype.chain=j1,b.prototype.commit=L1,b.prototype.next=M1,b.prototype.plant=z1,b.prototype.reverse=H1,b.prototype.toJSON=b.prototype.valueOf=b.prototype.value=B1,b.prototype.first=b.prototype.head,$n&&(b.prototype[$n]=q1),b},hn=Lp();Ct?((Ct.exports=hn)._=hn,ct._=hn):Xe._=hn}).call(ss)})(ou,ou.exports);var w5=Object.defineProperty,E5=Object.defineProperties,D5=Object.getOwnPropertyDescriptors,Bf=Object.getOwnPropertySymbols,S5=Object.prototype.hasOwnProperty,I5=Object.prototype.propertyIsEnumerable,Kf=(i,t,e)=>t in i?w5(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Ea=(i,t)=>{for(var e in t||(t={}))S5.call(t,e)&&Kf(i,e,t[e]);if(Bf)for(var e of Bf(t))I5.call(t,e)&&Kf(i,e,t[e]);return i},x5=(i,t)=>E5(i,D5(t));function Ur(i,t,e){let s;const a=cu(i);return t.rpcMap&&(s=t.rpcMap[a]),s||(s=`${m5}?chainId=eip155:${a}&projectId=${e}`),s}function cu(i){return i.includes("eip155")?Number(i.split(":")[1]):Number(i)}function O5(i,t){if(!t.includes(i))throw new Error(`Chain '${i}' not approved. Please use one of the following: ${t.toString()}`)}function P5(i){return i.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function C5(i,t){const e=Object.keys(t.namespaces).filter(a=>a.includes(i));if(!e.length)return[];const s=[];return e.forEach(a=>{const c=t.namespaces[a].accounts;s.push(...c)}),s}function A5(i,t={}){const e=Vf(i),s=Vf(t);return ou.exports.merge(e,s)}function Vf(i){var t,e,s,a;const c={};if(!Sn(i))return c;for(const[d,f]of Object.entries(i)){const _=Kd(d)?[d]:f.chains,g=f.methods||[],D=f.events||[],N=f.rpcMap||{},P=Ia(d);c[P]=x5(Ea(Ea({},c[P]),f),{chains:Ic(_,(t=c[P])==null?void 0:t.chains),methods:Ic(g,(e=c[P])==null?void 0:e.methods),events:Ic(D,(s=c[P])==null?void 0:s.events),rpcMap:Ea(Ea({},N),(a=c[P])==null?void 0:a.rpcMap)})}return c}const dp={},Tt=i=>dp[i],Tc=(i,t)=>{dp[i]=t};class N5{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Tt("events"),this.client=Tt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(this.chainId=t,!this.httpProviders[t]){const s=e||Ur(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var s;t[e]=this.createHttpProvider(e,(s=this.namespace.rpcMap)==null?void 0:s[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProvider(t,e){const s=e||Ur(t,this.namespace);return typeof s>"u"?void 0:new xi(new Ji(s,Tt("disableProviderPing")))}}class T5{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Tt("events"),this.client=Tt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){var e;switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return this.handleSwitchChain(t.request.params?(e=t.request.params[0])==null?void 0:e.chainId:"0x0"),null;case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,e){const s=cu(t);if(!this.httpProviders[s]){const a=e||Ur(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!a)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,a)}this.chainId=s,this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,e){const s=e||Ur(`${this.name}:${t}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new xi(new Ji(s,Tt("disableProviderPing")))}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var s;const a=cu(e);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[e])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}handleSwitchChain(t){const e=parseInt(t,16),s=`${this.name}:${e}`;O5(s,this.namespace.chains),this.setDefaultChain(`${e}`)}}class R5{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Tt("events"),this.client=Tt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(!this.httpProviders[t]){const s=e||Ur(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var s;t[e]=this.createHttpProvider(e,(s=this.namespace.rpcMap)==null?void 0:s[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProvider(t,e){const s=e||Ur(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new xi(new Ji(s,Tt("disableProviderPing")))}}class $5{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Tt("events"),this.client=Tt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(this.chainId=t,!this.httpProviders[t]){const s=e||Ur(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var s;t[e]=this.createHttpProvider(e,(s=this.namespace.rpcMap)==null?void 0:s[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProvider(t,e){const s=e||Ur(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new xi(new Ji(s,Tt("disableProviderPing")))}}class U5{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Tt("events"),this.client=Tt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(this.chainId=t,!this.httpProviders[t]){const s=e||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{const s=this.getCardanoRPCUrl(e);t[e]=this.createHttpProvider(e,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}getCardanoRPCUrl(t){const e=this.namespace.rpcMap;if(e)return e[t]}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProvider(t,e){const s=e||this.getCardanoRPCUrl(t);return typeof s>"u"?void 0:new xi(new Ji(s,Tt("disableProviderPing")))}}class F5{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Tt("events"),this.client=Tt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(!this.httpProviders[t]){const s=e||Ur(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var s;t[e]=this.createHttpProvider(e,(s=this.namespace.rpcMap)==null?void 0:s[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProvider(t,e){const s=e||Ur(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new xi(new Ji(s,Tt("disableProviderPing")))}}class j5{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Tt("events"),this.client=Tt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(!this.httpProviders[t]){const s=e||Ur(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var s;t[e]=this.createHttpProvider(e,(s=this.namespace.rpcMap)==null?void 0:s[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProvider(t,e){const s=e||Ur(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new xi(new Ji(s,Tt("disableProviderPing")))}}var L5=Object.defineProperty,M5=Object.defineProperties,q5=Object.getOwnPropertyDescriptors,kf=Object.getOwnPropertySymbols,z5=Object.prototype.hasOwnProperty,H5=Object.prototype.propertyIsEnumerable,Gf=(i,t,e)=>t in i?L5(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Da=(i,t)=>{for(var e in t||(t={}))z5.call(t,e)&&Gf(i,e,t[e]);if(kf)for(var e of kf(t))H5.call(t,e)&&Gf(i,e,t[e]);return i},Rc=(i,t)=>M5(i,q5(t));class Nu{constructor(t){this.events=new Fr,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:t?.logger||zf})),this.disableProviderPing=t?.disableProviderPing||!1}static async init(t){const e=new Nu(t);return await e.initialize(),e}async request(t,e){const[s,a]=this.validateChain(e);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Da({},t),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(t,e,s){this.request(t,s).then(a=>e(null,a)).catch(a=>e(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:zt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}removeListener(t,e){this.events.removeListener(t,e)}off(t,e){this.events.off(t,e)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let e=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(e>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(c=>{this.session=c}).catch(c=>{if(c.message!==lp)throw c;e++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,e){try{const[s,a]=this.validateChain(t);this.getProvider(s).setDefaultChain(a,e)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const e=this.client.pairing.getAll();if(Pn(e)){for(const s of e)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${e.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await _5.init({logger:this.providerOpts.logger||zf,relayUrl:this.providerOpts.relayUrl||y5,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(e=>Ia(e)))];Tc("client",this.client),Tc("events",this.events),Tc("disableProviderPing",this.disableProviderPing),t.forEach(e=>{if(!this.session)return;const s=C5(e,this.session),a=P5(s),c=A5(this.namespaces,this.optionalNamespaces),d=Rc(Da({},c[e]),{accounts:s,chains:a});switch(e){case"eip155":this.rpcProviders[e]=new T5({namespace:d});break;case"solana":this.rpcProviders[e]=new R5({namespace:d});break;case"cosmos":this.rpcProviders[e]=new $5({namespace:d});break;case"polkadot":this.rpcProviders[e]=new N5({namespace:d});break;case"cip34":this.rpcProviders[e]=new U5({namespace:d});break;case"elrond":this.rpcProviders[e]=new F5({namespace:d});break;case"multiversx":this.rpcProviders[e]=new j5({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:e}=t,{event:s}=e;s.name==="accountsChanged"?this.events.emit("accountsChanged",s.data):s.name==="chainChanged"?this.onChainChanged(e.chainId):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:e})=>{var s;const{namespaces:a}=e,c=(s=this.client)==null?void 0:s.session.get(t);this.session=Rc(Da({},c),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:e})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Rc(Da({},zt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(Pi.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var e;this.getProvider(t).updateNamespace((e=this.session)==null?void 0:e.namespaces[t])})}setNamespaces(t){const{namespaces:e,optionalNamespaces:s,sessionProperties:a}=t;if(!e||!Object.keys(e).length)throw new Error("Namespaces must be not empty");this.namespaces=e,this.optionalNamespaces=s,this.sessionProperties=a,this.persist("namespaces",e),this.persist("optionalNamespaces",s)}validateChain(t){const[e,s]=t?.split(":")||["",""];if(e&&!Object.keys(this.namespaces).map(d=>Ia(d)).includes(e))throw new Error(`Namespace '${e}' is not configured. Please call connect() first with namespace config.`);if(e&&s)return[e,s];const a=Ia(Object.keys(this.namespaces)[0]),c=this.rpcProviders[a].getDefaultChain();return[a,c]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,e=!1){var s;const[a,c]=this.validateChain(t);e||this.getProvider(a).setDefaultChain(c),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(t,e){this.client.core.storage.setItem(`${Hf}/${t}`,e)}async getFromStore(t){return await this.client.core.storage.getItem(`${Hf}/${t}`)}}const B5=Nu,K5="wc",V5="ethereum_provider",k5=`${K5}@2:${V5}:`,G5="https://rpc.walletconnect.com/v1/",uu=["eth_sendTransaction","personal_sign"],lS=["eth_accounts","eth_requestAccounts","eth_call","eth_getBalance","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],hu=["chainChanged","accountsChanged"],fS=["message","disconnect","connect"];var W5=Object.defineProperty,Y5=Object.defineProperties,J5=Object.getOwnPropertyDescriptors,Wf=Object.getOwnPropertySymbols,X5=Object.prototype.hasOwnProperty,Z5=Object.prototype.propertyIsEnumerable,Yf=(i,t,e)=>t in i?W5(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,$c=(i,t)=>{for(var e in t||(t={}))X5.call(t,e)&&Yf(i,e,t[e]);if(Wf)for(var e of Wf(t))Z5.call(t,e)&&Yf(i,e,t[e]);return i},Jf=(i,t)=>Y5(i,J5(t));function lu(i){return Number(i[0].split(":")[1])}function Uc(i){return`0x${i.toString(16)}`}function Q5(i){const{chains:t,optionalChains:e,methods:s,optionalMethods:a,events:c,optionalEvents:d,rpcMap:f}=i;if(!Vc(t))throw new Error("Invalid chains");const _=t,g=s||uu,D=c||hu,N={[lu(_)]:f[lu(_)]},P={chains:_,methods:g,events:D,rpcMap:N},T=c?.filter(ie=>!hu.includes(ie)),R=s?.filter(ie=>!uu.includes(ie));if(!e&&!d&&!a&&!(T!=null&&T.length)&&!(R!=null&&R.length))return{required:P};const H=T?.length&&R?.length||!e,G={chains:[...new Set(H?_.concat(e||[]):e)],methods:[...new Set(g.concat(a||[]))],events:[...new Set(D.concat(d||[]))],rpcMap:f};return{required:P,optional:G}}class pp{constructor(){this.events=new Fr,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=k5,this.on=(t,e)=>(this.events.on(t,e),this),this.once=(t,e)=>(this.events.once(t,e),this),this.removeListener=(t,e)=>(this.events.removeListener(t,e),this),this.off=(t,e)=>(this.events.off(t,e),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const e=new pp;return await e.initialize(t),e}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,e){this.signer.sendAsync(t,e,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:e,optional:s}=Q5(this.rpc);try{const a=await new Promise(async(d,f)=>{var _;this.rpc.showQrModal&&((_=this.modal)==null||_.subscribeModal(g=>{!g.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Jf($c({namespaces:{[this.namespace]:e}},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t?.pairingTopic})).then(g=>{d(g)}).catch(g=>{f(new Error(g.message))})});if(!a)return;this.setChainIds(this.rpc.chains);const c=yw(a.namespaces,[this.namespace]);this.setAccounts(c),this.events.emit("connect",{chainId:Uc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:e}=t,{event:s}=e;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const e=parseInt(t);this.chainId=e,this.events.emit("chainChanged",Uc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",Jf($c({},bw("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var e,s;this.rpc.showQrModal&&((e=this.modal)==null||e.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}setHttpProvider(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const e=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));e.length&&(this.chainId=e[0],this.events.emit("chainChanged",Uc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const e=this.parseChainId(t);this.chainId=e,this.setHttpProvider(e)}}parseAccountId(t){const[e,s,a]=t.split(":");return{chainId:`${e}:${s}`,address:a}}setAccounts(t){this.accounts=t.filter(e=>this.parseChainId(this.parseAccountId(e).chainId)===this.chainId).map(e=>this.parseAccountId(e).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var e,s;return{chains:((e=t.chains)==null?void 0:e.map(a=>this.formatChainId(a)))||[`${this.namespace}:1`],optionalChains:t.optionalChains?t.optionalChains.map(a=>this.formatChainId(a)):void 0,methods:t?.methods||uu,events:t?.events||hu,optionalMethods:t?.optionalMethods||[],optionalEvents:t?.optionalEvents||[],rpcMap:t?.rpcMap||this.buildRpcMap(t.chains.concat(t.optionalChains||[]),t.projectId),showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:(s=t?.qrModalOptions)!=null?s:void 0,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,e){const s={};return t.forEach(a=>{s[a]=this.getRpcUrl(a,e)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=lu(this.rpc.chains),this.signer=await B5.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let e;try{const{WalletConnectModal:s}=await import("@walletconnect/modal");e=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(e)try{this.modal=new e($c({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:e,optionalChains:s,rpcMap:a}=t;e&&Vc(e)&&(this.rpc.chains=e.map(c=>this.formatChainId(c)),e.forEach(c=>{this.rpc.rpcMap[c]=a?.[c]||this.getRpcUrl(c)})),s&&Vc(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s?.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=a?.[c]||this.getRpcUrl(c)}))}getRpcUrl(t,e){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${G5}?chainId=eip155:${t}&projectId=${e||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`);this.setChainIds(t?[this.formatChainId(t)]:this.session.namespaces[this.namespace].accounts),this.setAccounts(this.session.namespaces[this.namespace].accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(e=>this.parseAccount(e))}}export{fS as OPTIONAL_EVENTS,lS as OPTIONAL_METHODS,hu as REQUIRED_EVENTS,uu as REQUIRED_METHODS,pp as default};
