<!DOCTYPE html>
<html lang="en">
    {% load static %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Личный кабинет</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/academy_cab_main-academy.css'%}">
    
</head>
<body>
    <header class="head_block">
        <nav class="nav_line">
          <div class="logo_block">
            <img src="{% static 'img/burger.svg'%}" alt="" class="menu_drop" />
            <img class="logo" src="{% static 'img/image 1.svg'%}" alt="logo" />
            <div class="logo_text">
              <p class="text1">Бирюзовая</p>
              <p class="text2">Академия</p>
            </div>
          </div>
          <div class="nav_btn_group">
            <ul class="btn_list">
              <li class="main_menu_item">
                <a class="link_img" href="/all_courses.html"
                  ><img
                    class="item_img"
                    src="{% static 'img/marketplace.png'%}"
                    alt=""
                /></a>
              </li>
              <li class="main_menu_item">
                <a class="link_img" href="#"
                  ><img
                    class="item_img"
                    src="{% static 'img/crypto.png'%}"
                    alt=""
                /></a>
              </li>
              <li class="main_menu_item">
                <a class="link_img" href="#"
                  ><img
                    class="item_img"
                    src="{% static 'img/metaverse.png'%}"
                    alt=""
                /></a>
              </li>
              <li class="main_menu_item">
                <a class="link_img" href="#"
                  ><img class="item_img" src="{% static 'img/hrw.png'%}" alt=""
                /></a>
              </li>
            </ul>
            <div class="profile_drop">
              <img
                src="{{ request.user.customer.image.url }}"
                alt=""
                class="profile_img"
              />
              <p class="profile_name">
                Eth address: ...{{ user.username|slice:"-3:" }}
              </p>
              <img
                class="arrow_down"
                src="{% static 'img/arrow_down.png'%}"
                alt=""
              />
            </div>
            <ul class="drop_menu_list">
              <a href="#"
                ><li class="drop_menu_item main">
                  <img
                    class="drop_menu_img"
                    src="{% static 'img/main_icon.png'%}"
                    alt=""
                  />
                  <p class="drop_menu_text">Главная</p>
                </li></a
              >
              <a href="#"
                ><li class="drop_menu_item">
                  <img
                    class="drop_menu_img"
                    src="{% static 'img/package_icon.png'%}"
                    alt=""
                  />
                  <p class="drop_menu_text">Пакеты</p>
                </li></a
              >
              <a href="#"
                ><li class="drop_menu_item settings">
                  <img
                    class="drop_menu_img"
                    src="{% static 'img/settings_icon.png'%}"
                    alt=""
                  />
                  <p class="drop_menu_text">Настройки</p>
                </li></a
              >
              <a href="#"
                ><li id="logoutButton" class="drop_menu_item">
                  <img
                    class="drop_menu_img"
                    src="{% static 'img/exit_icon.png'%}"
                    alt=""
                  />
                  <p class="drop_menu_text">Выход</p>
                </li></a
              >
            </ul>
          </div>
        </nav>
      </header>
    <div class="main-block">
        <!-- боковое меню -->
        <div class="side_menu">
            <ul class="menu_group">
                <li class="menu_item study_btn">
                    <div class="study">
                        <img class="item_menu_img" src="{% static 'img/study.png'%}" alt="">
                    </div>
                    <a href="#"><p class="item_text">Обучение</p></a>
                </li>
                <li class="menu_item practic_btn">
                    <div class="study">
                        <img class="item_menu_img" src="{% static 'img/practic.png'%}" alt="">
                    </div>
                    <a href="#"><p class="item_text">Практика</p></a>
                </li>
                <li class="menu_item desitions_btn">
                    <div class="study">
                        <img class="item_menu_img" src="{% static 'img/desitions.png'%}" alt="">
                    </div>
                    <a href="#"><p class="item_text">Мои успехи</p></a>
                </li>
                <li class="menu_item partnership_btn">
                    <div class="study">
                        <img class="item_menu_img" src="{% static 'img/partnership.png'%}" alt="">
                    </div>
                    <a href="#"><p class="item_text">Партнерство</p></a>
                </li>
                <li class="menu_item home_work_btn">
                    <div class="study">
                        <img class="item_menu_img" src="{% static 'img/home_work.png'%}" alt="">
                    </div>
                    <a href="#"><p class="item_text">Чат по ДЗ</p></a>
                </li>
                <li class="menu_item support_btn">
                    <div class="study">
                        <img class="item_menu_img" src="{% static 'img/support.png'%}" alt="">
                    </div>
                    <a href="#"><p class="item_text">Поддержка</p></a>
                </li>
            </ul>
        </div>
        <div class="main_display">
            <!-- главная -->
            <div class="main_page">
                <div class="user_dashbord_blocks">
                    <div class="user_info_block">
                        <img src="{{ request.user.customer.image.url }}" alt="" class="profile_img_big">
                            <ul class="info_list">
                                <li class="info_item">
                                        <p class="info_lable">Username:</p>
                                        <p class="info_text">Eth address: ...{{ user.username|slice:"-3:" }}</p>
                                </li>
                                    <li class="info_item">
                                        <p class="info_lable">First/Last name:</p>
                                        <p class="info_text">{{ request.user.customer.first_name}}
                                            {{request.user.customer.last_name}}</p>
                                </li>
                                    <li class="info_item">
                                        <p class="info_lable">Mobile:</p>
                                        <p class="info_text">{{ request.user.customer.mobile}}</p>
                                </li>
                                    <li class="info_item">
                                        <p class="info_lable">Referal code:</p>
                                        <p class="info_text">{{ request.user.customer.referral_code}}</p>
                                </li>
                                    <li class="info_item">
                                        <p class="info_lable">Status:</p>
                                        <p class="info_text">{{ request.user.customer.status}}</p>
                                </li>
                                    <li class="info_item">
                                        <p class="info_lable">Leader:</p>
                                        <p class="info_text">{{ request.user.customer.referral_by.name}}</p>
                                </li>
                            </ul>
                    </div>
                <div class="dashbord">
                    <p class="dashbord_title">Ваша статистика</p>
                    <ul class="dashbord_text">
                        <li class="dashbord_item">
                            <p class="dashbord_lable">Привелчено людей:</p>
                            <p class="dashbord_text1 leads">0 человек</p>
                        </li>
                        <li class="dashbord_item">
                            <p class="dashbord_lable">Уровень сети:</p>
                            <p class="dashbord_text1 level">0 уровень</p>
                        </li>
                        <li class="dashbord_item">
                            <p class="dashbord_lable">Ваш оборот:</p>
                            <div class="dashbord_text_block">
                                <p class="dashbord_text1">0 ₽</p>
                                <p class="dashbord_text2">0 USDT</p>
                                <p class="dashbord_text3">0 TVT</p>
                            </div>
                        </li>
                        <li class="dashbord_item">
                            <p class="dashbord_lable">Оборот рефералов:</p>
                            <div class="dashbord_text_block">
                                <p class="dashbord_text1">0 ₽</p>
                                <p class="dashbord_text2">0 USDT</p>
                                <p class="dashbord_text3">0 TVT</p>
                            </div>
                        </li>
                        <li class="dashbord_item">
                            <p class="dashbord_lable">Бонус с продаж:</p>
                            <div class="dashbord_text_block">
                                <p class="dashbord_text1">0 ₽</p>
                                <p class="dashbord_text2">0 USDT</p>
                                <p class="dashbord_text3">0 TVT</p>
                            </div>
                        </li>
                        <li class="dashbord_item">
                            <p class="dashbord_lable">Бонус с сети:</p>
                            <div class="dashbord_text_block">
                                <p class="dashbord_text1">0 ₽</p>
                                <p class="dashbord_text2">0 USDT</p>
                                <p class="dashbord_text3">0 TVT</p>
                            </div>
                        </li>
                        <li class="dashbord_item">
                            <p class="dashbord_lable">Доступно для вывода:</p>
                            <div class="dashbord_text_block">
                                <p class="dashbord_text1">0 ₽</p>
                                <p class="dashbord_text2">0 USDT</p>
                                <p class="dashbord_text3">0 TVT</p>
                            </div>
                        </li>
                        <li class="dashbord_item btn_wth">
                            <button class="dashbord_btn_withdraw">
                                <p class="dashbord_btn_withdraw_text">Вывести средства</p>
                            </button>
                        </li>
                    </ul>
                </div>
                </div>
                <div class="weekly_board">
                <ul class="weakly_lessons_board_text">
                    {% for day_schedule in schedule_by_days %}
                    <li class="weakly_lessons_item">
                        <div class="mondey_title_block">
                            <p class="mondey_title">{{ day_schedule.day }}</p>
                            <div class="weakly_lessons_underline"></div>
                        </div>
                        {% for lesson in day_schedule.lessons %}
                        <div class="{% if forloop.first %}lesson_block_main{% else %}lesson_block{% endif %}">
                            <div class="lessons_info_block">
                                <p class="lessons_info_time">{{ lesson.start_time }}-{{ lesson.end_time }}</p>
                                <p class="lessons_info_subj">{{ lesson.course.name|truncatechars:10 }}...</p>
                                <div class="lessons_info_subj_full_block">
                                    <p class="lessons_info_subj_full">{{ lesson.course.name }}</p>
                                </div>
                            </div>
                            <div class="weakly_lessons_underline"></div>
                        </div>
                        {% endfor %}
                    </li>
                    {% endfor %}
                </ul>
                </div>
            </div>
            <!-- настройки -->
            <div class="settings_page">
                <form method="POST" name="UpdateCustomerForm">
                    {% csrf_token %}
                <div class="personal_block">
                <p class="person_info_title">Персональная информация</p>
                <div class="person_info_block">
                    <div class="first_block">
                        <div class="base_info_block">
                            <p class="base_title">Базовая информация:</p>
                            {% if request.user.customer.registred %} {% else %}
                            <div class="ref_group">
                                <p class="ref">Реферальный код</p>
                                <input
                        type="text"
                        name="referrer_code"
                        value="{{ request.user.customer.referrer_code }}"
                        placeholder=""
                        class="input_block"
                      />
                            </div>
                            {% endif %}
                            <div class="name_group">
                                <p class="name">Имя</p>
                                <input
                        type="text"
                        name="first_name"
                        value="{{ request.user.customer.first_name }}"
                        title="Введите ваше имя"
                        placeholder=""
                        class="input_block"
                      />
                            </div>
                            <div class="Surname_group">
                                <p class="surname">Фамилия</p>
                                <input
                                type="text"
                                name="last_name"
                                value="{{ request.user.customer.last_name }}"
                                title="Введите вашу фамилию"
                                placeholder=""
                                class="input_block"
                              />
                            </div>
                        </div>
                        <div class="contact_info_block">
                            <p class="contact_title">Контактные данные:</p>
                            <div class="mail_group">
                                <p class="mail">Email</p>
                                <input
                        type="email"
                        name="email"
                        value="{{ request.user.customer.email }}"
                        title="Электронная почта для связи"
                        required
                        placeholder=""
                        class="input_block"
                      />
                            </div>
                            <div class="phone_group">
                                <p class="phone">Телефон</p>
                                <input
                        type="mobile"
                        name="mobile"
                        value="{{ request.user.customer.mobile }}"
                        title="Мобильный телефон для связи"
                        placeholder=""
                        class="input_block"
                      />
                            </div>
                        </div>
                    </div>
                    <div class="second_block">
                        <div class="location_info_block">
                            <p class="location_title">Месторасположение:</p>
                            <div class="contry_group">
                                <p class="contry">Страна</p>
                                <input
                        type="text"
                        name="country"
                        value="{{ request.user.customer.country }}"
                        title="Страна проживания"
                        placeholder=""
                        class="input_block"
                      />
                            </div>
                            <div class="zipcode_group">
                                <p class="zipcode">Zipcode города</p>
                                <input
                        type="text"
                        name="zipcode"
                        value="{{ request.user.customer.zipcode }}"
                        title="Почтовый индекс"
                        placeholder=""
                        class="input_block"
                      />
                            </div>
                        </div>
                        <div class="wallet_info_block">
                            <div class="wallet_group">
                                <p class="walet_title">Кошелёк:</p>
                                <p class="wallet">Адрес кошелька Metamask</p>
                                <input
                                type="text"
                                name="wallet"
                                value="{{ request.user.customer.wallet }}"
                                title="Enter the address of your Metamask wallet"
                                placeholder=""
                                class="input_block"
                              />
                            </div>
                        </div>
                    </div>
                </div>
                <button class="save_btn"><p class="save_btn_text">Сохранить</p></button>
                </div>
                </form>
                    {% if form.errors %}
                    {% for field in form %}
                        {% for error in field.errors %}
                            <div class="alert alert-danger">{{ error }}</div>
                        {% endfor %}
                    {% endfor %}
                {% endif %}
            </div>
            <!-- обучение -->
            <div class="study_page">
                <div class="study_content">
                <div class="title_menu_block">
                    <p class="study_title">Ваше направление {{ study_group_direction }}</p>
                </div>
                <ul class="potok_menu_group">
                    {% for stream in study_group_direction_streams %}
                    <a href="#">
                        <li class="potok_item {% if stream.name == 'Поток 1' %}first{% endif %}{% if stream.name == 'Поток 2' %}second{% endif %}{% if stream.name == 'Поток 3' %}third{% endif %}{% if stream.open_status %} open{% endif %}" data-stream-id="{{ stream.id }}">
                            <img class="potok_img" src="{% if stream.open_status %}{% static 'img/knock_open.png'%}{% else %}{% static 'img/knock_close.png'%}{% endif %}" alt="">
                            <div class="potok_text_block">
                                <p class="potok_text">{{ stream.name }}</p>
                                <div class="underline"></div>
                            </div>
                        </li>
                    </a>
                    {% endfor %}
                </ul>
                <div class="potok_block">
                        <div class="drop_block">
                            <div class="courses_drop_block" >
                                <p class="courses_drop_text">Выберите курс</p>
                                <div class="drop_courses">
                                    <p class="courses_text">Ваш курс</p>
                                    <img class="courses_drop_img_p1" src="{% static 'img/arrow_down.png'%}" alt="">
                                </div>
                            
                                <ul class="drop_courses_list">
                                    {% comment %} здесь список курсов в li 
                                    <li class="drop_courses_item main" >
                                        <p class="drop_courses_text">Здесь должно быть название курса</p>
                                    </li>  {% endcomment %}
                                
                                </ul>
                            
                        
                            </div>
                            <div class="lessons_drop_block">
                                <p class="lessons_drop_text">Выберите урок</p>
                                <div class="drop_lessons">
                                    {% comment %} <img class="lessons_drop_img_knock" src="{% static 'img/knock_open.png'%}" alt=""> {% endcomment %}
                                    <p class="lessons_text" >Ваш урок</p>
                                    <img class="lessons_drop_img_p1" src="{% static 'img/arrow_down.png'%}" alt="">
                                </div>
                                <ul class="drop_lessons_list" >
                                        
                                        {% comment %} <li class="drop_lessons_item main">
                                            <img class="lessons_drop_img_knock" src="{% static 'img/knock_open.png'%}" alt="">
                                            <p class="drop_lessons_text">ммыы</p>
                                        </li> {% endcomment %}
                                    
                                </ul>
                            </div>
                        </div>
                        <div class="topic_drop_block">
                            <p class="topic_title">Тема урока “Название темы урока”</p>
                            <div class="topic_dropdown">
                                <div id="first_topic" class="dropdown_topic_item">
                                    <div class="text_item_topic">
                                        <p class="name_item_topic">Кабинет Zoom</p>
                                        <img class="item_topic_img" src="{% static 'img/dropdown_arrow.png'%}" alt="">
                                    </div>
                                </div>
                                <div class="item_container_topic">
                                    <ul class="topick_group">
                                        <div class="mess_text_info">
                                            <div class="mess">
                                                <img src="{% static 'img/zoom.png'%}" alt="" class="file_img">
                                                <div type="">
                                                    
                                                    <a class="file_link" href="" >&#10149; Здесь ссылка на zoom урок</a>
                                                
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                </div>
                                <div id="midle_topic" class="dropdown_topic_item">
                                    <div class="text_item_topic">
                                        <p class="name_item_topic">Запись урока</p>
                                        <img class="item_topic_img" src="{% static 'img/dropdown_arrow.png'%}" alt="">
                                    </div>
                                </div>
                                <div class="item_container_topic">
                                    <ul class="topick_group">
                                        <li class="topick_name">&#10149; Здесь актуальная запись zoom урока</li>
                                        <iframe class="video_block animate__animated animate__fadeInUp" width="560" height="315" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                                        
                                    </ul>
                                </div>
                                <div id="last_topic" class="dropdown_topic_item">
                                    <div class="text_item_topic">
                                        <p class="name_item_topic">Домашнее задание</p>
                                        <img class="item_topic_img" src="{% static 'img/dropdown_arrow.png'%}" alt="">
                                    </div>
                                </div>
                                <div class="item_container_topic">
                                    <ul class="topick_group">
                                        <li class="topick_name">&#10149; Здесь домашнее задание к уроку</li>
                                        <p class="homework_text"></p>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                
                    </div>
            </div>
            <!-- практика -->
            <div class="practic_page">
                практика
            </div>
            <!-- достижение -->
            <div class="desitions_page">
                успехи
            </div>
            <!-- партнерство -->
            <div class="partnership_page">
                партнерство
            </div>
            <!-- чат по дз -->
            <div class="home_work_page">
                <div class="home_work_content">
                    <p class="home_work_title">Чат с преподавателями академии</p>
                    <div class="chat_block">
                        <div class="rooms_block">
                            <div class="title_rooms_block">
                                <p class="title_rooms mentors">Преподаватели</p>
                                <p class="title_rooms students">Студенты</p>
                            </div>
                            <ul class="rooms">
                                <li class="chat_room mentor_room">
                                    <img src="{% static 'img/никита.jpg'%}" alt="" class="chat_img">
                                    <div class="chat_info">
                                        <p class="name_person">Никита</p>
                                        <p class="info_person">"Игра "Мыслить Масшт."</p>
                                    </div>
                                    <div class="mess_income"><p class="mess_numb">1</p></div>
                                </li>
                                <li class="chat_room student_room">
                                    <img src="{% static 'img/никита.jpg'%}" alt="" class="chat_img">
                                    <div class="chat_info">
                                        <p class="name_person">Никита</p>
                                        <p class="info_person">"Напр. Менеджмент"</p>
                                    </div>
                                    <div class="mess_income"><p class="mess_numb">1</p></div>
                                </li>
                            </ul>
                        </div>
                        <div class="chat_desk_block">
                            <ul class="mess_block" id="messageList">
                                <!-- <li class="ask_block">
                                    <img src="/img/никита.jpg" alt="" class="ask_user_img">
                                    <div class="mess_text_info">
                                        <div class="mess">
                                        <p class="text_mess">Привет! Как дела? Как ты, что нового, что будем делать?</p>
                                        </div>
                                        <p class="date_text">30 Дек. 18:30</p>
                                    </div>
                                </li>
                                <li class="answ_block">
                                    <div class="mess_text_info">
                                        <div class="mess">
                                        <p class="text_mess">Привет! Хорошо</p>
                                        </div>
                                        <p class="date_text">30 Дек. 18:31</p>
                                    </div>
                                    <img src="/img/никита.jpg" alt="" class="answ_user_img">
                                </li> -->
                                <!-- <li class="answ_block_file">
                                    <div class="mess_text_info">
                                        <div class="mess">
                                        <video src="/img/РечьУрок1.mov" alt="" class="file_sent" controls="controls"></video>
                                        </div>
                                        <p class="date_text">30 Дек. 18:31</p>
                                    </div>
                                    <img src="/img/никита.jpg" alt="" class="answ_user_img">
                                </li> -->
                                <!-- <li class="ask_block_file">
                                    <img src="/img/никита.jpg" alt="" class="answ_user_img">
                                    <div class="mess_text_info">
                                        <div class="mess">
                                        <img src="/img/send_arrow.png" alt="" class="file_sent">
                                        </div>
                                        <p class="date_text">30 Дек. 18:31</p>
                                    </div>
                                    
                                </li>  -->
                                

                                <!-- <li class="answ_block_file">
                                    <div class="mess_text_info">
                                        <div class="mess">
                                            <img src="/img/file.png" alt="" class="file_img">
                                            <div src="/img/Оферта ИП 890409100814.pdf" type="">
                                                <a class="file_link" href="/img/Оферта ИП 890409100814.pdf">название файла.формат</a>
                                            </div>
                                        </div>
                                        <p class="date_text">30 Дек. 18:31</p>
                                    </div>
                                    <img src="/img/никита.jpg" alt="" class="answ_user_img">
                                </li> -->
                                
                            </ul>
                            <div class="nav_panel">
                                <div class="add_btn" id="uploadElement">
                                    <img src="{% static 'img/add_media.png'%}" alt="" class="add_btn_img">
                                </div>
                                <input class="input_mess" type="text" placeholder="Напишите свой текст здесь...">
                                <div class="send_btn" id="sendBtn">
                                    <img src="{% static 'img/send_arrow.png'%}" alt="" class="send_btn_img">
                                </div>
                                <!-- Элемент для загрузки файла -->
                                <input type="file" id="fileInput" style="display: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- поддержка -->
            <div class="support_page">
                поддержка
            </div>
        </div>
    </div>
    <script src="{% static 'js/side_menu_hover-academy.js'%}"></script>
    <script src="{% static 'js/drop_menu_cab-academy.js'%}"></script>
    <script src="{% static 'js/study_page_cab-academy.js'%}"></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>


<script>
    $(document).ready(function() {
        var activeStreamId = $('.potok_item.open').data('stream-id');  // Добавляем переменную для отслеживания активного потока
    
        // Функция для загрузки уроков по курсу и потоку
        function loadLessons(courseId, streamId) {
            console.log('Loading lessons for Course ID:', courseId, 'and Stream ID:', streamId);
    
            var blockSelector = '.drop_lessons_list';
    
            $.ajax({
                url: '/get_lessons/',
                type: 'GET',
                data: {'course_id': courseId, 'stream_id': streamId},
                success: function(data) {
                    var lessonsHtml = '';
                    $.each(data.lessons, function(index, lesson) {
                        lessonsHtml += '<li class="drop_lessons_item main" data-lesson-id="' + lesson.id + '">';
                        lessonsHtml += '<p class="drop_lessons_text">' + lesson.name + '</p>';
                        lessonsHtml += '</li>';
                    });
                    $(blockSelector).html(lessonsHtml);
    
                    // Обработка кликов для элементов с классом "drop_lessons_item"
                    $(blockSelector).on('click', '.drop_lessons_item', function() {
                        var lessonId = $(this).data('lesson-id');
                        var lessonName = $(this).find('.drop_lessons_text').text();
                        $('.lessons_text').text(lessonName);
                        console.log('Selected Lesson ID:', lessonId);
                        console.log('Selected Lesson Name:', lessonName);
                    });
                },
                error: function(error) {
                    console.log(error);
                }
            });
        }
    
        // Обработка кликов для элементов с классом "drop_courses_item"
        $('.drop_courses_list').on('click', '.drop_courses_item', function() {
            var courseId = $(this).data('course-id');  // Получаем id курса
            var streamId = activeStreamId;  // Получаем id активного потока
            loadLessons(courseId, streamId);
        });
    
        // Обработка кликов для элементов с классом "potok_item"
        $('.potok_item').on('click', function() {
            // Обновляем id активного потока при переключении
            activeStreamId = $(this).data('stream-id');
            // Сброс отображения уроков при нажатии на элемент "potok_item"
            var blockSelector = '.drop_lessons_list';
            $(blockSelector).html('');
        });
    });
    
</script>

<script>
    $(document).ready(function() {
        // Функция для загрузки курсов по потоку
        function loadCourses(streamId) {
            var blockSelector = '.drop_courses_list';  // Изменено на '.drop_courses_list'
            
            $.ajax({
                url: '/get_courses/',
                type: 'GET',
                data: {'stream_id': streamId},  // Заменено на 'stream-id'
                success: function(data) {
                    var coursesHtml = '';
                    $.each(data.courses, function(index, course) {
                        // Добавляем атрибут data-course-id
                        coursesHtml += '<li class="drop_courses_item main" data-course-id="' + course.id + '">';
                        coursesHtml += '<p class="drop_courses_text">' + course.name + '</p>';
                        coursesHtml += '</li>';
                    });
                    $(blockSelector).html(coursesHtml);
    
                    // Обработка кликов на элементах .drop_courses_item
                    $(blockSelector).on('click', '.drop_courses_item', function() {
                        var courseId = $(this).data('course-id');
                        var courseName = $(this).find('.drop_courses_text').text();
                        $('.courses_text').text(courseName);
                        console.log('Selected Course ID:', courseId);
                        console.log('Selected Course Name:', courseName);
                    });
                },
                error: function(error) {
                    console.log(error);
                }
            });
        }
    
        // Загрузка курсов при загрузке страницы
        loadCourses($('.first.open').data('stream-id'));
    
        // Обработка кликов на элементах .first.open, .second.open, .third.open
        $('.first.open, .second.open, .third.open').on('click', function() {
            var streamId = $(this).data('stream-id');  // Заменено на 'stream-id'
            loadCourses(streamId);
        });


         // Обработка кликов на элементах .first.open, .second.open, .third.open
         $('.first.open, .second.open, .third.open').on('click', function() {
            var streamId = $(this).data('stream-id');
            loadCourses(streamId);
    
            // Отображение "Ваш курс" и "Ваш урок"
            $('.courses_text').text('Ваш курс');
            $('.lessons_text').text('Ваш урок');
            $('.topic_title').text('Тема урока “Название темы урока”'); 
        });
    });
    
</script>
    


<script>
    $('.drop_lessons_list').on('click', '.drop_lessons_item', function () {
        var lessonId = $(this).data('lesson-id');

        // AJAX-запрос для получения данных урока
        $.ajax({
            url: '/get_lesson_details/' + lessonId + '/',
            type: 'GET',
            success: function (data) {
                var lessonTopicTitle = 'Тема урока "' + data.lesson_topic + '"';
                $('.topic_title').text(lessonTopicTitle);

                // Отображение zoom_rec в ссылке
                $('.file_link').attr('href', data.zoom_rec);

                // Отображение homework
                $('.homework_text').text(data.homework);

                // Очищаем содержимое .video_block перед добавлением новых видео
                $('.video_block').empty();

                // Обходим список видео и добавляем каждую ссылку в .video_block
                for (var i = 0; i < data.video_links.length; i++) {
                    var videoLink = data.video_links[i];
                    var iframe = $('<iframe>', {
                        src: videoLink,
                        frameborder: 0,
                        allowfullscreen: true
                    });
                    $('.video_block').append(iframe);
                }
            },
            error: function (error) {
                console.log(error);
            }
        });
    });
    
</script>



    <script type="module">
        import {
          EthereumClient,
          w3mConnectors,
          w3mProvider,
          WagmiCore,
          WagmiCoreChains,
          WagmiCoreConnectors,
        } from "https://unpkg.com/@web3modal/ethereum";
  
        import { Web3Modal } from "https://unpkg.com/@web3modal/html";
  
        // Equivalent to importing from @wagmi/core
        const { configureChains, createConfig, getAccount, disconnect } =
          WagmiCore;
  
        // Equivalent to importing from @wagmi/core/chains
        const { mainnet, polygon, avalanche, arbitrum, bsc } = WagmiCoreChains;
  
        // Equivalent to importing from @wagmi/core/providers
        const { CoinbaseWalletConnector } = WagmiCoreConnectors;
  
        window.process = {
          env: {
            NODE_ENV: "development",
          },
        };
  
        const chains = [arbitrum, mainnet, polygon, bsc];
        const projectId = "0b1e5c998294f163bf1af4d05e11e4c1";
  
        const { publicClient, connect } = configureChains(chains, [
          w3mProvider({ projectId }),
        ]);
        const wagmiConfig = createConfig({
          autoConnect: true,
          connectors: w3mConnectors({ projectId, chains }),
          publicClient,
        });
        const ethereumClient = new EthereumClient(wagmiConfig, chains);
        const web3modal = new Web3Modal({ projectId }, ethereumClient);
        const logoutButton = document.getElementById("logoutButton");
  
        // Add a click event listener to the logoutButton
        logoutButton.addEventListener("click", handleLogout);
  
        // Define the logout handler function
        async function handleLogout() {
          try {
            // Disconnect from the wallet connection
            await disconnect();
            // Redirect to the /logout page or any other desired action
            window.location.href = "/logout";
          } catch (error) {
            console.error("Error disconnecting:", error);
          }
        }
      </script>


      {% comment %} <script> 
        //код по переключению между потоками
        function handleClick(streamId) {
            var streamElement = document.querySelector('.potok_item.first');
            if (streamElement.classList.contains('knock_close')) {
                alert('Этот поток еще закрыт!');
            } else {
                // Обработка клика на открытый поток
            }
        }
      </script> {% endcomment %}

        <script>
            //код к чату
            document.addEventListener('DOMContentLoaded', function() {
                var addBtn = document.querySelector('.add_btn');
                var sendBtn = document.querySelector('.send_btn');
                var inputMess = document.querySelector('.input_mess');
                var messageList = document.querySelector('.mess_block');
            
                addBtn.addEventListener('click', function() {
                    var fileInput = document.createElement('input');
                    fileInput.type = 'file';
                    fileInput.accept = 'image/*, video/*, application/*'; // Разрешаем загрузку изображений, видео и PDF-файлов
            
                    fileInput.addEventListener('change', function() {
                        handleFile(fileInput.files[0]);
                    });
            
                    fileInput.click();
                });
            
                sendBtn.addEventListener('click', function() {
                    sendMessage();
                });
            
                inputMess.addEventListener('keydown', function(event) {
                    if (event.key === 'Enter') {
                        sendMessage();
                    }
                });
            
                function sendMessage() {
                    var messageText = inputMess.value;
                    if (messageText.trim() !== '') {
                        var maxLength = 32;
                        var formattedText = formatText(messageText, maxLength);
            
                        // Распознавание ссылок и их оборачивание в тег <a>
                        formattedText = linkify(formattedText);
            
                        var messageItem = document.createElement('li');
                        messageItem.classList.add('answ_block');
                        messageItem.innerHTML = `
                            <div class="mess_text_info">
                                <div class="mess">
                                    <p class="text_mess">${formattedText}</p>
                                </div>
                                <p class="date_text">${getCurrentDate()}</p>
                            </div>
                            <img src="/img/никита.jpg" alt="" class="answ_user_img">
                        `;
                        messageList.appendChild(messageItem);
                        inputMess.value = '';
                    }
                }
                
                function formatText(text, maxLength) {
                    // Функция для форматирования текста
                    // Если длина текста больше maxLength, добавляем переносы строки
                    if (text.length > maxLength) {
                        var result = '';
                        for (var i = 0; i < text.length; i++) {
                            result += text[i];
                            if ((i + 1) % maxLength === 0) {
                                result += '\n';
                            }
                        }
                        return result;
                    }
                    return text;
                }
            
                function linkify(text) {
                    // Регулярное выражение для распознавания ссылок
                    var urlRegex = /(?:https?|ftp):\/\/[^\s/$.?#].[^\s]*/g;
                    return text.replace(urlRegex, function (url) {
                        return `<a href="${url}" target="_blank" class="link_mess">${url}</a>`;
                    });
                }
                
                
                
                
                
            
                function handleFile(file) {
                    if (file) {
                        var reader = new FileReader();
                        reader.onload = function (e) {
                            var fileItem = document.createElement('li');
                            fileItem.classList.add('answ_block_file');
                
                            var fileName = file.name.length > 23 ? file.name.substring(0, 23) + '\n' + file.name.substring(23) : file.name;
                
                            if (file.type.startsWith('image/')) {
                                // Если файл - изображение
                                fileItem.innerHTML = `
                                    <div class="mess_text_info">
                                        <div class="mess">
                                            <img src="${e.target.result}" alt="" class="file_sent">
                                        </div>
                                        <p class="date_text">${getCurrentDate()}</p>
                                    </div>
                                    <img src="/img/никита.jpg" alt="" class="answ_user_img">
                                `;
                            } else if (file.type.startsWith('video/')) {
                                // Если файл - видео
                                fileItem.innerHTML = `
                                    <div class="mess_text_info">
                                        <div class="mess">
                                            <video src="${e.target.result}" alt="" class="file_sent" controls></video>
                                        </div>
                                        <p class="date_text">${getCurrentDate()}</p>
                                    </div>
                                    <img src="/img/никита.jpg" alt="" class="answ_user_img">
                                `;
                            } else {
                                // Если файл - PDF, docx или другой тип
                                fileItem.innerHTML = `
                                    <div class="mess_text_info">
                                        <div class="mess">
                                            <img src="/img/file.png" alt="" class="file_img">
                                            <div>
                                                <a class="file_link" href="${e.target.result}" target="_blank">${fileName}</a>
                                            </div>
                                        </div>
                                        <p class="date_text">${getCurrentDate()}</p>
                                    </div>
                                    <img src="/img/никита.jpg" alt="" class="answ_user_img">
                                `;
                            }
                
                            messageList.appendChild(fileItem);
                        };
                        reader.readAsDataURL(file);
                    }
                }
            
                function getCurrentDate() {
                    var currentDate = new Date();
                    var options = { day: 'numeric', month: 'short', hour: '2-digit', minute: '2-digit' };
                    return currentDate.toLocaleString('ru-RU', options);
                }
            });
            
        </script>
                  
</body>
</html>
