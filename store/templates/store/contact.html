<!DOCTYPE html>
<html lang="en">
    {% load static %}

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Контакты</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/contact-academy.css'%}">
</head>
<body>
    <header class="header">
        <div class="container">
    <div data-wow-duration="5s" class="nav animate__animated animate__fadeIn">
        <a href="{% url 'academy' %}"><img class="logo" src="{% static 'img/image 1.svg'%}" alt="logo"></a>
        <div class="logo_text">
            <a href="{% url 'academy' %}"><p class="text1">Бирюзовая</p></a>
               <a href="{% url 'academy' %}"><p class="text2">Академия</p></p></a>
        </div>
        <ul class="menu">
            <li>
                <a href="{% url 'academy2' %}">Об академи</a>
            </li>
            <li>
                <a href="{% url 'all_courses' %}">Направления</a>
            </li>
            <li>
                <a href="{% url 'index' %}">Метавселенная</a>
            </li>
            <li>
                <a href="{% url 'store' %}">Маркетплейс</a>
            </li>
        </ul>
        <button id="navButton" class="nav_btn">
            <p class="nav_btn_text">Начать бесплатно</p>
        </button>
        <button id="menu-open" class="menu-open">
                <img id="menu_img" class="menu_img" src="{% static 'img/burger.svg'%}" alt="burger_menu_img">
        </button>
    </div>
        </div>
    </header>
    <div class="contact">
        <ul id="show-menu" class="show-menu">
            <li id="navButtonMobile" class="login_btn">
                <p class="login_btn_text">Начать бесплатно</p>
            </li>
            <li>
                <a href="{% url 'academy2' %}">Об академии</a>
            </li>
            <li>
                <a href="{% url 'all_courses' %}">Направления</a>
            </li>
            <li>
                <a href="{% url 'index' %}">Метавселенная</a>
            </li>
            <li>
                <a href="{% url 'store' %}">Маркетплейс</a>
            </li>
            <li class="support_btn">
                <a class="support_btn_text" href="{% url 'contact' %}">Связатся с нами</a>
            </li>
        </ul>
        <div class="contact_block">
            <div class="title_block">
            <p class="contact_title">Связатся с Нами</p>
            <div class="divider_title"></div>
            </div>
            <div class="block_form animate__animated animate__fadeIn" data-wow-duration="5s">
                <form name="contact-form" method="post" action="{% url 'contact' %}">
                    {% csrf_token %}
                    <div class="contact_form">
                        <p class="form_title">Оставьте заявку и мы свяжемся с вами</p>
                        <div class="input_group">
                            <div class="name_group">
                                <p class="name">Имя</p>
                                <input type="text" placeholder="Ваше Имя" name="name" class="input_block">
                            </div>
                            <div class="last_name_group">
                                <p class="last_name">Фамилия</p>
                                <input type="text" placeholder="Ваша Фамилия" name="sur_name" class="input_block">
                            </div>
                            <div class="tel_group">
                                <p class="tel">Телефон</p>
                                <input type="text" placeholder="Ваш телефон" name="phone" class="input_block" pattern="[0-9]*" title="Введите только цифры">

                            </div>
                            <div class="mes_group">
                                <p class="mes">Мессенджер</p>
                                <div class="input_block_mes">
                                    <button id="type_mes" class="mes_type_btn" type="button">
                                        <p class="text_btn_mes" id="selectedMessenger">Тип</p>
                                        <img class="btn_arrow" id="btn_arrow" src="{% static 'img/btn_arrow.svg' %}" alt="arrow">
                                    </button>
                                    <input type="text" name="messenger_value" class="input_mes">
                                    <select name="messenger_type" style="display: none;"> <!-- Скрытый select -->
                                        <option value="Telegram">Telegram</option>
                                        <option value="Instagram">Instagram</option>
                                        <option value="WhatsApp">WhatsApp</option>
                                        <option value="Viber">Viber</option>
                                    </select>
                                    <div id="dropdown_mes" class="dropdown_menu">
                                        <ul class="drop_menu">
                                            <li class="drop_item">
                                                <p class="drop_text">Telegram</p>
                                            </li>
                                            <li class="drop_item">
                                                <p class="drop_text">Instagram</p>
                                            </li>
                                            <li class="drop_item">
                                                <p class="drop_text">WhatsApp</p>
                                            </li>
                                            <li class="drop_item">
                                                <p class="drop_text">Viber</p>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="btn_contact">
                            <button class="contact_btn" type="submit" name="UpdateCustomerForm">
                                <p class="btn_text">Отправить заявку</p>
                            </button>
                        </div>
                    </div>
                </form>
                <div class="contact_info_block">
                    <p class="contact_form_title">Контакты</p>
                    <div class="contact_group">
                        <p class="contact_info">
                            Город Батуми 6000 Улица Кобаладзе 8а Грузия: +995 568 836 179 biruzacademy@gmail.com
                        </p>
                        <div class="sm_group">
                            <a class="contact_img" href="#"><img src="{% static 'img/facebook.svg'%}" alt="facebook"></a>
                            <a href="https://www.instagram.com/modern.time.academy/"><img src="{% static 'img/instagram.svg'%}" alt="instagram"></a>
                            <a href="https://t.me/+Xp5zW6wyF_FmMDU1"><img src="{% static 'img/telegram.svg'%}" alt="telegram"></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer class="footer">
        <div class="container">
            <div class="footer_box">
            <div data-wow-delay="1s" class="text_block_footer animate__animated animate__fadeInUp">
            <div class="logo_footer">
            <a href="{% url 'academy' %}"><img src="{% static 'img/image 1.svg'%}" alt="logo"></a>
            <div class="logo_text">
                <p class="text1">Бирюзовая</p>
                <p class="text2">Академия</p></p>
            </div>
            </div>
            <div class="footer_second_text_block">
            <div class="footer_text">
            <p class="footer_text1">Никогда не сомневайтесь в своем потенциале! Бирюзовая Академия – это ваш путь к лучшей версии себя.
               <br><p class="footer_text2">#БирюзоваяАкадемия #РаскройСебя</p></p>
               </div>
               <div class="icon_footer_block">
                    <div class="facebook">
                        <div class="round_smm">
                        <a href="#"><img src="{% static 'img/facebook.svg'%}" alt="facebook"></a>
                        </div>
                    </div>
                    <div class="instargram">
                        <div class="round_smm">
                            <a href="https://www.instagram.com/modern.time.academy/"><img src="{% static 'img/instagram.svg'%}" alt="instagram"></a>
                        </div>
                    </div>
                    <div class="telegram">
                        <div class="round_smm">
                            <a href="https://t.me/+Xp5zW6wyF_FmMDU1"><img src="{% static 'img/telegram.svg'%}" alt="telegram"></a>
                        </div>
                    </div>
               </div>
            </div>
            </div>
            <div id="triger_box" data-wow-delay="1s" class="triger_box animate__animated animate__fadeInUp">
            <div  id="footer-triger-title" class="footer-triger-title">
                <span
                  ><span id="span" class="footer-triger-title-span">Готов начать обучение в </span
                  ><span id="span2" class="footer-triger-title-span2">Бирюзовой </span
                  ><span  id="span3" class="footer-triger-title-span3">Академии?</span></span>
              </div>
              <button id="footButton" class="footer_btn wow animate__animated animate__pulse">
                <div class="footer_btn_text_block">
                    <p class="footer_btn_text">Начать бесплатно</p>
                    <img class="btn_arrow_footer" src="{% static 'img/btn_arrow.svg'%}" alt="action_btn_arrow">
                </div>
            </button>
            </div>
            <div data-wow-delay="1s" class="law_info_block animate__animated animate__fadeInUp">
                <ul class="list_info">
                    <li class="ip">ИП Мокрецова Марина Владимировна</li>
                    <li class="inn">ИНН 890409100814</li>
                    <li class="ogrnip">ОГРНИП 323237500416580</li>
                    <li class="number">+995 568 836 179</li>
                    <li class="mail">biruzacademy@gmail.com</li>
                </ul>
                <p class="lable" >© 2023 Бирюзовая Академия</p>
            </div>
        </div> 
        </div>
    </footer>
    <script src="https://code.jquery.com/jquery-3.7.1.slim.min.js" integrity="sha256-kmHvs0B+OpCW5GVHUNjv9rOmY0IvSIRcf7zGUDTDQM8=" crossorigin="anonymous"></script>
    <script src="{% static 'js/menu-academy.js'%}"></script>
    <script src="{% static 'js/contact-academy.js'%}"></script>
    <script src="{% static 'js/wow.min.js'%}"></script>
              <script>
              new WOW().init();
              // JavaScript для обработки клика на кнопке и перехода на другую страницу
              document.getElementById("navButton").addEventListener("click", function() {
                // Используйте window.location.href для перехода на другую страницу
                window.location.href = "contact.html"; // Замените "новая_страница.html" на URL вашей целевой страницы
            });
            // JavaScript для обработки клика на кнопке и перехода на другую страницу
            document.getElementById("footButton").addEventListener("click", function() {
                // Используйте window.location.href для перехода на другую страницу
                window.location.href = "contact.html"; // Замените "новая_страница.html" на URL вашей целевой страницы
            });

              </script>
               <script type="module">
           

                import {
                EthereumClient,
                w3mConnectors,
                w3mProvider,
                WagmiCore,
                WagmiCoreChains,
                WagmiCoreConnectors
              } from 'https://unpkg.com/@web3modal/ethereum'
            
              import { Web3Modal } from 'https://unpkg.com/@web3modal/html'
            
              // Equivalent to importing from @wagmi/core
              const { configureChains, createConfig, getAccount,disconnect   } = WagmiCore
            
              // Equivalent to importing from @wagmi/core/chains
              const { mainnet, polygon, avalanche, arbitrum,bsc } = WagmiCoreChains
            
              // Equivalent to importing from @wagmi/core/providers
              const { CoinbaseWalletConnector } = WagmiCoreConnectors
        
              window.process = {
                env: {
                    NODE_ENV: 'development'
                }
              }    
        
              const chains = [arbitrum, mainnet, polygon,bsc]
              const projectId = '0b1e5c998294f163bf1af4d05e11e4c1'
        
              const { publicClient, connect } = configureChains(chains, [w3mProvider({ projectId })]);  
              const wagmiConfig = createConfig({
                autoConnect: true,
                connectors: w3mConnectors({ projectId, chains }),
                publicClient
              })
              const ethereumClient = new EthereumClient(wagmiConfig, chains)
              const web3modal = new Web3Modal({ projectId }, ethereumClient)
    
              {% if not user.is_authenticated %}
                document.getElementById("navButton").addEventListener("click", () => {
                    web3modal.openModal();
                });
          
                // Define the main function to handle wallet connection and authentication/registration
                async function handleWalletConnect() {
                  try {
                    console.log("Wallet button clicked. Connecting to the wallet...");
                    const account = await getAccount();
                    console.log("Account information:", account);
                    window.csrfToken = "{{ csrf_token }}";
                    const csrfToken = window.csrfToken;
    
                    // Проверяем, подключен ли аккаунт
                    if (account.isConnected) {
                      console.log("Account is connected.");
                      const address = account.address;
                      const additionalInfo = "Дополнительная информация";
    
                      // Создаем объект с данными
                      const data = { address, additionalInfo };
    
                      // Создаем объект опций для запроса
                      const options = {
                        method: "POST",
                        headers: {
                          "Content-Type": "application/json",
                          "X-CSRFToken": csrfToken, // Use the correct token value
                        },
                        body: JSON.stringify(data),
                      };
                      
    
                      // Отправляем запрос на сервер Django
                      const response = await fetch("/authenticate_wallet/", options);
                      const json = await response.json();
    
                      if (json.success) {
                        console.log("Authentication or registration success!");
                        window.location.href = "/academy_profile"; // Перенаправляем на нужную страницу после успешного входа
                      } else {
                        console.error("Ошибка авторизации или регистрации:", json.error);
                      }
                    } else {
                      console.log("Account is not connected. Waiting for the connection to complete...");
                      setTimeout(handleWalletConnect, 1000); // Retry after 1 second
                    }
                  } catch (error) {
                    console.error("Ошибка авторизации через WalletConnect:", error);
                  }
                }
    
                // Call the main function to handle wallet connection and authentication/registration
                document.getElementById("navButton").addEventListener("click", handleWalletConnect);
                document.getElementById("navButtonMobile").addEventListener("click", handleWalletConnect);
    
                          
                if (web3modal && web3modal.ethereum) {
                  web3modal.ethereum.on("accountsChanged", (accounts) => {
                    if (accounts.length > 0) {
                              // User is authenticated, redirect or update the page here
                              window.location.href = "/academy_profile"; // Перенаправляем на нужную страницу после успешного входа
                            } else {
                              // User is disconnected
                            }
                          });
                        }
    
              {% else %}
              document.getElementById("navButton").addEventListener("click", ()=>{window.location.href = '/academy_profile';});
              document.getElementById("navButtonMobile").addEventListener("click", ()=>{window.location.href = '/academy_profile';});
              
              {% comment %} 
                            const logoutButton = document.getElementById('logoutButton');
                    
                            // Add a click event listener to the logoutButton
                            logoutButton.addEventListener('click', handleLogout);
                            
                          // Define the logout handler function
                            async function handleLogout() {
                              try {
                                // Disconnect from the wallet connection
                                await disconnect();
                                // Redirect to the /logout page or any other desired action
                                window.location.href = '/logout';
                              } catch (error) {
                                console.error("Error disconnecting:", error);
                              }
                            }{% endcomment %}
                            {%endif%} 
    
            </script>
</body>
</html>